
{
  "schemaVersion": 1,
  "distributedInfo": {"backend": "nccl", "rank": 3, "world_size": 4},
  "deviceProperties": [
    {
      "id": 0, "name": "GeForce RTX 2080 Ti", "totalGlobalMem": 11554717696,
      "computeMajor": 7, "computeMinor": 5,
      "maxThreadsPerBlock": 1024, "maxThreadsPerMultiprocessor": 1024,
      "regsPerBlock": 65536, "regsPerMultiprocessor": 65536, "warpSize": 32,
      "sharedMemPerBlock": 49152, "sharedMemPerMultiprocessor": 65536,
      "numSms": 68, "sharedMemPerBlockOptin": 65536
    },
    {
      "id": 1, "name": "GeForce RTX 2080 Ti", "totalGlobalMem": 11554717696,
      "computeMajor": 7, "computeMinor": 5,
      "maxThreadsPerBlock": 1024, "maxThreadsPerMultiprocessor": 1024,
      "regsPerBlock": 65536, "regsPerMultiprocessor": 65536, "warpSize": 32,
      "sharedMemPerBlock": 49152, "sharedMemPerMultiprocessor": 65536,
      "numSms": 68, "sharedMemPerBlockOptin": 65536
    },
    {
      "id": 2, "name": "GeForce RTX 2080 Ti", "totalGlobalMem": 11554717696,
      "computeMajor": 7, "computeMinor": 5,
      "maxThreadsPerBlock": 1024, "maxThreadsPerMultiprocessor": 1024,
      "regsPerBlock": 65536, "regsPerMultiprocessor": 65536, "warpSize": 32,
      "sharedMemPerBlock": 49152, "sharedMemPerMultiprocessor": 65536,
      "numSms": 68, "sharedMemPerBlockOptin": 65536
    },
    {
      "id": 3, "name": "GeForce RTX 2080 Ti", "totalGlobalMem": 11554717696,
      "computeMajor": 7, "computeMinor": 5,
      "maxThreadsPerBlock": 1024, "maxThreadsPerMultiprocessor": 1024,
      "regsPerBlock": 65536, "regsPerMultiprocessor": 65536, "warpSize": 32,
      "sharedMemPerBlock": 49152, "sharedMemPerMultiprocessor": 65536,
      "numSms": 68, "sharedMemPerBlockOptin": 65536
    }
  ],
  "traceEvents": [
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373276900,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904979283584, "Bytes": 4, "Total Allocated": 4, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373276893, "dur": 41,
    "args": {
       "External id": 2,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zero_", "pid": 2765, "tid": 2765,
    "ts": 1638252373276974, "dur": 1,
    "args": {
       "External id": 3,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zeros", "pid": 2765, "tid": 2765,
    "ts": 1638252373276852, "dur": 127,
    "args": {
       "External id": 1,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373277146,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904979268160, "Bytes": 16, "Total Allocated": 20, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373277144, "dur": 9,
    "args": {
       "External id": 5,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(330): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373277156,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904979268160, "Bytes": -16, "Total Allocated": 4, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373277163,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904979283584, "Bytes": -4, "Total Allocated": 0, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373277255,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94901878249600, "Bytes": 4, "Total Allocated": 4, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373277254, "dur": 10,
    "args": {
       "External id": 7,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zero_", "pid": 2765, "tid": 2765,
    "ts": 1638252373277298, "dur": 1,
    "args": {
       "External id": 8,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zeros", "pid": 2765, "tid": 2765,
    "ts": 1638252373277219, "dur": 82,
    "args": {
       "External id": 6,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373277443,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94903031106752, "Bytes": 16, "Total Allocated": 20, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373277442, "dur": 6,
    "args": {
       "External id": 10,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373277450,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94903031106752, "Bytes": -16, "Total Allocated": 4, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373277456,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94901878249600, "Bytes": -4, "Total Allocated": 0, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "enumerate(DataLoader)#_MultiProcessingDataLoaderIter.__next__", "pid": 2765, "tid": 2765,
    "ts": 1638252373277373, "dur": 282,
    "args": {
       "External id": 9,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;"
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373277878,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225447936, "Bytes": -24576, "Total Allocated": 143006720, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373277886,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225472512, "Bytes": -24576, "Total Allocated": 142982144, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373278000,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225447936, "Bytes": 24576, "Total Allocated": 143006720, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373277989, "dur": 18,
    "args": {
       "External id": 13,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373278035, "dur": 42,
    "args": {
       "External id": 14,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2765, "tid": 2765,
    "ts": 1638252373277961, "dur": 119,
    "args": {
       "External id": 12,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""], "Fwd thread id": 0, "Sequence number": 161
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373277930, "dur": 152,
    "args": {
       "External id": 11,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 161
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373278155,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225472512, "Bytes": 24576, "Total Allocated": 143031296, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373278146, "dur": 16,
    "args": {
       "External id": 17,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373278183, "dur": 32,
    "args": {
       "External id": 18,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2765, "tid": 2765,
    "ts": 1638252373278127, "dur": 90,
    "args": {
       "External id": 16,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""], "Fwd thread id": 0, "Sequence number": 161
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373278105, "dur": 113,
    "args": {
       "External id": 15,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 161
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373278377, "dur": 1,
    "args": {
       "External id": 19,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(479): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 161
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373278415, "dur": 0,
    "args": {
       "External id": 20,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(481): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 161
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2765, "tid": 2765,
    "ts": 1638252373278638, "dur": 1,
    "args": {
       "External id": 21,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[7093632], [28374528]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1570): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373278727, "dur": 2,
    "args": {
       "External id": 23,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373278688, "dur": 61,
    "args": {
       "External id": 22,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373278789, "dur": 4,
    "args": {
       "External id": 24,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2765, "tid": 2765,
    "ts": 1638252373278825, "dur": 1,
    "args": {
       "External id": 25,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [28374528]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373279028, "dur": 1,
    "args": {
       "External id": 29,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373278995, "dur": 36,
    "args": {
       "External id": 28,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373278963, "dur": 70,
    "args": {
       "External id": 27,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373279125, "dur": 0,
    "args": {
       "External id": 32,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373279094, "dur": 33,
    "args": {
       "External id": 31,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373279063, "dur": 66,
    "args": {
       "External id": 30,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373279220, "dur": 0,
    "args": {
       "External id": 35,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373279189, "dur": 33,
    "args": {
       "External id": 34,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373279158, "dur": 66,
    "args": {
       "External id": 33,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373279314, "dur": 1,
    "args": {
       "External id": 38,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373279284, "dur": 33,
    "args": {
       "External id": 37,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373279255, "dur": 63,
    "args": {
       "External id": 36,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373279408, "dur": 1,
    "args": {
       "External id": 41,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373279378, "dur": 35,
    "args": {
       "External id": 40,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373279350, "dur": 65,
    "args": {
       "External id": 39,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373279506, "dur": 1,
    "args": {
       "External id": 44,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373279478, "dur": 31,
    "args": {
       "External id": 43,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373279446, "dur": 64,
    "args": {
       "External id": 42,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373279610, "dur": 1,
    "args": {
       "External id": 47,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373279572, "dur": 41,
    "args": {
       "External id": 46,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373279541, "dur": 74,
    "args": {
       "External id": 45,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373279707, "dur": 1,
    "args": {
       "External id": 50,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373279676, "dur": 34,
    "args": {
       "External id": 49,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373279644, "dur": 67,
    "args": {
       "External id": 48,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373279801, "dur": 0,
    "args": {
       "External id": 53,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373279770, "dur": 33,
    "args": {
       "External id": 52,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373279740, "dur": 65,
    "args": {
       "External id": 51,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373279894, "dur": 1,
    "args": {
       "External id": 56,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373279864, "dur": 33,
    "args": {
       "External id": 55,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373279836, "dur": 94,
    "args": {
       "External id": 54,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373280021, "dur": 1,
    "args": {
       "External id": 59,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373279992, "dur": 32,
    "args": {
       "External id": 58,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373279963, "dur": 63,
    "args": {
       "External id": 57,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373280115, "dur": 3,
    "args": {
       "External id": 62,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373280087, "dur": 33,
    "args": {
       "External id": 61,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373280056, "dur": 65,
    "args": {
       "External id": 60,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373280212, "dur": 1,
    "args": {
       "External id": 65,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373280181, "dur": 34,
    "args": {
       "External id": 64,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373280151, "dur": 65,
    "args": {
       "External id": 63,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373280306, "dur": 1,
    "args": {
       "External id": 68,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373280276, "dur": 33,
    "args": {
       "External id": 67,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373280245, "dur": 68,
    "args": {
       "External id": 66,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373280403, "dur": 1,
    "args": {
       "External id": 71,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373280372, "dur": 33,
    "args": {
       "External id": 70,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373280342, "dur": 65,
    "args": {
       "External id": 69,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373280497, "dur": 1,
    "args": {
       "External id": 74,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373280467, "dur": 33,
    "args": {
       "External id": 73,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373280438, "dur": 63,
    "args": {
       "External id": 72,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373280592, "dur": 1,
    "args": {
       "External id": 77,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373280564, "dur": 31,
    "args": {
       "External id": 76,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373280532, "dur": 64,
    "args": {
       "External id": 75,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373280694, "dur": 1,
    "args": {
       "External id": 80,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373280665, "dur": 34,
    "args": {
       "External id": 79,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373280635, "dur": 65,
    "args": {
       "External id": 78,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373280790, "dur": 1,
    "args": {
       "External id": 83,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373280760, "dur": 35,
    "args": {
       "External id": 82,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373280729, "dur": 67,
    "args": {
       "External id": 81,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373280887, "dur": 1,
    "args": {
       "External id": 86,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373280856, "dur": 34,
    "args": {
       "External id": 85,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373280826, "dur": 65,
    "args": {
       "External id": 84,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373280981, "dur": 1,
    "args": {
       "External id": 89,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373280951, "dur": 33,
    "args": {
       "External id": 88,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373280920, "dur": 66,
    "args": {
       "External id": 87,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::split_with_sizes", "pid": 2765, "tid": 2765,
    "ts": 1638252373278919, "dur": 2085,
    "args": {
       "External id": 26,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Int"], "Fwd thread id": 0, "Sequence number": 161
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373281048, "dur": 7,
    "args": {
       "External id": 90,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9216], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 162
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373281094, "dur": 4,
    "args": {
       "External id": 91,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[15360], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 163
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373281133, "dur": 3,
    "args": {
       "External id": 92,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 164
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373281173, "dur": 3,
    "args": {
       "External id": 93,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 165
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373281211, "dur": 3,
    "args": {
       "External id": 94,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 166
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373281251, "dur": 3,
    "args": {
       "External id": 95,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 167
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373281286, "dur": 4,
    "args": {
       "External id": 96,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 168
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373281329, "dur": 4,
    "args": {
       "External id": 97,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 169
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373281366, "dur": 4,
    "args": {
       "External id": 98,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 170
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373281404, "dur": 3,
    "args": {
       "External id": 99,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 171
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373281441, "dur": 3,
    "args": {
       "External id": 100,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 172
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373281476, "dur": 5,
    "args": {
       "External id": 101,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 173
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373281513, "dur": 4,
    "args": {
       "External id": 102,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 174
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373281553, "dur": 3,
    "args": {
       "External id": 103,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 175
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373281590, "dur": 4,
    "args": {
       "External id": 104,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 176
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373281634, "dur": 4,
    "args": {
       "External id": 105,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 177
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373281673, "dur": 3,
    "args": {
       "External id": 106,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 178
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373281708, "dur": 5,
    "args": {
       "External id": 107,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 179
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373281745, "dur": 7,
    "args": {
       "External id": 108,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 180
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373281783, "dur": 4,
    "args": {
       "External id": 109,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 181
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373281820, "dur": 4,
    "args": {
       "External id": 110,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[15360], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 182
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373281920, "dur": 2,
    "args": {
       "External id": 111,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373281956, "dur": 1,
    "args": {
       "External id": 112,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 183
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "detach_", "pid": 2765, "tid": 2765,
    "ts": 1638252373282019, "dur": 1,
    "args": {
       "External id": 114,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::detach_", "pid": 2765, "tid": 2765,
    "ts": 1638252373281993, "dur": 28,
    "args": {
       "External id": 113,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"], "Fwd thread id": 0, "Sequence number": 183
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373282080,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904979651456, "Bytes": 5056, "Total Allocated": 5056, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373282112,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904979276096, "Bytes": 816, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373282231, "dur": 10,
    "args": {
       "External id": 118,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373282273, "dur": 29,
    "args": {
       "External id": 119,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2765, "tid": 2765,
    "ts": 1638252373282199, "dur": 144,
    "args": {
       "External id": 117,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373282167, "dur": 178,
    "args": {
       "External id": 116,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373282444, "dur": 5,
    "args": {
       "External id": 122,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373282480, "dur": 19,
    "args": {
       "External id": 123,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2765, "tid": 2765,
    "ts": 1638252373282413, "dur": 88,
    "args": {
       "External id": 121,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373282384, "dur": 119,
    "args": {
       "External id": 120,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 2765, "tid": 2765,
    "ts": 1638252373282686, "dur": 2,
    "args": {
       "External id": 126,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2765, "tid": 2765,
    "ts": 1638252373282645, "dur": 46,
    "args": {
       "External id": 125,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373282770, "dur": 7,
    "args": {
       "External id": 128,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373282839,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440175116288, "Bytes": 18874368, "Total Allocated": 161905664, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2765, "tid": 2765,
    "ts": 1638252373282832, "dur": 14,
    "args": {
       "External id": 129,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::index_select", "pid": 2765, "tid": 2765,
    "ts": 1638252373282731, "dur": 151,
    "args": {
       "External id": 127,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], [3072]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "long int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373282926, "dur": 2,
    "args": {
       "External id": 130,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::embedding", "pid": 2765, "tid": 2765,
    "ts": 1638252373282593, "dur": 339,
    "args": {
       "External id": 124,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [512, 6], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "Int", "Bool", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373283011, "dur": 1,
    "args": {
       "External id": 132,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373282977, "dur": 39,
    "args": {
       "External id": 131,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373283079, "dur": 1,
    "args": {
       "External id": 134,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373283049, "dur": 33,
    "args": {
       "External id": 133,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373283155,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": 18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 2765, "tid": 2765,
    "ts": 1638252373283144, "dur": 43,
    "args": {
       "External id": 135,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373283406,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440619712512, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373283396, "dur": 17,
    "args": {
       "External id": 139,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373283359, "dur": 57,
    "args": {
       "External id": 138,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373283495,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440638586880, "Bytes": 4718592, "Total Allocated": 204372992, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373283487, "dur": 16,
    "args": {
       "External id": 141,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373283454, "dur": 51,
    "args": {
       "External id": 140,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373283308, "dur": 225,
    "args": {
       "External id": 137,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373283536,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440638586880, "Bytes": -4718592, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373283259, "dur": 283,
    "args": {
       "External id": 136,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373283548,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373283747,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440638586880, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373283743, "dur": 10,
    "args": {
       "External id": 144,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373283801,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225498112, "Bytes": 12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373283798, "dur": 9,
    "args": {
       "External id": 145,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373283870,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225510400, "Bytes": 12288, "Total Allocated": 199678976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373283866, "dur": 9,
    "args": {
       "External id": 146,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373283955, "dur": 3,
    "args": {
       "External id": 147,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373283999, "dur": 1,
    "args": {
       "External id": 148,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373283696, "dur": 312,
    "args": {
       "External id": 143,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373284011,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225498112, "Bytes": -12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373284016,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225510400, "Bytes": -12288, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373283646, "dur": 373,
    "args": {
       "External id": 142,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373284253, "dur": 2,
    "args": {
       "External id": 152,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373284208, "dur": 49,
    "args": {
       "External id": 151,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373284151, "dur": 110,
    "args": {
       "External id": 150,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373284362, "dur": 4,
    "args": {
       "External id": 154,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373284428,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": 18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373284421, "dur": 75,
    "args": {
       "External id": 155,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373284612, "dur": 2,
    "args": {
       "External id": 157,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373284557, "dur": 60,
    "args": {
       "External id": 156,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373284316, "dur": 304,
    "args": {
       "External id": 153,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373284674, "dur": 31,
    "args": {
       "External id": 158,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373284102, "dur": 606,
    "args": {
       "External id": 149,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373284764, "dur": 4,
    "args": {
       "External id": 159,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373284854, "dur": 2,
    "args": {
       "External id": 161,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373284813, "dur": 46,
    "args": {
       "External id": 160,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373285053, "dur": 1,
    "args": {
       "External id": 165,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373285009, "dur": 49,
    "args": {
       "External id": 164,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373284964, "dur": 97,
    "args": {
       "External id": 163,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373285150, "dur": 3,
    "args": {
       "External id": 167,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373285208,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373285200, "dur": 66,
    "args": {
       "External id": 168,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373285364, "dur": 1,
    "args": {
       "External id": 170,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373285319, "dur": 49,
    "args": {
       "External id": 169,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373285106, "dur": 265,
    "args": {
       "External id": 166,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373285420, "dur": 27,
    "args": {
       "External id": 171,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373284920, "dur": 529,
    "args": {
       "External id": 162,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373285499, "dur": 3,
    "args": {
       "External id": 172,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373285591, "dur": 1,
    "args": {
       "External id": 174,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373285550, "dur": 46,
    "args": {
       "External id": 173,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373285802, "dur": 1,
    "args": {
       "External id": 178,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373285757, "dur": 50,
    "args": {
       "External id": 177,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373285708, "dur": 102,
    "args": {
       "External id": 176,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373285901, "dur": 2,
    "args": {
       "External id": 180,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373285956,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440676335616, "Bytes": 18874368, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373285949, "dur": 65,
    "args": {
       "External id": 181,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373286112, "dur": 2,
    "args": {
       "External id": 183,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373286067, "dur": 49,
    "args": {
       "External id": 182,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373285856, "dur": 263,
    "args": {
       "External id": 179,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373286163, "dur": 25,
    "args": {
       "External id": 184,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373285663, "dur": 530,
    "args": {
       "External id": 175,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373286240, "dur": 4,
    "args": {
       "External id": 185,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373286331, "dur": 1,
    "args": {
       "External id": 187,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373286289, "dur": 47,
    "args": {
       "External id": 186,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373286422, "dur": 2,
    "args": {
       "External id": 189,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373286381, "dur": 47,
    "args": {
       "External id": 188,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373286562, "dur": 2,
    "args": {
       "External id": 192,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373286521, "dur": 46,
    "args": {
       "External id": 191,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373286751,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": 18874368, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373286745, "dur": 15,
    "args": {
       "External id": 196,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373286705, "dur": 57,
    "args": {
       "External id": 195,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373286807, "dur": 33,
    "args": {
       "External id": 197,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2765, "tid": 2765,
    "ts": 1638252373286664, "dur": 178,
    "args": {
       "External id": 194,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373286926, "dur": 1,
    "args": {
       "External id": 199,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373286886, "dur": 44,
    "args": {
       "External id": 198,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2765, "tid": 2765,
    "ts": 1638252373286618, "dur": 314,
    "args": {
       "External id": 193,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373287014, "dur": 1,
    "args": {
       "External id": 201,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373286973, "dur": 45,
    "args": {
       "External id": 200,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373287180,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": 18874368, "Total Allocated": 294026240, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373287176, "dur": 13,
    "args": {
       "External id": 205,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373287137, "dur": 54,
    "args": {
       "External id": 204,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373287238, "dur": 23,
    "args": {
       "External id": 206,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2765, "tid": 2765,
    "ts": 1638252373287097, "dur": 166,
    "args": {
       "External id": 203,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373287348, "dur": 2,
    "args": {
       "External id": 208,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373287309, "dur": 43,
    "args": {
       "External id": 207,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2765, "tid": 2765,
    "ts": 1638252373287057, "dur": 297,
    "args": {
       "External id": 202,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373287448,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436576403456, "Bytes": 3538944, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373287444, "dur": 13,
    "args": {
       "External id": 210,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 2765, "tid": 2765,
    "ts": 1638252373287403, "dur": 82,
    "args": {
       "External id": 209,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], [24576, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373287567, "dur": 1,
    "args": {
       "External id": 212,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373287527, "dur": 43,
    "args": {
       "External id": 211,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373287574,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373287581,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": -18874368, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373286469, "dur": 1115,
    "args": {
       "External id": 190,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373287607,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904980050368, "Bytes": 8, "Total Allocated": 5880, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373287672,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436579942400, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mul", "pid": 2765, "tid": 2765,
    "ts": 1638252373287662, "dur": 39,
    "args": {
       "External id": 213,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373287707,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904980050368, "Bytes": -8, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373287716,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436576403456, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373287813, "dur": 1,
    "args": {
       "External id": 215,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373287773, "dur": 45,
    "args": {
       "External id": 214,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373287899, "dur": 1,
    "args": {
       "External id": 217,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373287860, "dur": 43,
    "args": {
       "External id": 216,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373287964,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904980072832, "Bytes": 8, "Total Allocated": 5880, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373287976,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497088, "Bytes": 512, "Total Allocated": 259816960, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373287983,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904980072832, "Bytes": -8, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::eq", "pid": 2765, "tid": 2765,
    "ts": 1638252373287961, "dur": 48,
    "args": {
       "External id": 218,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373288155, "dur": 1,
    "args": {
       "External id": 221,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373288114, "dur": 127,
    "args": {
       "External id": 220,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373288322, "dur": 1,
    "args": {
       "External id": 223,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373288283, "dur": 43,
    "args": {
       "External id": 222,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373288448,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436583481344, "Bytes": 3538944, "Total Allocated": 263355904, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373288443, "dur": 13,
    "args": {
       "External id": 226,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373288405, "dur": 55,
    "args": {
       "External id": 225,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373288501, "dur": 37,
    "args": {
       "External id": 227,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2765, "tid": 2765,
    "ts": 1638252373288365, "dur": 175,
    "args": {
       "External id": 224,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373288673, "dur": 2,
    "args": {
       "External id": 230,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373288635, "dur": 42,
    "args": {
       "External id": 229,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill_", "pid": 2765, "tid": 2765,
    "ts": 1638252373288586, "dur": 121,
    "args": {
       "External id": 228,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill", "pid": 2765, "tid": 2765,
    "ts": 1638252373288071, "dur": 638,
    "args": {
       "External id": 219,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373288715,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497088, "Bytes": -512, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373288721,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436579942400, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373288835,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436587020288, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_softmax", "pid": 2765, "tid": 2765,
    "ts": 1638252373288829, "dur": 35,
    "args": {
       "External id": 232,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::softmax", "pid": 2765, "tid": 2765,
    "ts": 1638252373288783, "dur": 84,
    "args": {
       "External id": 231,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373288871,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436583481344, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373289095,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436590559232, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373289085, "dur": 18,
    "args": {
       "External id": 236,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373289040, "dur": 66,
    "args": {
       "External id": 235,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373289205,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225804800, "Bytes": 884736, "Total Allocated": 264240128, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373289198, "dur": 15,
    "args": {
       "External id": 238,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373289153, "dur": 63,
    "args": {
       "External id": 237,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373288987, "dur": 256,
    "args": {
       "External id": 234,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373289246,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225804800, "Bytes": -884736, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373288943, "dur": 308,
    "args": {
       "External id": 233,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373289256,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436587020288, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373289386, "dur": 2,
    "args": {
       "External id": 241,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373289345, "dur": 46,
    "args": {
       "External id": 240,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 2765, "tid": 2765,
    "ts": 1638252373289474, "dur": 3,
    "args": {
       "External id": 243,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2765, "tid": 2765,
    "ts": 1638252373289433, "dur": 47,
    "args": {
       "External id": 242,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373289559, "dur": 3,
    "args": {
       "External id": 245,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373289521, "dur": 47,
    "args": {
       "External id": 244,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373289741,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436594098176, "Bytes": 18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373289736, "dur": 12,
    "args": {
       "External id": 249,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373289696, "dur": 54,
    "args": {
       "External id": 248,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373289792, "dur": 30,
    "args": {
       "External id": 250,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2765, "tid": 2765,
    "ts": 1638252373289654, "dur": 170,
    "args": {
       "External id": 247,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373289907, "dur": 2,
    "args": {
       "External id": 252,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373289867, "dur": 44,
    "args": {
       "External id": 251,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2765, "tid": 2765,
    "ts": 1638252373289614, "dur": 300,
    "args": {
       "External id": 246,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373290001,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373289996, "dur": 11,
    "args": {
       "External id": 254,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 2765, "tid": 2765,
    "ts": 1638252373289955, "dur": 80,
    "args": {
       "External id": 253,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], [24576, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373290121, "dur": 1,
    "args": {
       "External id": 256,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373290076, "dur": 49,
    "args": {
       "External id": 255,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373290128,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436594098176, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373289303, "dur": 832,
    "args": {
       "External id": 239,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373290223, "dur": 2,
    "args": {
       "External id": 258,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373290183, "dur": 45,
    "args": {
       "External id": 257,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373290408,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436594098176, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373290403, "dur": 13,
    "args": {
       "External id": 262,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373290366, "dur": 53,
    "args": {
       "External id": 261,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373290459, "dur": 25,
    "args": {
       "External id": 263,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2765, "tid": 2765,
    "ts": 1638252373290326, "dur": 163,
    "args": {
       "External id": 260,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::contiguous", "pid": 2765, "tid": 2765,
    "ts": 1638252373290284, "dur": 207,
    "args": {
       "External id": 259,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373290538, "dur": 4,
    "args": {
       "External id": 264,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373290546,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373290756, "dur": 2,
    "args": {
       "External id": 268,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373290711, "dur": 49,
    "args": {
       "External id": 267,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373290666, "dur": 97,
    "args": {
       "External id": 266,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373290858, "dur": 3,
    "args": {
       "External id": 270,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373290917,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373290910, "dur": 71,
    "args": {
       "External id": 271,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373291080, "dur": 2,
    "args": {
       "External id": 273,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373291035, "dur": 49,
    "args": {
       "External id": 272,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373290811, "dur": 276,
    "args": {
       "External id": 269,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373291134, "dur": 28,
    "args": {
       "External id": 274,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373290621, "dur": 544,
    "args": {
       "External id": 265,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373291380,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": 18874368, "Total Allocated": 316439552, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373291370, "dur": 17,
    "args": {
       "External id": 278,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373291324, "dur": 66,
    "args": {
       "External id": 277,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373291488,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436576403456, "Bytes": 4718592, "Total Allocated": 321158144, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373291480, "dur": 14,
    "args": {
       "External id": 280,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373291436, "dur": 60,
    "args": {
       "External id": 279,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373291276, "dur": 249,
    "args": {
       "External id": 276,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373291528,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436576403456, "Bytes": -4718592, "Total Allocated": 316439552, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373291231, "dur": 301,
    "args": {
       "External id": 275,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373291537,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": -18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373291543,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436594098176, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373291551,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": -18874368, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373291556,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": -18874368, "Total Allocated": 240942080, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373291560,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440676335616, "Bytes": -18874368, "Total Allocated": 222067712, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373291565,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436590559232, "Bytes": -3538944, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373291630,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 2765, "tid": 2765,
    "ts": 1638252373291622, "dur": 34,
    "args": {
       "External id": 281,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373291756,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": -18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373291935,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373291930, "dur": 11,
    "args": {
       "External id": 284,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373291996,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225498112, "Bytes": 12288, "Total Allocated": 237415424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373291992, "dur": 9,
    "args": {
       "External id": 285,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373292051,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225510400, "Bytes": 12288, "Total Allocated": 237427712, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373292048, "dur": 9,
    "args": {
       "External id": 286,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373292137, "dur": 2,
    "args": {
       "External id": 287,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373292186, "dur": 1,
    "args": {
       "External id": 288,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373291879, "dur": 313,
    "args": {
       "External id": 283,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373292196,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225498112, "Bytes": -12288, "Total Allocated": 237415424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373292201,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225510400, "Bytes": -12288, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373291836, "dur": 368,
    "args": {
       "External id": 282,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373292482, "dur": 1,
    "args": {
       "External id": 292,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373292436, "dur": 50,
    "args": {
       "External id": 291,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373292378, "dur": 112,
    "args": {
       "External id": 290,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373292648, "dur": 3,
    "args": {
       "External id": 294,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373292744,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436941307904, "Bytes": 75497472, "Total Allocated": 312900608, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373292737, "dur": 55,
    "args": {
       "External id": 295,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373292966, "dur": 2,
    "args": {
       "External id": 297,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373292920, "dur": 50,
    "args": {
       "External id": 296,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373292575, "dur": 399,
    "args": {
       "External id": 293,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373293020, "dur": 29,
    "args": {
       "External id": 298,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373292330, "dur": 721,
    "args": {
       "External id": 289,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [6144, 1536], [6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373293137,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140437645950976, "Bytes": 75497472, "Total Allocated": 388398080, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::gelu", "pid": 2765, "tid": 2765,
    "ts": 1638252373293128, "dur": 40,
    "args": {
       "External id": 299,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1556): gelu;/miniconda/lib/python3.8/site-packages/torch/nn/modules/activation.py(652): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373293173,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436941307904, "Bytes": -75497472, "Total Allocated": 312900608, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373293371, "dur": 1,
    "args": {
       "External id": 303,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373293322, "dur": 53,
    "args": {
       "External id": 302,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373293276, "dur": 102,
    "args": {
       "External id": 301,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373293469, "dur": 3,
    "args": {
       "External id": 305,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373293528,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": 18874368, "Total Allocated": 331774976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373293521, "dur": 64,
    "args": {
       "External id": 306,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373293692, "dur": 2,
    "args": {
       "External id": 308,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373293647, "dur": 50,
    "args": {
       "External id": 307,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373293424, "dur": 276,
    "args": {
       "External id": 304,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373293746, "dur": 27,
    "args": {
       "External id": 309,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373293231, "dur": 544,
    "args": {
       "External id": 300,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [1536, 6144], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373293782,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140437645950976, "Bytes": -75497472, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373294009,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440676335616, "Bytes": 18874368, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373293999, "dur": 17,
    "args": {
       "External id": 313,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373293953, "dur": 66,
    "args": {
       "External id": 312,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373294116,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": 4718592, "Total Allocated": 279870464, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373294109, "dur": 13,
    "args": {
       "External id": 315,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373294065, "dur": 60,
    "args": {
       "External id": 314,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373293904, "dur": 247,
    "args": {
       "External id": 311,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373294156,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": -4718592, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373293853, "dur": 307,
    "args": {
       "External id": 310,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373294165,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": -18874368, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373294171,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": -18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373294176,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440638586880, "Bytes": -18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373294180,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": -18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373294188,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440619712512, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373294329,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373294325, "dur": 10,
    "args": {
       "External id": 318,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373294375,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225498112, "Bytes": 12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373294372, "dur": 9,
    "args": {
       "External id": 319,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373294422,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225510400, "Bytes": 12288, "Total Allocated": 199678976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373294419, "dur": 8,
    "args": {
       "External id": 320,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373294496, "dur": 2,
    "args": {
       "External id": 321,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373294538, "dur": 1,
    "args": {
       "External id": 322,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373294285, "dur": 259,
    "args": {
       "External id": 317,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373294547,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225498112, "Bytes": -12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373294552,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225510400, "Bytes": -12288, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373294248, "dur": 307,
    "args": {
       "External id": 316,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373294560,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440676335616, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373294725, "dur": 2,
    "args": {
       "External id": 326,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373294689, "dur": 40,
    "args": {
       "External id": 325,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373294655, "dur": 77,
    "args": {
       "External id": 324,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373294805, "dur": 3,
    "args": {
       "External id": 328,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373294852,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225559040, "Bytes": 122880, "Total Allocated": 180902912, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373294846, "dur": 45,
    "args": {
       "External id": 329,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 10]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373294969, "dur": 1,
    "args": {
       "External id": 331,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373294933, "dur": 39,
    "args": {
       "External id": 330,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373294769, "dur": 208,
    "args": {
       "External id": 327,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 10]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373294620, "dur": 359,
    "args": {
       "External id": 323,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [10, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373294985,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": -18874368, "Total Allocated": 162028544, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373295026, "dur": 2,
    "args": {
       "External id": 332,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 10], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373295061, "dur": 2,
    "args": {
       "External id": 333,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373295194, "dur": 0,
    "args": {
       "External id": 336,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373295240,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225804800, "Bytes": 122880, "Total Allocated": 162151424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_log_softmax", "pid": 2765, "tid": 2765,
    "ts": 1638252373295234, "dur": 35,
    "args": {
       "External id": 337,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::log_softmax", "pid": 2765, "tid": 2765,
    "ts": 1638252373295163, "dur": 109,
    "args": {
       "External id": 335,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373295401,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497088, "Bytes": 512, "Total Allocated": 162151936, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373295413,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225498112, "Bytes": 512, "Total Allocated": 162152448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2765, "tid": 2765,
    "ts": 1638252373295450, "dur": 1,
    "args": {
       "External id": 341,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2765, "tid": 2765,
    "ts": 1638252373295490, "dur": 0,
    "args": {
       "External id": 342,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss_forward", "pid": 2765, "tid": 2765,
    "ts": 1638252373295395, "dur": 119,
    "args": {
       "External id": 340,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373295517,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225498112, "Bytes": -512, "Total Allocated": 162151936, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss", "pid": 2765, "tid": 2765,
    "ts": 1638252373295363, "dur": 160,
    "args": {
       "External id": 339,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss_nd", "pid": 2765, "tid": 2765,
    "ts": 1638252373295319, "dur": 207,
    "args": {
       "External id": 338,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373295528,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225804800, "Bytes": -122880, "Total Allocated": 162029056, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::cross_entropy_loss", "pid": 2765, "tid": 2765,
    "ts": 1638252373295117, "dur": 414,
    "args": {
       "External id": 334,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373295538,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440175116288, "Bytes": -18874368, "Total Allocated": 143154688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "CheckpointFunction", "pid": 2765, "tid": 2765,
    "ts": 1638252373282050, "dur": 13601,
    "args": {
       "External id": 115,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Fwd thread id": 0, "Sequence number": 183
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2765, "tid": 2765,
    "ts": 1638252373295706, "dur": 1,
    "args": {
       "External id": 343,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [7093632]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1822): _use_fp32_param_shard;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1153): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373295776,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225681920, "Bytes": -122880, "Total Allocated": 143031808, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373295903,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497600, "Bytes": -512, "Total Allocated": 143031296, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "ProfilerStep#6", "pid": 2765, "tid": 2765,
    "ts": 1638252373277106, "dur": 27172,
    "args": {
       "External id": 4,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(330): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;"
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373304358,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904979262720, "Bytes": 4, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373304356, "dur": 9,
    "args": {
       "External id": 345,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zero_", "pid": 2765, "tid": 2765,
    "ts": 1638252373304388, "dur": 1,
    "args": {
       "External id": 346,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zeros", "pid": 2765, "tid": 2765,
    "ts": 1638252373304333, "dur": 58,
    "args": {
       "External id": 344,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373304454,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904980642176, "Bytes": 16, "Total Allocated": 5892, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373304453, "dur": 5,
    "args": {
       "External id": 348,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(330): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373304461,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904980642176, "Bytes": -16, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373304466,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904979262720, "Bytes": -4, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373304891,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904980648448, "Bytes": 4, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373304889, "dur": 8,
    "args": {
       "External id": 350,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zero_", "pid": 2765, "tid": 2765,
    "ts": 1638252373304921, "dur": 1,
    "args": {
       "External id": 351,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zeros", "pid": 2765, "tid": 2765,
    "ts": 1638252373304864, "dur": 60,
    "args": {
       "External id": 349,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373304980,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904980654400, "Bytes": 16, "Total Allocated": 5892, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373304979, "dur": 6,
    "args": {
       "External id": 353,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373304987,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904980654400, "Bytes": -16, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373304993,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904980648448, "Bytes": -4, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "enumerate(DataLoader)#_MultiProcessingDataLoaderIter.__next__", "pid": 2765, "tid": 2765,
    "ts": 1638252373304957, "dur": 232,
    "args": {
       "External id": 352,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;"
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373305196,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225447936, "Bytes": -24576, "Total Allocated": 143006720, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373305205,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225472512, "Bytes": -24576, "Total Allocated": 142982144, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373305384,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225447936, "Bytes": 24576, "Total Allocated": 143006720, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373305372, "dur": 19,
    "args": {
       "External id": 356,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373305411, "dur": 42,
    "args": {
       "External id": 357,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2765, "tid": 2765,
    "ts": 1638252373305347, "dur": 109,
    "args": {
       "External id": 355,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""], "Fwd thread id": 0, "Sequence number": 184
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373305239, "dur": 218,
    "args": {
       "External id": 354,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 184
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373305532,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225472512, "Bytes": 24576, "Total Allocated": 143031296, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373305524, "dur": 14,
    "args": {
       "External id": 360,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373305558, "dur": 32,
    "args": {
       "External id": 361,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2765, "tid": 2765,
    "ts": 1638252373305503, "dur": 88,
    "args": {
       "External id": 359,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""], "Fwd thread id": 0, "Sequence number": 184
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373305484, "dur": 109,
    "args": {
       "External id": 358,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 184
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373305757, "dur": 1,
    "args": {
       "External id": 362,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(479): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 184
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373305789, "dur": 0,
    "args": {
       "External id": 363,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(481): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 184
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2765, "tid": 2765,
    "ts": 1638252373305985, "dur": 1,
    "args": {
       "External id": 364,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[7093632], [28374528]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1570): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373306057, "dur": 1,
    "args": {
       "External id": 366,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373306029, "dur": 34,
    "args": {
       "External id": 365,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373306099, "dur": 4,
    "args": {
       "External id": 367,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2765, "tid": 2765,
    "ts": 1638252373306132, "dur": 0,
    "args": {
       "External id": 368,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [28374528]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373306313, "dur": 1,
    "args": {
       "External id": 372,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373306280, "dur": 36,
    "args": {
       "External id": 371,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373306249, "dur": 69,
    "args": {
       "External id": 370,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373306410, "dur": 1,
    "args": {
       "External id": 375,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373306379, "dur": 33,
    "args": {
       "External id": 374,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373306348, "dur": 66,
    "args": {
       "External id": 373,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373306504, "dur": 1,
    "args": {
       "External id": 378,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373306474, "dur": 33,
    "args": {
       "External id": 377,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373306443, "dur": 65,
    "args": {
       "External id": 376,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373306599, "dur": 1,
    "args": {
       "External id": 381,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373306568, "dur": 42,
    "args": {
       "External id": 380,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373306540, "dur": 73,
    "args": {
       "External id": 379,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373306709, "dur": 0,
    "args": {
       "External id": 384,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373306678, "dur": 33,
    "args": {
       "External id": 383,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373306650, "dur": 63,
    "args": {
       "External id": 382,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373306805, "dur": 1,
    "args": {
       "External id": 387,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373306777, "dur": 31,
    "args": {
       "External id": 386,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373306747, "dur": 63,
    "args": {
       "External id": 385,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373306899, "dur": 1,
    "args": {
       "External id": 390,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373306871, "dur": 31,
    "args": {
       "External id": 389,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373306840, "dur": 63,
    "args": {
       "External id": 388,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373306994, "dur": 1,
    "args": {
       "External id": 393,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373306964, "dur": 33,
    "args": {
       "External id": 392,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373306934, "dur": 65,
    "args": {
       "External id": 391,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373307092, "dur": 0,
    "args": {
       "External id": 396,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373307058, "dur": 36,
    "args": {
       "External id": 395,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373307028, "dur": 68,
    "args": {
       "External id": 394,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373307185, "dur": 1,
    "args": {
       "External id": 399,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373307155, "dur": 33,
    "args": {
       "External id": 398,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373307125, "dur": 64,
    "args": {
       "External id": 397,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373307278, "dur": 1,
    "args": {
       "External id": 402,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373307248, "dur": 33,
    "args": {
       "External id": 401,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373307220, "dur": 62,
    "args": {
       "External id": 400,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373307373, "dur": 1,
    "args": {
       "External id": 405,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373307345, "dur": 193,
    "args": {
       "External id": 404,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373307313, "dur": 227,
    "args": {
       "External id": 403,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373307642, "dur": 0,
    "args": {
       "External id": 408,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373307612, "dur": 32,
    "args": {
       "External id": 407,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373307577, "dur": 69,
    "args": {
       "External id": 406,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373307733, "dur": 1,
    "args": {
       "External id": 411,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373307705, "dur": 31,
    "args": {
       "External id": 410,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373307676, "dur": 62,
    "args": {
       "External id": 409,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373307824, "dur": 1,
    "args": {
       "External id": 414,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373307796, "dur": 31,
    "args": {
       "External id": 413,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373307767, "dur": 61,
    "args": {
       "External id": 412,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373307915, "dur": 1,
    "args": {
       "External id": 417,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373307886, "dur": 31,
    "args": {
       "External id": 416,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373307858, "dur": 61,
    "args": {
       "External id": 415,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373308005, "dur": 1,
    "args": {
       "External id": 420,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373307977, "dur": 31,
    "args": {
       "External id": 419,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373307948, "dur": 64,
    "args": {
       "External id": 418,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373308099, "dur": 1,
    "args": {
       "External id": 423,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373308070, "dur": 31,
    "args": {
       "External id": 422,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373308042, "dur": 61,
    "args": {
       "External id": 421,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373308189, "dur": 1,
    "args": {
       "External id": 426,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373308161, "dur": 31,
    "args": {
       "External id": 425,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373308132, "dur": 61,
    "args": {
       "External id": 424,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373308279, "dur": 1,
    "args": {
       "External id": 429,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373308251, "dur": 31,
    "args": {
       "External id": 428,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373308223, "dur": 61,
    "args": {
       "External id": 427,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373308370, "dur": 0,
    "args": {
       "External id": 432,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373308341, "dur": 31,
    "args": {
       "External id": 431,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373308313, "dur": 61,
    "args": {
       "External id": 430,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::split_with_sizes", "pid": 2765, "tid": 2765,
    "ts": 1638252373306213, "dur": 2175,
    "args": {
       "External id": 369,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Int"], "Fwd thread id": 0, "Sequence number": 184
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373308434, "dur": 6,
    "args": {
       "External id": 433,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9216], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 185
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373308479, "dur": 4,
    "args": {
       "External id": 434,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[15360], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 186
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373308517, "dur": 4,
    "args": {
       "External id": 435,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 187
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373308554, "dur": 6,
    "args": {
       "External id": 436,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 188
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373308592, "dur": 4,
    "args": {
       "External id": 437,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 189
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373308639, "dur": 4,
    "args": {
       "External id": 438,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 190
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373308675, "dur": 4,
    "args": {
       "External id": 439,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 191
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373308715, "dur": 3,
    "args": {
       "External id": 440,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 192
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373308753, "dur": 3,
    "args": {
       "External id": 441,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 193
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373308790, "dur": 4,
    "args": {
       "External id": 442,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 194
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373308826, "dur": 9,
    "args": {
       "External id": 443,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 195
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373308867, "dur": 4,
    "args": {
       "External id": 444,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 196
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373308905, "dur": 3,
    "args": {
       "External id": 445,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 197
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373308942, "dur": 3,
    "args": {
       "External id": 446,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 198
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373308979, "dur": 4,
    "args": {
       "External id": 447,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 199
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373309021, "dur": 3,
    "args": {
       "External id": 448,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 200
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373309056, "dur": 5,
    "args": {
       "External id": 449,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 201
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373309094, "dur": 3,
    "args": {
       "External id": 450,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 202
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373309131, "dur": 3,
    "args": {
       "External id": 451,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 203
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373309168, "dur": 3,
    "args": {
       "External id": 452,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 204
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373309205, "dur": 3,
    "args": {
       "External id": 453,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[15360], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 205
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373309302, "dur": 3,
    "args": {
       "External id": 454,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373309336, "dur": 0,
    "args": {
       "External id": 455,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 206
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "detach_", "pid": 2765, "tid": 2765,
    "ts": 1638252373309390, "dur": 1,
    "args": {
       "External id": 457,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::detach_", "pid": 2765, "tid": 2765,
    "ts": 1638252373309365, "dur": 28,
    "args": {
       "External id": 456,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"], "Fwd thread id": 0, "Sequence number": 206
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373309454,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904981149632, "Bytes": 5056, "Total Allocated": 10928, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373309483,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904979582528, "Bytes": 816, "Total Allocated": 11744, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373309600, "dur": 31,
    "args": {
       "External id": 461,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373309665, "dur": 27,
    "args": {
       "External id": 462,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2765, "tid": 2765,
    "ts": 1638252373309568, "dur": 129,
    "args": {
       "External id": 460,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373309537, "dur": 162,
    "args": {
       "External id": 459,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373309799, "dur": 6,
    "args": {
       "External id": 465,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373309837, "dur": 18,
    "args": {
       "External id": 466,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2765, "tid": 2765,
    "ts": 1638252373309767, "dur": 90,
    "args": {
       "External id": 464,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373309737, "dur": 122,
    "args": {
       "External id": 463,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 2765, "tid": 2765,
    "ts": 1638252373310012, "dur": 2,
    "args": {
       "External id": 469,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2765, "tid": 2765,
    "ts": 1638252373309975, "dur": 41,
    "args": {
       "External id": 468,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373310090, "dur": 6,
    "args": {
       "External id": 471,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373310145,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440175116288, "Bytes": 18874368, "Total Allocated": 161905664, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2765, "tid": 2765,
    "ts": 1638252373310138, "dur": 13,
    "args": {
       "External id": 472,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::index_select", "pid": 2765, "tid": 2765,
    "ts": 1638252373310053, "dur": 133,
    "args": {
       "External id": 470,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], [3072]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "long int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373310225, "dur": 2,
    "args": {
       "External id": 473,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::embedding", "pid": 2765, "tid": 2765,
    "ts": 1638252373309937, "dur": 294,
    "args": {
       "External id": 467,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [512, 6], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "Int", "Bool", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373310308, "dur": 1,
    "args": {
       "External id": 475,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373310277, "dur": 36,
    "args": {
       "External id": 474,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373310378, "dur": 0,
    "args": {
       "External id": 477,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373310346, "dur": 35,
    "args": {
       "External id": 476,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373310434,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": 18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 2765, "tid": 2765,
    "ts": 1638252373310424, "dur": 40,
    "args": {
       "External id": 478,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373310655,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440619712512, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373310645, "dur": 17,
    "args": {
       "External id": 482,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373310608, "dur": 57,
    "args": {
       "External id": 481,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373310745,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440638586880, "Bytes": 4718592, "Total Allocated": 204372992, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373310738, "dur": 13,
    "args": {
       "External id": 484,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373310702, "dur": 52,
    "args": {
       "External id": 483,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373310561, "dur": 219,
    "args": {
       "External id": 480,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373310784,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440638586880, "Bytes": -4718592, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373310524, "dur": 266,
    "args": {
       "External id": 479,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373310795,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373310973,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440638586880, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373310969, "dur": 10,
    "args": {
       "External id": 487,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373311027,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497600, "Bytes": 12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373311023, "dur": 10,
    "args": {
       "External id": 488,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373311080,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225509888, "Bytes": 12288, "Total Allocated": 199678976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373311076, "dur": 9,
    "args": {
       "External id": 489,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373311163, "dur": 5,
    "args": {
       "External id": 490,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373311209, "dur": 1,
    "args": {
       "External id": 491,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373310922, "dur": 293,
    "args": {
       "External id": 486,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373311218,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497600, "Bytes": -12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373311223,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225509888, "Bytes": -12288, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373310880, "dur": 350,
    "args": {
       "External id": 485,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373311430, "dur": 1,
    "args": {
       "External id": 495,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373311385, "dur": 51,
    "args": {
       "External id": 494,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373311340, "dur": 99,
    "args": {
       "External id": 493,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373311530, "dur": 3,
    "args": {
       "External id": 497,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373311588,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": 18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373311582, "dur": 78,
    "args": {
       "External id": 498,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373311758, "dur": 2,
    "args": {
       "External id": 500,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373311713, "dur": 49,
    "args": {
       "External id": 499,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373311485, "dur": 281,
    "args": {
       "External id": 496,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373311812, "dur": 29,
    "args": {
       "External id": 501,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373311296, "dur": 547,
    "args": {
       "External id": 492,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373311895, "dur": 4,
    "args": {
       "External id": 502,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373311985, "dur": 1,
    "args": {
       "External id": 504,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373311943, "dur": 49,
    "args": {
       "External id": 503,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373312185, "dur": 1,
    "args": {
       "External id": 508,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373312141, "dur": 52,
    "args": {
       "External id": 507,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373312097, "dur": 99,
    "args": {
       "External id": 506,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373312284, "dur": 2,
    "args": {
       "External id": 510,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373312341,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373312334, "dur": 63,
    "args": {
       "External id": 511,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373312494, "dur": 2,
    "args": {
       "External id": 513,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373312450, "dur": 50,
    "args": {
       "External id": 512,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373312239, "dur": 264,
    "args": {
       "External id": 509,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373312547, "dur": 26,
    "args": {
       "External id": 514,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373312053, "dur": 522,
    "args": {
       "External id": 505,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373312638, "dur": 4,
    "args": {
       "External id": 515,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373312729, "dur": 2,
    "args": {
       "External id": 517,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373312688, "dur": 46,
    "args": {
       "External id": 516,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373312933, "dur": 1,
    "args": {
       "External id": 521,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373312888, "dur": 51,
    "args": {
       "External id": 520,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373312843, "dur": 99,
    "args": {
       "External id": 519,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373313032, "dur": 2,
    "args": {
       "External id": 523,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373313089,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440676335616, "Bytes": 18874368, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373313083, "dur": 62,
    "args": {
       "External id": 524,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373313243, "dur": 1,
    "args": {
       "External id": 526,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373313197, "dur": 50,
    "args": {
       "External id": 525,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373312988, "dur": 262,
    "args": {
       "External id": 522,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373313295, "dur": 26,
    "args": {
       "External id": 527,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373312792, "dur": 531,
    "args": {
       "External id": 518,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373313371, "dur": 4,
    "args": {
       "External id": 528,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373313461, "dur": 1,
    "args": {
       "External id": 530,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373313420, "dur": 46,
    "args": {
       "External id": 529,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373313550, "dur": 2,
    "args": {
       "External id": 532,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373313510, "dur": 48,
    "args": {
       "External id": 531,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373313689, "dur": 1,
    "args": {
       "External id": 535,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373313648, "dur": 47,
    "args": {
       "External id": 534,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373313860,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": 18874368, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373313854, "dur": 15,
    "args": {
       "External id": 539,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373313814, "dur": 57,
    "args": {
       "External id": 538,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373313914, "dur": 29,
    "args": {
       "External id": 540,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2765, "tid": 2765,
    "ts": 1638252373313774, "dur": 172,
    "args": {
       "External id": 537,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373314028, "dur": 2,
    "args": {
       "External id": 542,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373313988, "dur": 44,
    "args": {
       "External id": 541,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2765, "tid": 2765,
    "ts": 1638252373313734, "dur": 300,
    "args": {
       "External id": 536,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373314116, "dur": 1,
    "args": {
       "External id": 544,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373314075, "dur": 45,
    "args": {
       "External id": 543,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373314288,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": 18874368, "Total Allocated": 294026240, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373314283, "dur": 11,
    "args": {
       "External id": 548,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373314243, "dur": 56,
    "args": {
       "External id": 547,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373314341, "dur": 23,
    "args": {
       "External id": 549,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2765, "tid": 2765,
    "ts": 1638252373314198, "dur": 168,
    "args": {
       "External id": 546,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373314448, "dur": 1,
    "args": {
       "External id": 551,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373314408, "dur": 43,
    "args": {
       "External id": 550,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2765, "tid": 2765,
    "ts": 1638252373314159, "dur": 294,
    "args": {
       "External id": 545,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373314539,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436576403456, "Bytes": 3538944, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373314535, "dur": 13,
    "args": {
       "External id": 553,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 2765, "tid": 2765,
    "ts": 1638252373314495, "dur": 79,
    "args": {
       "External id": 552,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], [24576, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373314662, "dur": 1,
    "args": {
       "External id": 555,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373314622, "dur": 44,
    "args": {
       "External id": 554,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373314669,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373314674,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": -18874368, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373313608, "dur": 1071,
    "args": {
       "External id": 533,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373314696,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904981482560, "Bytes": 8, "Total Allocated": 11752, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373314760,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436579942400, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mul", "pid": 2765, "tid": 2765,
    "ts": 1638252373314750, "dur": 39,
    "args": {
       "External id": 556,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373314794,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904981482560, "Bytes": -8, "Total Allocated": 11744, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373314802,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436576403456, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373314899, "dur": 2,
    "args": {
       "External id": 558,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373314860, "dur": 44,
    "args": {
       "External id": 557,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373314985, "dur": 1,
    "args": {
       "External id": 560,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373314945, "dur": 44,
    "args": {
       "External id": 559,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373315043,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904981518720, "Bytes": 8, "Total Allocated": 11752, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373315055,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497600, "Bytes": 512, "Total Allocated": 259816960, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373315062,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904981518720, "Bytes": -8, "Total Allocated": 11744, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::eq", "pid": 2765, "tid": 2765,
    "ts": 1638252373315040, "dur": 47,
    "args": {
       "External id": 561,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373315221, "dur": 2,
    "args": {
       "External id": 564,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373315181, "dur": 47,
    "args": {
       "External id": 563,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373315310, "dur": 1,
    "args": {
       "External id": 566,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373315270, "dur": 44,
    "args": {
       "External id": 565,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373315440,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436583481344, "Bytes": 3538944, "Total Allocated": 263355904, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373315435, "dur": 12,
    "args": {
       "External id": 569,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373315395, "dur": 54,
    "args": {
       "External id": 568,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373315492, "dur": 34,
    "args": {
       "External id": 570,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2765, "tid": 2765,
    "ts": 1638252373315355, "dur": 173,
    "args": {
       "External id": 567,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373315661, "dur": 2,
    "args": {
       "External id": 573,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373315621, "dur": 44,
    "args": {
       "External id": 572,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill_", "pid": 2765, "tid": 2765,
    "ts": 1638252373315569, "dur": 124,
    "args": {
       "External id": 571,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill", "pid": 2765, "tid": 2765,
    "ts": 1638252373315140, "dur": 556,
    "args": {
       "External id": 562,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373315701,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497600, "Bytes": -512, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373315707,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436579942400, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373315812,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436587020288, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_softmax", "pid": 2765, "tid": 2765,
    "ts": 1638252373315806, "dur": 33,
    "args": {
       "External id": 575,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::softmax", "pid": 2765, "tid": 2765,
    "ts": 1638252373315764, "dur": 77,
    "args": {
       "External id": 574,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373315845,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436583481344, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373316071,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436590559232, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373316061, "dur": 16,
    "args": {
       "External id": 579,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373316016, "dur": 66,
    "args": {
       "External id": 578,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373316180,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225681920, "Bytes": 884736, "Total Allocated": 264240128, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373316173, "dur": 13,
    "args": {
       "External id": 581,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373316127, "dur": 61,
    "args": {
       "External id": 580,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373315966, "dur": 249,
    "args": {
       "External id": 577,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373316218,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225681920, "Bytes": -884736, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373315921, "dur": 301,
    "args": {
       "External id": 576,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373316228,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436587020288, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373316359, "dur": 2,
    "args": {
       "External id": 584,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373316319, "dur": 45,
    "args": {
       "External id": 583,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 2765, "tid": 2765,
    "ts": 1638252373316447, "dur": 3,
    "args": {
       "External id": 586,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2765, "tid": 2765,
    "ts": 1638252373316406, "dur": 47,
    "args": {
       "External id": 585,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373316535, "dur": 2,
    "args": {
       "External id": 588,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373316496, "dur": 43,
    "args": {
       "External id": 587,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373316715,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436594098176, "Bytes": 18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373316709, "dur": 12,
    "args": {
       "External id": 592,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373316669, "dur": 55,
    "args": {
       "External id": 591,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373316765, "dur": 28,
    "args": {
       "External id": 593,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2765, "tid": 2765,
    "ts": 1638252373316625, "dur": 171,
    "args": {
       "External id": 590,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373316880, "dur": 1,
    "args": {
       "External id": 595,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373316839, "dur": 45,
    "args": {
       "External id": 594,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2765, "tid": 2765,
    "ts": 1638252373316578, "dur": 308,
    "args": {
       "External id": 589,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373316975,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373316970, "dur": 13,
    "args": {
       "External id": 597,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 2765, "tid": 2765,
    "ts": 1638252373316928, "dur": 81,
    "args": {
       "External id": 596,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], [24576, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373317090, "dur": 1,
    "args": {
       "External id": 599,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373317050, "dur": 43,
    "args": {
       "External id": 598,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373317097,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436594098176, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373316275, "dur": 826,
    "args": {
       "External id": 582,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373317189, "dur": 2,
    "args": {
       "External id": 601,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373317149, "dur": 45,
    "args": {
       "External id": 600,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373317365,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436594098176, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373317361, "dur": 10,
    "args": {
       "External id": 605,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373317321, "dur": 52,
    "args": {
       "External id": 604,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373317415, "dur": 25,
    "args": {
       "External id": 606,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2765, "tid": 2765,
    "ts": 1638252373317281, "dur": 161,
    "args": {
       "External id": 603,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::contiguous", "pid": 2765, "tid": 2765,
    "ts": 1638252373317242, "dur": 202,
    "args": {
       "External id": 602,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373317498, "dur": 4,
    "args": {
       "External id": 607,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373317506,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373317715, "dur": 2,
    "args": {
       "External id": 611,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373317671, "dur": 48,
    "args": {
       "External id": 610,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373317626, "dur": 96,
    "args": {
       "External id": 609,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373317812, "dur": 3,
    "args": {
       "External id": 613,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373317870,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373317863, "dur": 69,
    "args": {
       "External id": 614,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373318032, "dur": 2,
    "args": {
       "External id": 616,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373317985, "dur": 51,
    "args": {
       "External id": 615,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373317767, "dur": 272,
    "args": {
       "External id": 612,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373318086, "dur": 27,
    "args": {
       "External id": 617,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373317575, "dur": 541,
    "args": {
       "External id": 608,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373318330,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": 18874368, "Total Allocated": 316439552, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373318320, "dur": 19,
    "args": {
       "External id": 621,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373318275, "dur": 67,
    "args": {
       "External id": 620,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373318441,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436576403456, "Bytes": 4718592, "Total Allocated": 321158144, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373318433, "dur": 14,
    "args": {
       "External id": 623,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373318389, "dur": 60,
    "args": {
       "External id": 622,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373318226, "dur": 249,
    "args": {
       "External id": 619,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373318478,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436576403456, "Bytes": -4718592, "Total Allocated": 316439552, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373318181, "dur": 301,
    "args": {
       "External id": 618,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373318487,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": -18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373318496,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436594098176, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373318501,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": -18874368, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373318506,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": -18874368, "Total Allocated": 240942080, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373318511,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440676335616, "Bytes": -18874368, "Total Allocated": 222067712, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373318515,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436590559232, "Bytes": -3538944, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373318572,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 2765, "tid": 2765,
    "ts": 1638252373318565, "dur": 32,
    "args": {
       "External id": 624,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373318611,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": -18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373318776,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373318771, "dur": 11,
    "args": {
       "External id": 627,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373318831,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497600, "Bytes": 12288, "Total Allocated": 237415424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373318828, "dur": 9,
    "args": {
       "External id": 628,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373318884,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225509888, "Bytes": 12288, "Total Allocated": 237427712, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373318880, "dur": 9,
    "args": {
       "External id": 629,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373318964, "dur": 2,
    "args": {
       "External id": 630,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373319010, "dur": 1,
    "args": {
       "External id": 631,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373318725, "dur": 291,
    "args": {
       "External id": 626,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373319019,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497600, "Bytes": -12288, "Total Allocated": 237415424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373319024,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225509888, "Bytes": -12288, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373318679, "dur": 348,
    "args": {
       "External id": 625,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373319234, "dur": 2,
    "args": {
       "External id": 635,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373319184, "dur": 54,
    "args": {
       "External id": 634,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373319138, "dur": 103,
    "args": {
       "External id": 633,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373319338, "dur": 2,
    "args": {
       "External id": 637,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373319451,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436941307904, "Bytes": 75497472, "Total Allocated": 312900608, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373319444, "dur": 50,
    "args": {
       "External id": 638,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373319638, "dur": 2,
    "args": {
       "External id": 640,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373319547, "dur": 95,
    "args": {
       "External id": 639,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373319287, "dur": 358,
    "args": {
       "External id": 636,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373319704, "dur": 29,
    "args": {
       "External id": 641,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373319094, "dur": 641,
    "args": {
       "External id": 632,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [6144, 1536], [6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373319821,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140437645950976, "Bytes": 75497472, "Total Allocated": 388398080, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::gelu", "pid": 2765, "tid": 2765,
    "ts": 1638252373319813, "dur": 37,
    "args": {
       "External id": 642,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1556): gelu;/miniconda/lib/python3.8/site-packages/torch/nn/modules/activation.py(652): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373319883,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436941307904, "Bytes": -75497472, "Total Allocated": 312900608, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373320130, "dur": 1,
    "args": {
       "External id": 646,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373320071, "dur": 63,
    "args": {
       "External id": 645,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373320022, "dur": 115,
    "args": {
       "External id": 644,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373320282, "dur": 3,
    "args": {
       "External id": 648,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373320341,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": 18874368, "Total Allocated": 331774976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373320334, "dur": 69,
    "args": {
       "External id": 649,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373320505, "dur": 2,
    "args": {
       "External id": 651,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373320460, "dur": 49,
    "args": {
       "External id": 650,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373320195, "dur": 318,
    "args": {
       "External id": 647,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373320559, "dur": 27,
    "args": {
       "External id": 652,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373319976, "dur": 612,
    "args": {
       "External id": 643,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [1536, 6144], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373320596,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140437645950976, "Bytes": -75497472, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373320826,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440676335616, "Bytes": 18874368, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373320817, "dur": 16,
    "args": {
       "External id": 656,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373320771, "dur": 67,
    "args": {
       "External id": 655,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373320936,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": 4718592, "Total Allocated": 279870464, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373320929, "dur": 13,
    "args": {
       "External id": 658,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373320885, "dur": 60,
    "args": {
       "External id": 657,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373320721, "dur": 250,
    "args": {
       "External id": 654,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373320975,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": -4718592, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373320674, "dur": 305,
    "args": {
       "External id": 653,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373320984,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": -18874368, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373320990,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": -18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373320994,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440638586880, "Bytes": -18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373320998,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": -18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373321005,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440619712512, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373321154,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373321149, "dur": 11,
    "args": {
       "External id": 661,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373321202,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497600, "Bytes": 12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373321198, "dur": 10,
    "args": {
       "External id": 662,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373321249,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225509888, "Bytes": 12288, "Total Allocated": 199678976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373321246, "dur": 8,
    "args": {
       "External id": 663,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373321328, "dur": 2,
    "args": {
       "External id": 664,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373321368, "dur": 1,
    "args": {
       "External id": 665,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373321109, "dur": 265,
    "args": {
       "External id": 660,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373321377,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497600, "Bytes": -12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373321381,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225509888, "Bytes": -12288, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373321072, "dur": 313,
    "args": {
       "External id": 659,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373321390,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440676335616, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373321548, "dur": 2,
    "args": {
       "External id": 669,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373321512, "dur": 40,
    "args": {
       "External id": 668,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373321478, "dur": 77,
    "args": {
       "External id": 667,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373321636, "dur": 3,
    "args": {
       "External id": 671,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373321683,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225681920, "Bytes": 122880, "Total Allocated": 180902912, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373321677, "dur": 44,
    "args": {
       "External id": 672,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 10]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373321800, "dur": 1,
    "args": {
       "External id": 674,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373321764, "dur": 39,
    "args": {
       "External id": 673,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373321593, "dur": 213,
    "args": {
       "External id": 670,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 10]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373321442, "dur": 366,
    "args": {
       "External id": 666,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [10, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373321814,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": -18874368, "Total Allocated": 162028544, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373321853, "dur": 2,
    "args": {
       "External id": 675,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 10], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373321890, "dur": 2,
    "args": {
       "External id": 676,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373322000, "dur": 1,
    "args": {
       "External id": 679,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373322040,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225804800, "Bytes": 122880, "Total Allocated": 162151424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_log_softmax", "pid": 2765, "tid": 2765,
    "ts": 1638252373322035, "dur": 33,
    "args": {
       "External id": 680,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::log_softmax", "pid": 2765, "tid": 2765,
    "ts": 1638252373321970, "dur": 101,
    "args": {
       "External id": 678,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373322181,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497600, "Bytes": 512, "Total Allocated": 162151936, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373322191,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225498112, "Bytes": 512, "Total Allocated": 162152448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2765, "tid": 2765,
    "ts": 1638252373322231, "dur": 0,
    "args": {
       "External id": 684,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2765, "tid": 2765,
    "ts": 1638252373322262, "dur": 1,
    "args": {
       "External id": 685,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss_forward", "pid": 2765, "tid": 2765,
    "ts": 1638252373322176, "dur": 109,
    "args": {
       "External id": 683,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373322288,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225498112, "Bytes": -512, "Total Allocated": 162151936, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss", "pid": 2765, "tid": 2765,
    "ts": 1638252373322142, "dur": 150,
    "args": {
       "External id": 682,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss_nd", "pid": 2765, "tid": 2765,
    "ts": 1638252373322108, "dur": 186,
    "args": {
       "External id": 681,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373322296,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225804800, "Bytes": -122880, "Total Allocated": 162029056, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::cross_entropy_loss", "pid": 2765, "tid": 2765,
    "ts": 1638252373321936, "dur": 364,
    "args": {
       "External id": 677,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373322307,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440175116288, "Bytes": -18874368, "Total Allocated": 143154688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "CheckpointFunction", "pid": 2765, "tid": 2765,
    "ts": 1638252373309421, "dur": 12989,
    "args": {
       "External id": 458,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Fwd thread id": 0, "Sequence number": 206
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2765, "tid": 2765,
    "ts": 1638252373322463, "dur": 0,
    "args": {
       "External id": 686,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [7093632]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1822): _use_fp32_param_shard;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1153): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373322531,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225559040, "Bytes": -122880, "Total Allocated": 143031808, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373322564,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904979651456, "Bytes": -5056, "Total Allocated": 6688, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373322572,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904979276096, "Bytes": -816, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373322582,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497088, "Bytes": -512, "Total Allocated": 143031296, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "ProfilerStep#7", "pid": 2765, "tid": 2765,
    "ts": 1638252373304432, "dur": 26822,
    "args": {
       "External id": 347,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(330): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;"
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373331332,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904979654912, "Bytes": 4, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373331329, "dur": 9,
    "args": {
       "External id": 688,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zero_", "pid": 2765, "tid": 2765,
    "ts": 1638252373331361, "dur": 1,
    "args": {
       "External id": 689,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zeros", "pid": 2765, "tid": 2765,
    "ts": 1638252373331306, "dur": 58,
    "args": {
       "External id": 687,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373331421,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904981992064, "Bytes": 16, "Total Allocated": 5892, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373331420, "dur": 5,
    "args": {
       "External id": 691,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(330): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373331427,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904981992064, "Bytes": -16, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373331433,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904979654912, "Bytes": -4, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373331491,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904981997504, "Bytes": 4, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373331490, "dur": 5,
    "args": {
       "External id": 693,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zero_", "pid": 2765, "tid": 2765,
    "ts": 1638252373331520, "dur": 1,
    "args": {
       "External id": 694,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zeros", "pid": 2765, "tid": 2765,
    "ts": 1638252373331466, "dur": 58,
    "args": {
       "External id": 692,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373331574,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904982003520, "Bytes": 16, "Total Allocated": 5892, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373331573, "dur": 8,
    "args": {
       "External id": 696,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373331582,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904982003520, "Bytes": -16, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373331587,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904981997504, "Bytes": -4, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "enumerate(DataLoader)#_MultiProcessingDataLoaderIter.__next__", "pid": 2765, "tid": 2765,
    "ts": 1638252373331552, "dur": 235,
    "args": {
       "External id": 695,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;"
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373331893,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225447936, "Bytes": -24576, "Total Allocated": 143006720, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373331899,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225472512, "Bytes": -24576, "Total Allocated": 142982144, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373332005,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225447936, "Bytes": 24576, "Total Allocated": 143006720, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373331995, "dur": 17,
    "args": {
       "External id": 699,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373332032, "dur": 41,
    "args": {
       "External id": 700,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2765, "tid": 2765,
    "ts": 1638252373331973, "dur": 102,
    "args": {
       "External id": 698,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""], "Fwd thread id": 0, "Sequence number": 207
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373331947, "dur": 130,
    "args": {
       "External id": 697,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 207
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373332150,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225472512, "Bytes": 24576, "Total Allocated": 143031296, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373332142, "dur": 18,
    "args": {
       "External id": 703,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373332179, "dur": 32,
    "args": {
       "External id": 704,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2765, "tid": 2765,
    "ts": 1638252373332122, "dur": 91,
    "args": {
       "External id": 702,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""], "Fwd thread id": 0, "Sequence number": 207
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373332103, "dur": 112,
    "args": {
       "External id": 701,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 207
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373332373, "dur": 1,
    "args": {
       "External id": 705,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(479): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 207
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373332407, "dur": 0,
    "args": {
       "External id": 706,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(481): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 207
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2765, "tid": 2765,
    "ts": 1638252373332599, "dur": 11,
    "args": {
       "External id": 707,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[7093632], [28374528]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1570): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373332677, "dur": 4,
    "args": {
       "External id": 709,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373332649, "dur": 36,
    "args": {
       "External id": 708,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373332717, "dur": 4,
    "args": {
       "External id": 710,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2765, "tid": 2765,
    "ts": 1638252373332756, "dur": 1,
    "args": {
       "External id": 711,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [28374528]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373332933, "dur": 1,
    "args": {
       "External id": 715,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373332901, "dur": 35,
    "args": {
       "External id": 714,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373332869, "dur": 69,
    "args": {
       "External id": 713,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373333030, "dur": 1,
    "args": {
       "External id": 718,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373332999, "dur": 36,
    "args": {
       "External id": 717,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373332968, "dur": 69,
    "args": {
       "External id": 716,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373333129, "dur": 1,
    "args": {
       "External id": 721,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373333099, "dur": 33,
    "args": {
       "External id": 720,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373333070, "dur": 64,
    "args": {
       "External id": 719,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373333226, "dur": 0,
    "args": {
       "External id": 724,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373333195, "dur": 33,
    "args": {
       "External id": 723,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373333167, "dur": 63,
    "args": {
       "External id": 722,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373333321, "dur": 0,
    "args": {
       "External id": 727,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373333292, "dur": 31,
    "args": {
       "External id": 726,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373333261, "dur": 64,
    "args": {
       "External id": 725,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373333415, "dur": 1,
    "args": {
       "External id": 730,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373333387, "dur": 33,
    "args": {
       "External id": 729,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373333356, "dur": 65,
    "args": {
       "External id": 728,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373333513, "dur": 1,
    "args": {
       "External id": 733,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373333483, "dur": 33,
    "args": {
       "External id": 732,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373333453, "dur": 64,
    "args": {
       "External id": 731,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373333613, "dur": 1,
    "args": {
       "External id": 736,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373333577, "dur": 39,
    "args": {
       "External id": 735,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373333546, "dur": 71,
    "args": {
       "External id": 734,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373333707, "dur": 1,
    "args": {
       "External id": 739,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373333677, "dur": 33,
    "args": {
       "External id": 738,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373333648, "dur": 63,
    "args": {
       "External id": 737,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373333802, "dur": 1,
    "args": {
       "External id": 742,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373333772, "dur": 33,
    "args": {
       "External id": 741,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373333744, "dur": 62,
    "args": {
       "External id": 740,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373333900, "dur": 0,
    "args": {
       "External id": 745,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373333871, "dur": 31,
    "args": {
       "External id": 744,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373333837, "dur": 69,
    "args": {
       "External id": 743,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373333996, "dur": 3,
    "args": {
       "External id": 748,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373333968, "dur": 33,
    "args": {
       "External id": 747,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373333937, "dur": 66,
    "args": {
       "External id": 746,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373334092, "dur": 1,
    "args": {
       "External id": 751,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373334062, "dur": 33,
    "args": {
       "External id": 750,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373334032, "dur": 64,
    "args": {
       "External id": 749,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373334186, "dur": 1,
    "args": {
       "External id": 754,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373334156, "dur": 33,
    "args": {
       "External id": 753,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373334126, "dur": 64,
    "args": {
       "External id": 752,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373334282, "dur": 1,
    "args": {
       "External id": 757,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373334250, "dur": 35,
    "args": {
       "External id": 756,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373334221, "dur": 65,
    "args": {
       "External id": 755,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373334379, "dur": 1,
    "args": {
       "External id": 760,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373334349, "dur": 35,
    "args": {
       "External id": 759,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373334321, "dur": 65,
    "args": {
       "External id": 758,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373334475, "dur": 1,
    "args": {
       "External id": 763,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373334447, "dur": 30,
    "args": {
       "External id": 762,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373334416, "dur": 63,
    "args": {
       "External id": 761,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373334570, "dur": 1,
    "args": {
       "External id": 766,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373334540, "dur": 33,
    "args": {
       "External id": 765,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373334510, "dur": 64,
    "args": {
       "External id": 764,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373334670, "dur": 0,
    "args": {
       "External id": 769,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373334639, "dur": 33,
    "args": {
       "External id": 768,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373334609, "dur": 65,
    "args": {
       "External id": 767,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373334763, "dur": 1,
    "args": {
       "External id": 772,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373334733, "dur": 32,
    "args": {
       "External id": 771,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373334703, "dur": 64,
    "args": {
       "External id": 770,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373334860, "dur": 1,
    "args": {
       "External id": 775,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373334829, "dur": 34,
    "args": {
       "External id": 774,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373334800, "dur": 64,
    "args": {
       "External id": 773,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::split_with_sizes", "pid": 2765, "tid": 2765,
    "ts": 1638252373332833, "dur": 2049,
    "args": {
       "External id": 712,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Int"], "Fwd thread id": 0, "Sequence number": 207
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373334924, "dur": 6,
    "args": {
       "External id": 776,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9216], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 208
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373334969, "dur": 4,
    "args": {
       "External id": 777,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[15360], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 209
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373335007, "dur": 6,
    "args": {
       "External id": 778,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 210
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373335046, "dur": 3,
    "args": {
       "External id": 779,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 211
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373335083, "dur": 4,
    "args": {
       "External id": 780,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 212
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373335125, "dur": 4,
    "args": {
       "External id": 781,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 213
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373335161, "dur": 5,
    "args": {
       "External id": 782,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 214
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373335199, "dur": 3,
    "args": {
       "External id": 783,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 215
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373335236, "dur": 3,
    "args": {
       "External id": 784,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 216
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373335273, "dur": 4,
    "args": {
       "External id": 785,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 217
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373335310, "dur": 4,
    "args": {
       "External id": 786,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 218
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373335348, "dur": 5,
    "args": {
       "External id": 787,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 219
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373335384, "dur": 6,
    "args": {
       "External id": 788,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 220
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373335421, "dur": 4,
    "args": {
       "External id": 789,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 221
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373335459, "dur": 4,
    "args": {
       "External id": 790,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 222
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373335496, "dur": 4,
    "args": {
       "External id": 791,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 223
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373335533, "dur": 3,
    "args": {
       "External id": 792,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 224
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373335570, "dur": 3,
    "args": {
       "External id": 793,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 225
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373335610, "dur": 5,
    "args": {
       "External id": 794,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 226
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373335648, "dur": 3,
    "args": {
       "External id": 795,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 227
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373335684, "dur": 4,
    "args": {
       "External id": 796,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[15360], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 228
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373335779, "dur": 2,
    "args": {
       "External id": 797,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373335811, "dur": 1,
    "args": {
       "External id": 798,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 229
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "detach_", "pid": 2765, "tid": 2765,
    "ts": 1638252373335866, "dur": 1,
    "args": {
       "External id": 800,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::detach_", "pid": 2765, "tid": 2765,
    "ts": 1638252373335840, "dur": 28,
    "args": {
       "External id": 799,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"], "Fwd thread id": 0, "Sequence number": 229
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373335929,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904982302016, "Bytes": 5056, "Total Allocated": 10928, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373335959,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904979695744, "Bytes": 816, "Total Allocated": 11744, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373336075, "dur": 9,
    "args": {
       "External id": 804,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373336116, "dur": 29,
    "args": {
       "External id": 805,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2765, "tid": 2765,
    "ts": 1638252373336043, "dur": 105,
    "args": {
       "External id": 803,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373336013, "dur": 136,
    "args": {
       "External id": 802,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373336246, "dur": 6,
    "args": {
       "External id": 808,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373336284, "dur": 18,
    "args": {
       "External id": 809,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2765, "tid": 2765,
    "ts": 1638252373336216, "dur": 88,
    "args": {
       "External id": 807,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373336186, "dur": 120,
    "args": {
       "External id": 806,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 2765, "tid": 2765,
    "ts": 1638252373336457, "dur": 2,
    "args": {
       "External id": 812,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2765, "tid": 2765,
    "ts": 1638252373336422, "dur": 41,
    "args": {
       "External id": 811,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373336881, "dur": 7,
    "args": {
       "External id": 814,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373336936,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440175116288, "Bytes": 18874368, "Total Allocated": 161905664, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2765, "tid": 2765,
    "ts": 1638252373336929, "dur": 14,
    "args": {
       "External id": 815,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::index_select", "pid": 2765, "tid": 2765,
    "ts": 1638252373336841, "dur": 138,
    "args": {
       "External id": 813,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], [3072]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "long int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373337017, "dur": 3,
    "args": {
       "External id": 816,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::embedding", "pid": 2765, "tid": 2765,
    "ts": 1638252373336384, "dur": 640,
    "args": {
       "External id": 810,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [512, 6], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "Int", "Bool", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373337102, "dur": 1,
    "args": {
       "External id": 818,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373337071, "dur": 37,
    "args": {
       "External id": 817,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373337169, "dur": 0,
    "args": {
       "External id": 820,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373337139, "dur": 33,
    "args": {
       "External id": 819,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373337228,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": 18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 2765, "tid": 2765,
    "ts": 1638252373337217, "dur": 43,
    "args": {
       "External id": 821,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373337434,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440619712512, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373337425, "dur": 16,
    "args": {
       "External id": 825,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373337390, "dur": 58,
    "args": {
       "External id": 824,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373337525,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440638586880, "Bytes": 4718592, "Total Allocated": 204372992, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373337518, "dur": 13,
    "args": {
       "External id": 827,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373337484, "dur": 49,
    "args": {
       "External id": 826,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373337352, "dur": 208,
    "args": {
       "External id": 823,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373337563,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440638586880, "Bytes": -4718592, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373337317, "dur": 250,
    "args": {
       "External id": 822,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373337572,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373337743,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440638586880, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373337739, "dur": 10,
    "args": {
       "External id": 830,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373337795,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225498112, "Bytes": 12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373337791, "dur": 10,
    "args": {
       "External id": 831,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373337846,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225510400, "Bytes": 12288, "Total Allocated": 199678976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373337842, "dur": 9,
    "args": {
       "External id": 832,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373337929, "dur": 3,
    "args": {
       "External id": 833,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373337973, "dur": 1,
    "args": {
       "External id": 834,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373337695, "dur": 284,
    "args": {
       "External id": 829,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373337982,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225498112, "Bytes": -12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373337987,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225510400, "Bytes": -12288, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373337654, "dur": 336,
    "args": {
       "External id": 828,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373338187, "dur": 1,
    "args": {
       "External id": 838,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373338144, "dur": 47,
    "args": {
       "External id": 837,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373338100, "dur": 95,
    "args": {
       "External id": 836,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373338281, "dur": 3,
    "args": {
       "External id": 840,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373338338,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": 18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373338332, "dur": 68,
    "args": {
       "External id": 841,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373338495, "dur": 1,
    "args": {
       "External id": 843,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373338452, "dur": 47,
    "args": {
       "External id": 842,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373338238, "dur": 267,
    "args": {
       "External id": 839,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373338550, "dur": 29,
    "args": {
       "External id": 844,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373338057, "dur": 525,
    "args": {
       "External id": 835,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373338642, "dur": 4,
    "args": {
       "External id": 845,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373338731, "dur": 1,
    "args": {
       "External id": 847,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373338690, "dur": 46,
    "args": {
       "External id": 846,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373338922, "dur": 2,
    "args": {
       "External id": 851,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373338880, "dur": 46,
    "args": {
       "External id": 850,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373338837, "dur": 92,
    "args": {
       "External id": 849,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373339015, "dur": 2,
    "args": {
       "External id": 853,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373339070,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373339064, "dur": 62,
    "args": {
       "External id": 854,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373339219, "dur": 2,
    "args": {
       "External id": 856,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373339177, "dur": 46,
    "args": {
       "External id": 855,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373338972, "dur": 257,
    "args": {
       "External id": 852,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373339273, "dur": 27,
    "args": {
       "External id": 857,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373338795, "dur": 507,
    "args": {
       "External id": 848,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373339350, "dur": 3,
    "args": {
       "External id": 858,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373339436, "dur": 1,
    "args": {
       "External id": 860,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373339397, "dur": 43,
    "args": {
       "External id": 859,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373339630, "dur": 1,
    "args": {
       "External id": 864,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373339580, "dur": 54,
    "args": {
       "External id": 863,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373339538, "dur": 98,
    "args": {
       "External id": 862,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373339727, "dur": 2,
    "args": {
       "External id": 866,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373339785,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440676335616, "Bytes": 18874368, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373339778, "dur": 62,
    "args": {
       "External id": 867,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373339938, "dur": 2,
    "args": {
       "External id": 869,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373339893, "dur": 49,
    "args": {
       "External id": 868,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373339681, "dur": 264,
    "args": {
       "External id": 865,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373339994, "dur": 25,
    "args": {
       "External id": 870,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373339497, "dur": 524,
    "args": {
       "External id": 861,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373340070, "dur": 4,
    "args": {
       "External id": 871,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373340161, "dur": 1,
    "args": {
       "External id": 873,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373340119, "dur": 47,
    "args": {
       "External id": 872,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373340252, "dur": 2,
    "args": {
       "External id": 875,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373340212, "dur": 45,
    "args": {
       "External id": 874,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373340384, "dur": 1,
    "args": {
       "External id": 878,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373340342, "dur": 46,
    "args": {
       "External id": 877,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373340553,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": 18874368, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373340547, "dur": 14,
    "args": {
       "External id": 882,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373340508, "dur": 56,
    "args": {
       "External id": 881,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373340613, "dur": 30,
    "args": {
       "External id": 883,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2765, "tid": 2765,
    "ts": 1638252373340467, "dur": 178,
    "args": {
       "External id": 880,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373340730, "dur": 2,
    "args": {
       "External id": 885,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373340691, "dur": 43,
    "args": {
       "External id": 884,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2765, "tid": 2765,
    "ts": 1638252373340427, "dur": 309,
    "args": {
       "External id": 879,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373340818, "dur": 2,
    "args": {
       "External id": 887,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373340777, "dur": 46,
    "args": {
       "External id": 886,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373340993,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": 18874368, "Total Allocated": 294026240, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373340988, "dur": 12,
    "args": {
       "External id": 891,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373340949, "dur": 54,
    "args": {
       "External id": 890,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373341044, "dur": 24,
    "args": {
       "External id": 892,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2765, "tid": 2765,
    "ts": 1638252373340909, "dur": 161,
    "args": {
       "External id": 889,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373341156, "dur": 2,
    "args": {
       "External id": 894,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373341117, "dur": 43,
    "args": {
       "External id": 893,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2765, "tid": 2765,
    "ts": 1638252373340862, "dur": 300,
    "args": {
       "External id": 888,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373341250,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436576403456, "Bytes": 3538944, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373341246, "dur": 13,
    "args": {
       "External id": 896,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 2765, "tid": 2765,
    "ts": 1638252373341204, "dur": 80,
    "args": {
       "External id": 895,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], [24576, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373341365, "dur": 4,
    "args": {
       "External id": 898,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373341328, "dur": 43,
    "args": {
       "External id": 897,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373341374,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373341379,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": -18874368, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373340300, "dur": 1083,
    "args": {
       "External id": 876,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373341397,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904983040896, "Bytes": 8, "Total Allocated": 11752, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373341456,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436579942400, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mul", "pid": 2765, "tid": 2765,
    "ts": 1638252373341446, "dur": 36,
    "args": {
       "External id": 899,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373341487,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904983040896, "Bytes": -8, "Total Allocated": 11744, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373341493,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436576403456, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373341597, "dur": 1,
    "args": {
       "External id": 901,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373341551, "dur": 60,
    "args": {
       "External id": 900,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373341694, "dur": 1,
    "args": {
       "External id": 903,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373341654, "dur": 45,
    "args": {
       "External id": 902,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373341751,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904983063296, "Bytes": 8, "Total Allocated": 11752, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373341763,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497088, "Bytes": 512, "Total Allocated": 259816960, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373341770,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904983063296, "Bytes": -8, "Total Allocated": 11744, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::eq", "pid": 2765, "tid": 2765,
    "ts": 1638252373341748, "dur": 48,
    "args": {
       "External id": 904,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373341929, "dur": 2,
    "args": {
       "External id": 907,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373341889, "dur": 45,
    "args": {
       "External id": 906,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373342015, "dur": 1,
    "args": {
       "External id": 909,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373341975, "dur": 44,
    "args": {
       "External id": 908,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373342147,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436583481344, "Bytes": 3538944, "Total Allocated": 263355904, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373342142, "dur": 12,
    "args": {
       "External id": 912,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373342102, "dur": 55,
    "args": {
       "External id": 911,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373342198, "dur": 34,
    "args": {
       "External id": 913,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2765, "tid": 2765,
    "ts": 1638252373342062, "dur": 174,
    "args": {
       "External id": 910,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373342362, "dur": 2,
    "args": {
       "External id": 916,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373342321, "dur": 45,
    "args": {
       "External id": 915,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill_", "pid": 2765, "tid": 2765,
    "ts": 1638252373342280, "dur": 113,
    "args": {
       "External id": 914,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill", "pid": 2765, "tid": 2765,
    "ts": 1638252373341848, "dur": 548,
    "args": {
       "External id": 905,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373342400,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497088, "Bytes": -512, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373342406,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436579942400, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373342506,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436587020288, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_softmax", "pid": 2765, "tid": 2765,
    "ts": 1638252373342501, "dur": 32,
    "args": {
       "External id": 918,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::softmax", "pid": 2765, "tid": 2765,
    "ts": 1638252373342459, "dur": 76,
    "args": {
       "External id": 917,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373342540,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436583481344, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373342766,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436590559232, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373342756, "dur": 22,
    "args": {
       "External id": 922,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373342711, "dur": 70,
    "args": {
       "External id": 921,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373342880,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225804800, "Bytes": 884736, "Total Allocated": 264240128, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373342873, "dur": 16,
    "args": {
       "External id": 924,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373342829, "dur": 62,
    "args": {
       "External id": 923,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373342661, "dur": 257,
    "args": {
       "External id": 920,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373342921,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225804800, "Bytes": -884736, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373342616, "dur": 310,
    "args": {
       "External id": 919,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373342931,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436587020288, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373343060, "dur": 2,
    "args": {
       "External id": 927,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373343019, "dur": 46,
    "args": {
       "External id": 926,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 2765, "tid": 2765,
    "ts": 1638252373343149, "dur": 3,
    "args": {
       "External id": 929,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2765, "tid": 2765,
    "ts": 1638252373343106, "dur": 48,
    "args": {
       "External id": 928,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373343236, "dur": 1,
    "args": {
       "External id": 931,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373343196, "dur": 44,
    "args": {
       "External id": 930,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373343403,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436594098176, "Bytes": 18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373343398, "dur": 11,
    "args": {
       "External id": 935,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373343359, "dur": 55,
    "args": {
       "External id": 934,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373343456, "dur": 27,
    "args": {
       "External id": 936,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2765, "tid": 2765,
    "ts": 1638252373343318, "dur": 168,
    "args": {
       "External id": 933,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373343572, "dur": 2,
    "args": {
       "External id": 938,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373343532, "dur": 44,
    "args": {
       "External id": 937,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2765, "tid": 2765,
    "ts": 1638252373343279, "dur": 300,
    "args": {
       "External id": 932,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373343673,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373343669, "dur": 11,
    "args": {
       "External id": 940,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 2765, "tid": 2765,
    "ts": 1638252373343626, "dur": 80,
    "args": {
       "External id": 939,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], [24576, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373343789, "dur": 2,
    "args": {
       "External id": 942,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373343751, "dur": 44,
    "args": {
       "External id": 941,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373343798,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436594098176, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373342977, "dur": 826,
    "args": {
       "External id": 925,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373343891, "dur": 1,
    "args": {
       "External id": 944,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373343849, "dur": 49,
    "args": {
       "External id": 943,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373344067,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436594098176, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373344063, "dur": 10,
    "args": {
       "External id": 948,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373344023, "dur": 53,
    "args": {
       "External id": 947,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373344117, "dur": 25,
    "args": {
       "External id": 949,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2765, "tid": 2765,
    "ts": 1638252373343983, "dur": 162,
    "args": {
       "External id": 946,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::contiguous", "pid": 2765, "tid": 2765,
    "ts": 1638252373343944, "dur": 202,
    "args": {
       "External id": 945,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373344194, "dur": 3,
    "args": {
       "External id": 950,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373344204,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373344407, "dur": 2,
    "args": {
       "External id": 954,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373344358, "dur": 55,
    "args": {
       "External id": 953,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373344315, "dur": 101,
    "args": {
       "External id": 952,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373344503, "dur": 3,
    "args": {
       "External id": 956,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373344561,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373344555, "dur": 79,
    "args": {
       "External id": 957,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373344733, "dur": 2,
    "args": {
       "External id": 959,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373344688, "dur": 51,
    "args": {
       "External id": 958,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373344459, "dur": 283,
    "args": {
       "External id": 955,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373344786, "dur": 28,
    "args": {
       "External id": 960,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373344270, "dur": 546,
    "args": {
       "External id": 951,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373345031,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": 18874368, "Total Allocated": 316439552, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373345021, "dur": 18,
    "args": {
       "External id": 964,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373344976, "dur": 65,
    "args": {
       "External id": 963,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373345139,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436576403456, "Bytes": 4718592, "Total Allocated": 321158144, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373345131, "dur": 14,
    "args": {
       "External id": 966,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373345087, "dur": 62,
    "args": {
       "External id": 965,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373344927, "dur": 248,
    "args": {
       "External id": 962,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373345178,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436576403456, "Bytes": -4718592, "Total Allocated": 316439552, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373344882, "dur": 300,
    "args": {
       "External id": 961,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373345189,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": -18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373345196,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436594098176, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373345201,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": -18874368, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373345206,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": -18874368, "Total Allocated": 240942080, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373345210,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440676335616, "Bytes": -18874368, "Total Allocated": 222067712, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373345215,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436590559232, "Bytes": -3538944, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373345270,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 2765, "tid": 2765,
    "ts": 1638252373345262, "dur": 32,
    "args": {
       "External id": 967,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373345300,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": -18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373345461,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373345456, "dur": 11,
    "args": {
       "External id": 970,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373345515,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225498112, "Bytes": 12288, "Total Allocated": 237415424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373345511, "dur": 9,
    "args": {
       "External id": 971,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373345571,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225510400, "Bytes": 12288, "Total Allocated": 237427712, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373345568, "dur": 11,
    "args": {
       "External id": 972,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373345661, "dur": 2,
    "args": {
       "External id": 973,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373345707, "dur": 1,
    "args": {
       "External id": 974,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373345409, "dur": 304,
    "args": {
       "External id": 969,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373345716,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225498112, "Bytes": -12288, "Total Allocated": 237415424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373345721,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225510400, "Bytes": -12288, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373345367, "dur": 357,
    "args": {
       "External id": 968,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373345925, "dur": 2,
    "args": {
       "External id": 978,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373345880, "dur": 49,
    "args": {
       "External id": 977,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373345835, "dur": 98,
    "args": {
       "External id": 976,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373346024, "dur": 3,
    "args": {
       "External id": 980,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373346082,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436941307904, "Bytes": 75497472, "Total Allocated": 312900608, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373346076, "dur": 46,
    "args": {
       "External id": 981,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373346231, "dur": 1,
    "args": {
       "External id": 983,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373346184, "dur": 53,
    "args": {
       "External id": 982,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373345979, "dur": 261,
    "args": {
       "External id": 979,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373346286, "dur": 26,
    "args": {
       "External id": 984,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373345790, "dur": 525,
    "args": {
       "External id": 975,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [6144, 1536], [6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373346386,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140437645950976, "Bytes": 75497472, "Total Allocated": 388398080, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::gelu", "pid": 2765, "tid": 2765,
    "ts": 1638252373346378, "dur": 35,
    "args": {
       "External id": 985,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1556): gelu;/miniconda/lib/python3.8/site-packages/torch/nn/modules/activation.py(652): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373346445,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436941307904, "Bytes": -75497472, "Total Allocated": 312900608, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373346758, "dur": 1,
    "args": {
       "External id": 989,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373346695, "dur": 67,
    "args": {
       "External id": 988,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373346645, "dur": 121,
    "args": {
       "External id": 987,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373346882, "dur": 4,
    "args": {
       "External id": 991,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373346961,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": 18874368, "Total Allocated": 331774976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373346953, "dur": 69,
    "args": {
       "External id": 992,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373347175, "dur": 2,
    "args": {
       "External id": 994,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373347129, "dur": 53,
    "args": {
       "External id": 993,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373346815, "dur": 370,
    "args": {
       "External id": 990,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373347233, "dur": 29,
    "args": {
       "External id": 995,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373346527, "dur": 737,
    "args": {
       "External id": 986,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [1536, 6144], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373347273,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140437645950976, "Bytes": -75497472, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373347494,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440676335616, "Bytes": 18874368, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373347485, "dur": 16,
    "args": {
       "External id": 999,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373347439, "dur": 65,
    "args": {
       "External id": 998,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373347613,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": 4718592, "Total Allocated": 279870464, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373347597, "dur": 22,
    "args": {
       "External id": 1001,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373347550, "dur": 71,
    "args": {
       "External id": 1000,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373347389, "dur": 259,
    "args": {
       "External id": 997,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373347652,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": -4718592, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373347344, "dur": 312,
    "args": {
       "External id": 996,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373347663,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": -18874368, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373347669,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": -18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373347674,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440638586880, "Bytes": -18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373347678,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": -18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373347686,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440619712512, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373347827,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373347823, "dur": 10,
    "args": {
       "External id": 1004,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373347873,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225498112, "Bytes": 12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373347869, "dur": 9,
    "args": {
       "External id": 1005,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373347924,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225510400, "Bytes": 12288, "Total Allocated": 199678976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373347921, "dur": 9,
    "args": {
       "External id": 1006,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373348000, "dur": 2,
    "args": {
       "External id": 1007,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373348039, "dur": 1,
    "args": {
       "External id": 1008,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373347782, "dur": 263,
    "args": {
       "External id": 1003,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373348048,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225498112, "Bytes": -12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373348057,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225510400, "Bytes": -12288, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373347745, "dur": 315,
    "args": {
       "External id": 1002,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373348065,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440676335616, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373348226, "dur": 2,
    "args": {
       "External id": 1012,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373348190, "dur": 40,
    "args": {
       "External id": 1011,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373348156, "dur": 78,
    "args": {
       "External id": 1010,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373348306, "dur": 3,
    "args": {
       "External id": 1014,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373348353,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225559040, "Bytes": 122880, "Total Allocated": 180902912, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373348347, "dur": 43,
    "args": {
       "External id": 1015,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 10]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373348468, "dur": 2,
    "args": {
       "External id": 1017,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373348433, "dur": 39,
    "args": {
       "External id": 1016,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373348270, "dur": 205,
    "args": {
       "External id": 1013,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 10]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373348116, "dur": 361,
    "args": {
       "External id": 1009,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [10, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373348483,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": -18874368, "Total Allocated": 162028544, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373348524, "dur": 2,
    "args": {
       "External id": 1018,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 10], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373348561, "dur": 2,
    "args": {
       "External id": 1019,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373348679, "dur": 0,
    "args": {
       "External id": 1022,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373348719,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225804800, "Bytes": 122880, "Total Allocated": 162151424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_log_softmax", "pid": 2765, "tid": 2765,
    "ts": 1638252373348713, "dur": 35,
    "args": {
       "External id": 1023,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::log_softmax", "pid": 2765, "tid": 2765,
    "ts": 1638252373348647, "dur": 103,
    "args": {
       "External id": 1021,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373348859,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497088, "Bytes": 512, "Total Allocated": 162151936, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373348868,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225498112, "Bytes": 512, "Total Allocated": 162152448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2765, "tid": 2765,
    "ts": 1638252373348906, "dur": 1,
    "args": {
       "External id": 1027,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2765, "tid": 2765,
    "ts": 1638252373348939, "dur": 0,
    "args": {
       "External id": 1028,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss_forward", "pid": 2765, "tid": 2765,
    "ts": 1638252373348853, "dur": 108,
    "args": {
       "External id": 1026,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373348964,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225498112, "Bytes": -512, "Total Allocated": 162151936, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss", "pid": 2765, "tid": 2765,
    "ts": 1638252373348822, "dur": 146,
    "args": {
       "External id": 1025,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss_nd", "pid": 2765, "tid": 2765,
    "ts": 1638252373348787, "dur": 183,
    "args": {
       "External id": 1024,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373348975,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225804800, "Bytes": -122880, "Total Allocated": 162029056, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::cross_entropy_loss", "pid": 2765, "tid": 2765,
    "ts": 1638252373348613, "dur": 365,
    "args": {
       "External id": 1020,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373348984,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440175116288, "Bytes": -18874368, "Total Allocated": 143154688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "CheckpointFunction", "pid": 2765, "tid": 2765,
    "ts": 1638252373335897, "dur": 13188,
    "args": {
       "External id": 801,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Fwd thread id": 0, "Sequence number": 229
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2765, "tid": 2765,
    "ts": 1638252373349137, "dur": 1,
    "args": {
       "External id": 1029,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [7093632]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1822): _use_fp32_param_shard;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1153): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373349200,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225681920, "Bytes": -122880, "Total Allocated": 143031808, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373349234,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904981149632, "Bytes": -5056, "Total Allocated": 6688, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373349239,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904979582528, "Bytes": -816, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373349248,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497600, "Bytes": -512, "Total Allocated": 143031296, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "ProfilerStep#8", "pid": 2765, "tid": 2765,
    "ts": 1638252373331395, "dur": 26553,
    "args": {
       "External id": 690,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(330): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;"
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373358023,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904981152704, "Bytes": 4, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373358021, "dur": 8,
    "args": {
       "External id": 1031,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zero_", "pid": 2765, "tid": 2765,
    "ts": 1638252373358053, "dur": 0,
    "args": {
       "External id": 1032,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zeros", "pid": 2765, "tid": 2765,
    "ts": 1638252373357997, "dur": 58,
    "args": {
       "External id": 1030,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373358113,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904983535296, "Bytes": 16, "Total Allocated": 5892, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373358112, "dur": 5,
    "args": {
       "External id": 1034,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(330): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373358122,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904983535296, "Bytes": -16, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373358128,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904981152704, "Bytes": -4, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373358187,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904983540864, "Bytes": 4, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373358186, "dur": 4,
    "args": {
       "External id": 1036,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zero_", "pid": 2765, "tid": 2765,
    "ts": 1638252373358214, "dur": 0,
    "args": {
       "External id": 1037,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zeros", "pid": 2765, "tid": 2765,
    "ts": 1638252373358161, "dur": 55,
    "args": {
       "External id": 1035,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373358268,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904983546880, "Bytes": 16, "Total Allocated": 5892, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373358267, "dur": 5,
    "args": {
       "External id": 1039,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373358274,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904983546880, "Bytes": -16, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373358279,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904983540864, "Bytes": -4, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "enumerate(DataLoader)#_MultiProcessingDataLoaderIter.__next__", "pid": 2765, "tid": 2765,
    "ts": 1638252373358245, "dur": 257,
    "args": {
       "External id": 1038,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;"
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373358616,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225447936, "Bytes": -24576, "Total Allocated": 143006720, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373358624,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225472512, "Bytes": -24576, "Total Allocated": 142982144, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373358745,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225447936, "Bytes": 24576, "Total Allocated": 143006720, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373358733, "dur": 19,
    "args": {
       "External id": 1042,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373358772, "dur": 42,
    "args": {
       "External id": 1043,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2765, "tid": 2765,
    "ts": 1638252373358712, "dur": 105,
    "args": {
       "External id": 1041,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""], "Fwd thread id": 0, "Sequence number": 230
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373358687, "dur": 132,
    "args": {
       "External id": 1040,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 230
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373358889,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225472512, "Bytes": 24576, "Total Allocated": 143031296, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373358881, "dur": 14,
    "args": {
       "External id": 1046,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373358915, "dur": 30,
    "args": {
       "External id": 1047,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2765, "tid": 2765,
    "ts": 1638252373358862, "dur": 85,
    "args": {
       "External id": 1045,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""], "Fwd thread id": 0, "Sequence number": 230
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373358843, "dur": 106,
    "args": {
       "External id": 1044,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 230
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373359093, "dur": 1,
    "args": {
       "External id": 1048,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(479): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 230
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373359124, "dur": 0,
    "args": {
       "External id": 1049,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(481): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 230
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2765, "tid": 2765,
    "ts": 1638252373359311, "dur": 0,
    "args": {
       "External id": 1050,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[7093632], [28374528]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1570): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373359377, "dur": 1,
    "args": {
       "External id": 1052,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373359349, "dur": 39,
    "args": {
       "External id": 1051,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373359420, "dur": 4,
    "args": {
       "External id": 1053,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2765, "tid": 2765,
    "ts": 1638252373359453, "dur": 1,
    "args": {
       "External id": 1054,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [28374528]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373359637, "dur": 2,
    "args": {
       "External id": 1058,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373359595, "dur": 46,
    "args": {
       "External id": 1057,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373359565, "dur": 78,
    "args": {
       "External id": 1056,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373359733, "dur": 1,
    "args": {
       "External id": 1061,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373359704, "dur": 32,
    "args": {
       "External id": 1060,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373359675, "dur": 62,
    "args": {
       "External id": 1059,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373359825, "dur": 1,
    "args": {
       "External id": 1064,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373359796, "dur": 32,
    "args": {
       "External id": 1063,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373359767, "dur": 63,
    "args": {
       "External id": 1062,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373359918, "dur": 1,
    "args": {
       "External id": 1067,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373359890, "dur": 31,
    "args": {
       "External id": 1066,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373359860, "dur": 65,
    "args": {
       "External id": 1065,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373360015, "dur": 1,
    "args": {
       "External id": 1070,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373359986, "dur": 32,
    "args": {
       "External id": 1069,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373359955, "dur": 64,
    "args": {
       "External id": 1068,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373360112, "dur": 3,
    "args": {
       "External id": 1073,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373360083, "dur": 34,
    "args": {
       "External id": 1072,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373360051, "dur": 68,
    "args": {
       "External id": 1071,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373360208, "dur": 1,
    "args": {
       "External id": 1076,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373360178, "dur": 33,
    "args": {
       "External id": 1075,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373360148, "dur": 64,
    "args": {
       "External id": 1074,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373360306, "dur": 1,
    "args": {
       "External id": 1079,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373360271, "dur": 38,
    "args": {
       "External id": 1078,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373360241, "dur": 70,
    "args": {
       "External id": 1077,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373360400, "dur": 1,
    "args": {
       "External id": 1082,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373360370, "dur": 35,
    "args": {
       "External id": 1081,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373360342, "dur": 64,
    "args": {
       "External id": 1080,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373360500, "dur": 0,
    "args": {
       "External id": 1085,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373360466, "dur": 36,
    "args": {
       "External id": 1084,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373360437, "dur": 67,
    "args": {
       "External id": 1083,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373360593, "dur": 1,
    "args": {
       "External id": 1088,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373360565, "dur": 31,
    "args": {
       "External id": 1087,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373360535, "dur": 63,
    "args": {
       "External id": 1086,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373360694, "dur": 2,
    "args": {
       "External id": 1091,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373360665, "dur": 33,
    "args": {
       "External id": 1090,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373360634, "dur": 66,
    "args": {
       "External id": 1089,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373360789, "dur": 1,
    "args": {
       "External id": 1094,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373360758, "dur": 34,
    "args": {
       "External id": 1093,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373360729, "dur": 64,
    "args": {
       "External id": 1092,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373360885, "dur": 0,
    "args": {
       "External id": 1097,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373360854, "dur": 33,
    "args": {
       "External id": 1096,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373360824, "dur": 65,
    "args": {
       "External id": 1095,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373360978, "dur": 1,
    "args": {
       "External id": 1100,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373360948, "dur": 33,
    "args": {
       "External id": 1099,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373360920, "dur": 62,
    "args": {
       "External id": 1098,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373361071, "dur": 1,
    "args": {
       "External id": 1103,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373361042, "dur": 32,
    "args": {
       "External id": 1102,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373361013, "dur": 63,
    "args": {
       "External id": 1101,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373361165, "dur": 1,
    "args": {
       "External id": 1106,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373361137, "dur": 31,
    "args": {
       "External id": 1105,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373361107, "dur": 62,
    "args": {
       "External id": 1104,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373361263, "dur": 1,
    "args": {
       "External id": 1109,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373361233, "dur": 33,
    "args": {
       "External id": 1108,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373361200, "dur": 67,
    "args": {
       "External id": 1107,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373361358, "dur": 1,
    "args": {
       "External id": 1112,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373361329, "dur": 32,
    "args": {
       "External id": 1111,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373361299, "dur": 63,
    "args": {
       "External id": 1110,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373361452, "dur": 0,
    "args": {
       "External id": 1115,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373361422, "dur": 32,
    "args": {
       "External id": 1114,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373361392, "dur": 64,
    "args": {
       "External id": 1113,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373361550, "dur": 0,
    "args": {
       "External id": 1118,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373361515, "dur": 37,
    "args": {
       "External id": 1117,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373361487, "dur": 67,
    "args": {
       "External id": 1116,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::split_with_sizes", "pid": 2765, "tid": 2765,
    "ts": 1638252373359531, "dur": 2040,
    "args": {
       "External id": 1055,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Int"], "Fwd thread id": 0, "Sequence number": 230
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373361620, "dur": 6,
    "args": {
       "External id": 1119,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9216], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 231
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373361666, "dur": 4,
    "args": {
       "External id": 1120,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[15360], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 232
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373361704, "dur": 5,
    "args": {
       "External id": 1121,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 233
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373361742, "dur": 4,
    "args": {
       "External id": 1122,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 234
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373361783, "dur": 3,
    "args": {
       "External id": 1123,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 235
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373361821, "dur": 3,
    "args": {
       "External id": 1124,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 236
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373361856, "dur": 5,
    "args": {
       "External id": 1125,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 237
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373361894, "dur": 4,
    "args": {
       "External id": 1126,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 238
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373361932, "dur": 3,
    "args": {
       "External id": 1127,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 239
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373361972, "dur": 4,
    "args": {
       "External id": 1128,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 240
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373362011, "dur": 4,
    "args": {
       "External id": 1129,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 241
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373362049, "dur": 3,
    "args": {
       "External id": 1130,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 242
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373362084, "dur": 6,
    "args": {
       "External id": 1131,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 243
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373362121, "dur": 4,
    "args": {
       "External id": 1132,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 244
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373362158, "dur": 4,
    "args": {
       "External id": 1133,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 245
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373362196, "dur": 3,
    "args": {
       "External id": 1134,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 246
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373362233, "dur": 3,
    "args": {
       "External id": 1135,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 247
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373362270, "dur": 3,
    "args": {
       "External id": 1136,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 248
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373362307, "dur": 5,
    "args": {
       "External id": 1137,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 249
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373362344, "dur": 3,
    "args": {
       "External id": 1138,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 250
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373362382, "dur": 3,
    "args": {
       "External id": 1139,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[15360], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 251
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373362476, "dur": 3,
    "args": {
       "External id": 1140,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373362509, "dur": 1,
    "args": {
       "External id": 1141,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 252
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "detach_", "pid": 2765, "tid": 2765,
    "ts": 1638252373362563, "dur": 1,
    "args": {
       "External id": 1143,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::detach_", "pid": 2765, "tid": 2765,
    "ts": 1638252373362538, "dur": 28,
    "args": {
       "External id": 1142,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"], "Fwd thread id": 0, "Sequence number": 252
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373362628,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904983768448, "Bytes": 5056, "Total Allocated": 10928, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373362658,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904982233024, "Bytes": 816, "Total Allocated": 11744, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373362776, "dur": 21,
    "args": {
       "External id": 1147,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373362830, "dur": 27,
    "args": {
       "External id": 1148,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2765, "tid": 2765,
    "ts": 1638252373362744, "dur": 116,
    "args": {
       "External id": 1146,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373362713, "dur": 148,
    "args": {
       "External id": 1145,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373362959, "dur": 5,
    "args": {
       "External id": 1151,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373363001, "dur": 18,
    "args": {
       "External id": 1152,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2765, "tid": 2765,
    "ts": 1638252373362929, "dur": 92,
    "args": {
       "External id": 1150,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373362899, "dur": 124,
    "args": {
       "External id": 1149,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 2765, "tid": 2765,
    "ts": 1638252373363172, "dur": 2,
    "args": {
       "External id": 1155,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2765, "tid": 2765,
    "ts": 1638252373363137, "dur": 40,
    "args": {
       "External id": 1154,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373363252, "dur": 6,
    "args": {
       "External id": 1157,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373363307,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440175116288, "Bytes": 18874368, "Total Allocated": 161905664, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2765, "tid": 2765,
    "ts": 1638252373363300, "dur": 13,
    "args": {
       "External id": 1158,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::index_select", "pid": 2765, "tid": 2765,
    "ts": 1638252373363213, "dur": 133,
    "args": {
       "External id": 1156,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], [3072]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "long int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373363392, "dur": 2,
    "args": {
       "External id": 1159,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::embedding", "pid": 2765, "tid": 2765,
    "ts": 1638252373363099, "dur": 299,
    "args": {
       "External id": 1153,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [512, 6], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "Int", "Bool", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373363473, "dur": 1,
    "args": {
       "External id": 1161,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373363440, "dur": 38,
    "args": {
       "External id": 1160,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373363540, "dur": 1,
    "args": {
       "External id": 1163,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373363511, "dur": 33,
    "args": {
       "External id": 1162,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373363611,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": 18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 2765, "tid": 2765,
    "ts": 1638252373363593, "dur": 49,
    "args": {
       "External id": 1164,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373363822,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440619712512, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373363813, "dur": 16,
    "args": {
       "External id": 1168,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373363777, "dur": 57,
    "args": {
       "External id": 1167,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373363912,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440638586880, "Bytes": 4718592, "Total Allocated": 204372992, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373363904, "dur": 14,
    "args": {
       "External id": 1170,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373363870, "dur": 50,
    "args": {
       "External id": 1169,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373363738, "dur": 209,
    "args": {
       "External id": 1166,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373363950,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440638586880, "Bytes": -4718592, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373363701, "dur": 253,
    "args": {
       "External id": 1165,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373363959,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373364130,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440638586880, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373364126, "dur": 10,
    "args": {
       "External id": 1173,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373364186,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497600, "Bytes": 12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373364183, "dur": 9,
    "args": {
       "External id": 1174,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373364244,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225509888, "Bytes": 12288, "Total Allocated": 199678976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373364241, "dur": 9,
    "args": {
       "External id": 1175,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373364328, "dur": 2,
    "args": {
       "External id": 1176,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373364374, "dur": 1,
    "args": {
       "External id": 1177,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373364080, "dur": 300,
    "args": {
       "External id": 1172,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373364383,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497600, "Bytes": -12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373364388,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225509888, "Bytes": -12288, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373364037, "dur": 354,
    "args": {
       "External id": 1171,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373364594, "dur": 2,
    "args": {
       "External id": 1181,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373364549, "dur": 49,
    "args": {
       "External id": 1180,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373364503, "dur": 107,
    "args": {
       "External id": 1179,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373364702, "dur": 3,
    "args": {
       "External id": 1183,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373364766,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": 18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373364759, "dur": 70,
    "args": {
       "External id": 1184,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373364927, "dur": 2,
    "args": {
       "External id": 1186,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373364882, "dur": 49,
    "args": {
       "External id": 1185,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373364656, "dur": 279,
    "args": {
       "External id": 1182,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373364979, "dur": 30,
    "args": {
       "External id": 1187,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373364459, "dur": 552,
    "args": {
       "External id": 1178,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373365062, "dur": 4,
    "args": {
       "External id": 1188,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373365161, "dur": 2,
    "args": {
       "External id": 1190,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373365113, "dur": 53,
    "args": {
       "External id": 1189,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373365359, "dur": 1,
    "args": {
       "External id": 1194,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373365315, "dur": 48,
    "args": {
       "External id": 1193,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373365270, "dur": 96,
    "args": {
       "External id": 1192,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373365456, "dur": 2,
    "args": {
       "External id": 1196,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373365515,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373365508, "dur": 64,
    "args": {
       "External id": 1197,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373365678, "dur": 2,
    "args": {
       "External id": 1199,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373365633, "dur": 50,
    "args": {
       "External id": 1198,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373365411, "dur": 275,
    "args": {
       "External id": 1195,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373365732, "dur": 27,
    "args": {
       "External id": 1200,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373365226, "dur": 536,
    "args": {
       "External id": 1191,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373365810, "dur": 4,
    "args": {
       "External id": 1201,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373365900, "dur": 1,
    "args": {
       "External id": 1203,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373365859, "dur": 45,
    "args": {
       "External id": 1202,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373366097, "dur": 1,
    "args": {
       "External id": 1207,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373366052, "dur": 48,
    "args": {
       "External id": 1206,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373366008, "dur": 95,
    "args": {
       "External id": 1205,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373366192, "dur": 2,
    "args": {
       "External id": 1209,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373366255,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440676335616, "Bytes": 18874368, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373366248, "dur": 62,
    "args": {
       "External id": 1210,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373366407, "dur": 2,
    "args": {
       "External id": 1212,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373366362, "dur": 49,
    "args": {
       "External id": 1211,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373366148, "dur": 266,
    "args": {
       "External id": 1208,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373366460, "dur": 25,
    "args": {
       "External id": 1213,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373365964, "dur": 524,
    "args": {
       "External id": 1204,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373366538, "dur": 4,
    "args": {
       "External id": 1214,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373366634, "dur": 2,
    "args": {
       "External id": 1216,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373366585, "dur": 54,
    "args": {
       "External id": 1215,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373366725, "dur": 2,
    "args": {
       "External id": 1218,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373366684, "dur": 45,
    "args": {
       "External id": 1217,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373366860, "dur": 1,
    "args": {
       "External id": 1221,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373366814, "dur": 50,
    "args": {
       "External id": 1220,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373367029,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": 18874368, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373367023, "dur": 17,
    "args": {
       "External id": 1225,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373366983, "dur": 60,
    "args": {
       "External id": 1224,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373367083, "dur": 29,
    "args": {
       "External id": 1226,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2765, "tid": 2765,
    "ts": 1638252373366944, "dur": 171,
    "args": {
       "External id": 1223,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373367196, "dur": 2,
    "args": {
       "External id": 1228,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373367157, "dur": 43,
    "args": {
       "External id": 1227,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2765, "tid": 2765,
    "ts": 1638252373366905, "dur": 298,
    "args": {
       "External id": 1222,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373367284, "dur": 1,
    "args": {
       "External id": 1230,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373367243, "dur": 45,
    "args": {
       "External id": 1229,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373367519,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": 18874368, "Total Allocated": 294026240, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373367514, "dur": 15,
    "args": {
       "External id": 1234,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373367477, "dur": 55,
    "args": {
       "External id": 1233,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373367588, "dur": 33,
    "args": {
       "External id": 1235,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2765, "tid": 2765,
    "ts": 1638252373367436, "dur": 187,
    "args": {
       "External id": 1232,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373367743, "dur": 2,
    "args": {
       "External id": 1237,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373367672, "dur": 76,
    "args": {
       "External id": 1236,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2765, "tid": 2765,
    "ts": 1638252373367395, "dur": 355,
    "args": {
       "External id": 1231,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373367903,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436576403456, "Bytes": 3538944, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373367899, "dur": 12,
    "args": {
       "External id": 1239,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 2765, "tid": 2765,
    "ts": 1638252373367795, "dur": 142,
    "args": {
       "External id": 1238,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], [24576, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373368055, "dur": 2,
    "args": {
       "External id": 1241,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373368006, "dur": 53,
    "args": {
       "External id": 1240,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373368062,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373368067,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": -18874368, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373366773, "dur": 1298,
    "args": {
       "External id": 1219,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373368086,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904984115008, "Bytes": 8, "Total Allocated": 11752, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373368161,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436579942400, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mul", "pid": 2765, "tid": 2765,
    "ts": 1638252373368151, "dur": 39,
    "args": {
       "External id": 1242,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373368199,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904984115008, "Bytes": -8, "Total Allocated": 11744, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373368205,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436576403456, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373368306, "dur": 2,
    "args": {
       "External id": 1244,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373368265, "dur": 47,
    "args": {
       "External id": 1243,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373368394, "dur": 2,
    "args": {
       "External id": 1246,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373368355, "dur": 44,
    "args": {
       "External id": 1245,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373368475,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904984137344, "Bytes": 8, "Total Allocated": 11752, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373368489,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497600, "Bytes": 512, "Total Allocated": 259816960, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373368500,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904984137344, "Bytes": -8, "Total Allocated": 11744, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::eq", "pid": 2765, "tid": 2765,
    "ts": 1638252373368472, "dur": 55,
    "args": {
       "External id": 1247,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373368672, "dur": 2,
    "args": {
       "External id": 1250,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373368631, "dur": 48,
    "args": {
       "External id": 1249,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373368763, "dur": 1,
    "args": {
       "External id": 1252,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373368719, "dur": 48,
    "args": {
       "External id": 1251,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373368896,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436583481344, "Bytes": 3538944, "Total Allocated": 263355904, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373368890, "dur": 13,
    "args": {
       "External id": 1255,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373368851, "dur": 55,
    "args": {
       "External id": 1254,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373368948, "dur": 33,
    "args": {
       "External id": 1256,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2765, "tid": 2765,
    "ts": 1638252373368810, "dur": 174,
    "args": {
       "External id": 1253,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373369111, "dur": 2,
    "args": {
       "External id": 1259,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373369070, "dur": 45,
    "args": {
       "External id": 1258,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill_", "pid": 2765, "tid": 2765,
    "ts": 1638252373369027, "dur": 116,
    "args": {
       "External id": 1257,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill", "pid": 2765, "tid": 2765,
    "ts": 1638252373368582, "dur": 563,
    "args": {
       "External id": 1248,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373369151,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497600, "Bytes": -512, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373369157,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436579942400, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373369255,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436587020288, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_softmax", "pid": 2765, "tid": 2765,
    "ts": 1638252373369250, "dur": 32,
    "args": {
       "External id": 1261,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::softmax", "pid": 2765, "tid": 2765,
    "ts": 1638252373369209, "dur": 75,
    "args": {
       "External id": 1260,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373369289,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436583481344, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373369515,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436590559232, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373369506, "dur": 15,
    "args": {
       "External id": 1265,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373369460, "dur": 64,
    "args": {
       "External id": 1264,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373369631,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225681920, "Bytes": 884736, "Total Allocated": 264240128, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373369623, "dur": 14,
    "args": {
       "External id": 1267,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373369571, "dur": 68,
    "args": {
       "External id": 1266,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373369411, "dur": 256,
    "args": {
       "External id": 1263,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373369670,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225681920, "Bytes": -884736, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373369365, "dur": 309,
    "args": {
       "External id": 1262,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373369680,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436587020288, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373369810, "dur": 2,
    "args": {
       "External id": 1270,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373369768, "dur": 47,
    "args": {
       "External id": 1269,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 2765, "tid": 2765,
    "ts": 1638252373369897, "dur": 3,
    "args": {
       "External id": 1272,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2765, "tid": 2765,
    "ts": 1638252373369856, "dur": 47,
    "args": {
       "External id": 1271,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373369988, "dur": 1,
    "args": {
       "External id": 1274,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373369948, "dur": 44,
    "args": {
       "External id": 1273,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373370156,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436594098176, "Bytes": 18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373370151, "dur": 11,
    "args": {
       "External id": 1278,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373370111, "dur": 56,
    "args": {
       "External id": 1277,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373370207, "dur": 28,
    "args": {
       "External id": 1279,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2765, "tid": 2765,
    "ts": 1638252373370072, "dur": 165,
    "args": {
       "External id": 1276,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373370320, "dur": 2,
    "args": {
       "External id": 1281,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373370280, "dur": 44,
    "args": {
       "External id": 1280,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2765, "tid": 2765,
    "ts": 1638252373370033, "dur": 293,
    "args": {
       "External id": 1275,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373370425,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373370421, "dur": 11,
    "args": {
       "External id": 1283,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 2765, "tid": 2765,
    "ts": 1638252373370376, "dur": 81,
    "args": {
       "External id": 1282,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], [24576, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373370540, "dur": 2,
    "args": {
       "External id": 1285,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373370500, "dur": 47,
    "args": {
       "External id": 1284,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373370550,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436594098176, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373369728, "dur": 827,
    "args": {
       "External id": 1268,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373370648, "dur": 1,
    "args": {
       "External id": 1287,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373370600, "dur": 52,
    "args": {
       "External id": 1286,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373370821,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436594098176, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373370817, "dur": 10,
    "args": {
       "External id": 1291,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373370777, "dur": 53,
    "args": {
       "External id": 1290,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373370871, "dur": 26,
    "args": {
       "External id": 1292,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2765, "tid": 2765,
    "ts": 1638252373370737, "dur": 162,
    "args": {
       "External id": 1289,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::contiguous", "pid": 2765, "tid": 2765,
    "ts": 1638252373370698, "dur": 203,
    "args": {
       "External id": 1288,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373370950, "dur": 3,
    "args": {
       "External id": 1293,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373370958,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373371159, "dur": 1,
    "args": {
       "External id": 1297,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373371115, "dur": 50,
    "args": {
       "External id": 1296,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373371069, "dur": 99,
    "args": {
       "External id": 1295,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373371258, "dur": 2,
    "args": {
       "External id": 1299,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373371317,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373371310, "dur": 70,
    "args": {
       "External id": 1300,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373371478, "dur": 2,
    "args": {
       "External id": 1302,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373371434, "dur": 48,
    "args": {
       "External id": 1301,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373371213, "dur": 272,
    "args": {
       "External id": 1298,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373371532, "dur": 27,
    "args": {
       "External id": 1303,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373371025, "dur": 536,
    "args": {
       "External id": 1294,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373371783,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": 18874368, "Total Allocated": 316439552, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373371773, "dur": 18,
    "args": {
       "External id": 1307,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373371726, "dur": 68,
    "args": {
       "External id": 1306,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373371892,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436576403456, "Bytes": 4718592, "Total Allocated": 321158144, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373371885, "dur": 17,
    "args": {
       "External id": 1309,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373371840, "dur": 64,
    "args": {
       "External id": 1308,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373371678, "dur": 252,
    "args": {
       "External id": 1305,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373371934,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436576403456, "Bytes": -4718592, "Total Allocated": 316439552, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373371633, "dur": 305,
    "args": {
       "External id": 1304,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373371943,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": -18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373371949,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436594098176, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373371955,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": -18874368, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373371960,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": -18874368, "Total Allocated": 240942080, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373371965,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440676335616, "Bytes": -18874368, "Total Allocated": 222067712, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373371970,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436590559232, "Bytes": -3538944, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373372027,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 2765, "tid": 2765,
    "ts": 1638252373372019, "dur": 32,
    "args": {
       "External id": 1310,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373372057,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": -18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373372220,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373372216, "dur": 14,
    "args": {
       "External id": 1313,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373372278,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497600, "Bytes": 12288, "Total Allocated": 237415424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373372274, "dur": 11,
    "args": {
       "External id": 1314,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373372332,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225509888, "Bytes": 12288, "Total Allocated": 237427712, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373372329, "dur": 8,
    "args": {
       "External id": 1315,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373372417, "dur": 2,
    "args": {
       "External id": 1316,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373372463, "dur": 1,
    "args": {
       "External id": 1317,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373372170, "dur": 299,
    "args": {
       "External id": 1312,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373372472,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497600, "Bytes": -12288, "Total Allocated": 237415424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373372477,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225509888, "Bytes": -12288, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373372130, "dur": 350,
    "args": {
       "External id": 1311,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373372687, "dur": 1,
    "args": {
       "External id": 1321,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373372639, "dur": 52,
    "args": {
       "External id": 1320,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373372588, "dur": 106,
    "args": {
       "External id": 1319,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373372785, "dur": 3,
    "args": {
       "External id": 1323,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373372843,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436941307904, "Bytes": 75497472, "Total Allocated": 312900608, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373372837, "dur": 47,
    "args": {
       "External id": 1324,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373372982, "dur": 1,
    "args": {
       "External id": 1326,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373372936, "dur": 50,
    "args": {
       "External id": 1325,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373372740, "dur": 249,
    "args": {
       "External id": 1322,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373373035, "dur": 25,
    "args": {
       "External id": 1327,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373372546, "dur": 517,
    "args": {
       "External id": 1318,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [6144, 1536], [6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373373128,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140437645950976, "Bytes": 75497472, "Total Allocated": 388398080, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::gelu", "pid": 2765, "tid": 2765,
    "ts": 1638252373373121, "dur": 33,
    "args": {
       "External id": 1328,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1556): gelu;/miniconda/lib/python3.8/site-packages/torch/nn/modules/activation.py(652): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373373160,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436941307904, "Bytes": -75497472, "Total Allocated": 312900608, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373373351, "dur": 2,
    "args": {
       "External id": 1332,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373373306, "dur": 49,
    "args": {
       "External id": 1331,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373373261, "dur": 97,
    "args": {
       "External id": 1330,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373373450, "dur": 3,
    "args": {
       "External id": 1334,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373373507,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": 18874368, "Total Allocated": 331774976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373373501, "dur": 59,
    "args": {
       "External id": 1335,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373373665, "dur": 1,
    "args": {
       "External id": 1337,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373373620, "dur": 49,
    "args": {
       "External id": 1336,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373373406, "dur": 266,
    "args": {
       "External id": 1333,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373373718, "dur": 25,
    "args": {
       "External id": 1338,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373373216, "dur": 529,
    "args": {
       "External id": 1329,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [1536, 6144], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373373752,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140437645950976, "Bytes": -75497472, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373373976,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440676335616, "Bytes": 18874368, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373373966, "dur": 16,
    "args": {
       "External id": 1342,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373373920, "dur": 65,
    "args": {
       "External id": 1341,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373374083,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": 4718592, "Total Allocated": 279870464, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373374075, "dur": 14,
    "args": {
       "External id": 1344,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373374031, "dur": 62,
    "args": {
       "External id": 1343,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373373871, "dur": 247,
    "args": {
       "External id": 1340,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373374121,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": -4718592, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373373822, "dur": 304,
    "args": {
       "External id": 1339,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373374130,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": -18874368, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373374138,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": -18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373374142,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440638586880, "Bytes": -18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373374146,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": -18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373374152,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440619712512, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373374292,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373374287, "dur": 11,
    "args": {
       "External id": 1347,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373374339,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497600, "Bytes": 12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373374336, "dur": 9,
    "args": {
       "External id": 1348,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373374386,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225509888, "Bytes": 12288, "Total Allocated": 199678976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373374382, "dur": 9,
    "args": {
       "External id": 1349,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373374467, "dur": 2,
    "args": {
       "External id": 1350,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373374504, "dur": 2,
    "args": {
       "External id": 1351,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373374247, "dur": 264,
    "args": {
       "External id": 1346,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373374513,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497600, "Bytes": -12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373374518,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225509888, "Bytes": -12288, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373374210, "dur": 312,
    "args": {
       "External id": 1345,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373374530,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440676335616, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373374693, "dur": 2,
    "args": {
       "External id": 1355,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373374659, "dur": 38,
    "args": {
       "External id": 1354,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373374622, "dur": 78,
    "args": {
       "External id": 1353,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373374773, "dur": 3,
    "args": {
       "External id": 1357,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373374822,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225681920, "Bytes": 122880, "Total Allocated": 180902912, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373374815, "dur": 44,
    "args": {
       "External id": 1358,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 10]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373374934, "dur": 2,
    "args": {
       "External id": 1360,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373374901, "dur": 39,
    "args": {
       "External id": 1359,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373374737, "dur": 206,
    "args": {
       "External id": 1356,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 10]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373374579, "dur": 366,
    "args": {
       "External id": 1352,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [10, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373374951,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": -18874368, "Total Allocated": 162028544, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373374992, "dur": 2,
    "args": {
       "External id": 1361,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 10], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373375027, "dur": 2,
    "args": {
       "External id": 1362,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373375139, "dur": 1,
    "args": {
       "External id": 1365,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373375177,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225804800, "Bytes": 122880, "Total Allocated": 162151424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_log_softmax", "pid": 2765, "tid": 2765,
    "ts": 1638252373375172, "dur": 33,
    "args": {
       "External id": 1366,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::log_softmax", "pid": 2765, "tid": 2765,
    "ts": 1638252373375105, "dur": 102,
    "args": {
       "External id": 1364,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373375317,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497600, "Bytes": 512, "Total Allocated": 162151936, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373375323,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225498112, "Bytes": 512, "Total Allocated": 162152448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2765, "tid": 2765,
    "ts": 1638252373375362, "dur": 1,
    "args": {
       "External id": 1370,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2765, "tid": 2765,
    "ts": 1638252373375396, "dur": 0,
    "args": {
       "External id": 1371,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss_forward", "pid": 2765, "tid": 2765,
    "ts": 1638252373375311, "dur": 109,
    "args": {
       "External id": 1369,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373375423,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225498112, "Bytes": -512, "Total Allocated": 162151936, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss", "pid": 2765, "tid": 2765,
    "ts": 1638252373375277, "dur": 150,
    "args": {
       "External id": 1368,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss_nd", "pid": 2765, "tid": 2765,
    "ts": 1638252373375243, "dur": 185,
    "args": {
       "External id": 1367,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373375431,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225804800, "Bytes": -122880, "Total Allocated": 162029056, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::cross_entropy_loss", "pid": 2765, "tid": 2765,
    "ts": 1638252373375072, "dur": 362,
    "args": {
       "External id": 1363,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373375440,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440175116288, "Bytes": -18874368, "Total Allocated": 143154688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "CheckpointFunction", "pid": 2765, "tid": 2765,
    "ts": 1638252373362594, "dur": 12946,
    "args": {
       "External id": 1144,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Fwd thread id": 0, "Sequence number": 252
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2765, "tid": 2765,
    "ts": 1638252373375591, "dur": 1,
    "args": {
       "External id": 1372,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [7093632]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1822): _use_fp32_param_shard;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1153): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373375662,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225559040, "Bytes": -122880, "Total Allocated": 143031808, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373375696,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904982302016, "Bytes": -5056, "Total Allocated": 6688, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373375701,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904979695744, "Bytes": -816, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373375709,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497088, "Bytes": -512, "Total Allocated": 143031296, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "ProfilerStep#9", "pid": 2765, "tid": 2765,
    "ts": 1638252373358091, "dur": 26586,
    "args": {
       "External id": 1033,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(330): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;"
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373384764,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904982304704, "Bytes": 4, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373384762, "dur": 8,
    "args": {
       "External id": 1374,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zero_", "pid": 2765, "tid": 2765,
    "ts": 1638252373384794, "dur": 0,
    "args": {
       "External id": 1375,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zeros", "pid": 2765, "tid": 2765,
    "ts": 1638252373384739, "dur": 57,
    "args": {
       "External id": 1373,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373384852,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904984609728, "Bytes": 16, "Total Allocated": 5892, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373384851, "dur": 6,
    "args": {
       "External id": 1377,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(330): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373384859,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904984609728, "Bytes": -16, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373384864,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904982304704, "Bytes": -4, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373384924,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904984615232, "Bytes": 4, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373384923, "dur": 4,
    "args": {
       "External id": 1379,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zero_", "pid": 2765, "tid": 2765,
    "ts": 1638252373384953, "dur": 0,
    "args": {
       "External id": 1380,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zeros", "pid": 2765, "tid": 2765,
    "ts": 1638252373384901, "dur": 54,
    "args": {
       "External id": 1378,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373385007,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904984621248, "Bytes": 16, "Total Allocated": 5892, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373385006, "dur": 5,
    "args": {
       "External id": 1382,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373385015,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904984621248, "Bytes": -16, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373385020,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904984615232, "Bytes": -4, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "enumerate(DataLoader)#_MultiProcessingDataLoaderIter.__next__", "pid": 2765, "tid": 2765,
    "ts": 1638252373384982, "dur": 87,
    "args": {
       "External id": 1381,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;"
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373385102,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225447936, "Bytes": -24576, "Total Allocated": 143006720, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373385109,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225472512, "Bytes": -24576, "Total Allocated": 142982144, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373385186,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225447936, "Bytes": 24576, "Total Allocated": 143006720, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373385176, "dur": 17,
    "args": {
       "External id": 1385,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373385215, "dur": 41,
    "args": {
       "External id": 1386,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2765, "tid": 2765,
    "ts": 1638252373385155, "dur": 103,
    "args": {
       "External id": 1384,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""], "Fwd thread id": 0, "Sequence number": 253
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373385135, "dur": 125,
    "args": {
       "External id": 1383,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 253
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373385331,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225472512, "Bytes": 24576, "Total Allocated": 143031296, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373385322, "dur": 15,
    "args": {
       "External id": 1389,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373385356, "dur": 31,
    "args": {
       "External id": 1390,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2765, "tid": 2765,
    "ts": 1638252373385302, "dur": 87,
    "args": {
       "External id": 1388,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""], "Fwd thread id": 0, "Sequence number": 253
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373385283, "dur": 108,
    "args": {
       "External id": 1387,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 253
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373385535, "dur": 0,
    "args": {
       "External id": 1391,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(479): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 253
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373385570, "dur": 0,
    "args": {
       "External id": 1392,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(481): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 253
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2765, "tid": 2765,
    "ts": 1638252373385770, "dur": 1,
    "args": {
       "External id": 1393,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[7093632], [28374528]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1570): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373385838, "dur": 2,
    "args": {
       "External id": 1395,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373385808, "dur": 36,
    "args": {
       "External id": 1394,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373385875, "dur": 5,
    "args": {
       "External id": 1396,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2765, "tid": 2765,
    "ts": 1638252373385911, "dur": 0,
    "args": {
       "External id": 1397,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [28374528]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373386085, "dur": 1,
    "args": {
       "External id": 1401,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373386054, "dur": 35,
    "args": {
       "External id": 1400,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373386022, "dur": 68,
    "args": {
       "External id": 1399,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373386182, "dur": 1,
    "args": {
       "External id": 1404,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373386152, "dur": 33,
    "args": {
       "External id": 1403,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373386123, "dur": 64,
    "args": {
       "External id": 1402,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373386282, "dur": 1,
    "args": {
       "External id": 1407,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373386253, "dur": 34,
    "args": {
       "External id": 1406,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373386222, "dur": 66,
    "args": {
       "External id": 1405,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373386379, "dur": 1,
    "args": {
       "External id": 1410,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373386350, "dur": 32,
    "args": {
       "External id": 1409,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373386320, "dur": 63,
    "args": {
       "External id": 1408,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373386476, "dur": 2,
    "args": {
       "External id": 1413,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373386447, "dur": 33,
    "args": {
       "External id": 1412,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373386417, "dur": 65,
    "args": {
       "External id": 1411,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373386571, "dur": 1,
    "args": {
       "External id": 1416,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373386541, "dur": 33,
    "args": {
       "External id": 1415,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373386511, "dur": 65,
    "args": {
       "External id": 1414,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373386672, "dur": 1,
    "args": {
       "External id": 1419,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373386642, "dur": 33,
    "args": {
       "External id": 1418,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373386612, "dur": 65,
    "args": {
       "External id": 1417,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373386774, "dur": 1,
    "args": {
       "External id": 1422,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373386744, "dur": 33,
    "args": {
       "External id": 1421,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373386715, "dur": 63,
    "args": {
       "External id": 1420,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373386868, "dur": 1,
    "args": {
       "External id": 1425,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373386837, "dur": 34,
    "args": {
       "External id": 1424,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373386809, "dur": 63,
    "args": {
       "External id": 1423,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373386962, "dur": 0,
    "args": {
       "External id": 1428,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373386933, "dur": 31,
    "args": {
       "External id": 1427,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373386903, "dur": 63,
    "args": {
       "External id": 1426,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373387058, "dur": 0,
    "args": {
       "External id": 1431,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373387028, "dur": 32,
    "args": {
       "External id": 1430,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373386997, "dur": 65,
    "args": {
       "External id": 1429,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373387151, "dur": 1,
    "args": {
       "External id": 1434,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373387121, "dur": 33,
    "args": {
       "External id": 1433,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373387091, "dur": 66,
    "args": {
       "External id": 1432,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373387247, "dur": 0,
    "args": {
       "External id": 1437,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373387217, "dur": 32,
    "args": {
       "External id": 1436,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373387187, "dur": 64,
    "args": {
       "External id": 1435,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373387340, "dur": 1,
    "args": {
       "External id": 1440,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373387310, "dur": 32,
    "args": {
       "External id": 1439,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373387281, "dur": 63,
    "args": {
       "External id": 1438,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373387433, "dur": 1,
    "args": {
       "External id": 1443,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373387405, "dur": 31,
    "args": {
       "External id": 1442,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373387375, "dur": 62,
    "args": {
       "External id": 1441,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373387527, "dur": 0,
    "args": {
       "External id": 1446,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373387498, "dur": 31,
    "args": {
       "External id": 1445,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373387468, "dur": 63,
    "args": {
       "External id": 1444,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373387630, "dur": 1,
    "args": {
       "External id": 1449,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373387593, "dur": 40,
    "args": {
       "External id": 1448,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373387563, "dur": 74,
    "args": {
       "External id": 1447,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373387728, "dur": 0,
    "args": {
       "External id": 1452,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373387697, "dur": 33,
    "args": {
       "External id": 1451,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373387666, "dur": 66,
    "args": {
       "External id": 1450,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373387821, "dur": 0,
    "args": {
       "External id": 1455,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373387791, "dur": 32,
    "args": {
       "External id": 1454,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373387761, "dur": 64,
    "args": {
       "External id": 1453,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373387914, "dur": 1,
    "args": {
       "External id": 1458,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373387884, "dur": 33,
    "args": {
       "External id": 1457,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373387856, "dur": 62,
    "args": {
       "External id": 1456,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373388012, "dur": 1,
    "args": {
       "External id": 1461,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373387984, "dur": 31,
    "args": {
       "External id": 1460,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2765, "tid": 2765,
    "ts": 1638252373387954, "dur": 62,
    "args": {
       "External id": 1459,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::split_with_sizes", "pid": 2765, "tid": 2765,
    "ts": 1638252373385989, "dur": 2047,
    "args": {
       "External id": 1398,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Int"], "Fwd thread id": 0, "Sequence number": 253
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373388081, "dur": 8,
    "args": {
       "External id": 1462,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9216], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 254
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373388126, "dur": 4,
    "args": {
       "External id": 1463,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[15360], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 255
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373388166, "dur": 4,
    "args": {
       "External id": 1464,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 256
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373388203, "dur": 5,
    "args": {
       "External id": 1465,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 257
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373388240, "dur": 4,
    "args": {
       "External id": 1466,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 258
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373388278, "dur": 3,
    "args": {
       "External id": 1467,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 259
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373388315, "dur": 4,
    "args": {
       "External id": 1468,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 260
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373388352, "dur": 5,
    "args": {
       "External id": 1469,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 261
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373388389, "dur": 3,
    "args": {
       "External id": 1470,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 262
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373388426, "dur": 4,
    "args": {
       "External id": 1471,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 263
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373388463, "dur": 4,
    "args": {
       "External id": 1472,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 264
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373388500, "dur": 4,
    "args": {
       "External id": 1473,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 265
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373388537, "dur": 4,
    "args": {
       "External id": 1474,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 266
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373388572, "dur": 6,
    "args": {
       "External id": 1475,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 267
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373388616, "dur": 4,
    "args": {
       "External id": 1476,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 268
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373388654, "dur": 4,
    "args": {
       "External id": 1477,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 269
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373388692, "dur": 4,
    "args": {
       "External id": 1478,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 270
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373388730, "dur": 3,
    "args": {
       "External id": 1479,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 271
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373388767, "dur": 3,
    "args": {
       "External id": 1480,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 272
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373388802, "dur": 5,
    "args": {
       "External id": 1481,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 273
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373388839, "dur": 5,
    "args": {
       "External id": 1482,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[15360], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 274
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373388935, "dur": 3,
    "args": {
       "External id": 1483,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373388968, "dur": 1,
    "args": {
       "External id": 1484,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 275
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "detach_", "pid": 2765, "tid": 2765,
    "ts": 1638252373389022, "dur": 1,
    "args": {
       "External id": 1486,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::detach_", "pid": 2765, "tid": 2765,
    "ts": 1638252373388997, "dur": 28,
    "args": {
       "External id": 1485,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"], "Fwd thread id": 0, "Sequence number": 275
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373389081,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904984916160, "Bytes": 5056, "Total Allocated": 10928, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373389108,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904983699520, "Bytes": 816, "Total Allocated": 11744, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373389224, "dur": 9,
    "args": {
       "External id": 1490,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373389267, "dur": 30,
    "args": {
       "External id": 1491,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2765, "tid": 2765,
    "ts": 1638252373389192, "dur": 107,
    "args": {
       "External id": 1489,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373389161, "dur": 140,
    "args": {
       "External id": 1488,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373389400, "dur": 5,
    "args": {
       "External id": 1494,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373389436, "dur": 18,
    "args": {
       "External id": 1495,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2765, "tid": 2765,
    "ts": 1638252373389368, "dur": 88,
    "args": {
       "External id": 1493,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373389338, "dur": 120,
    "args": {
       "External id": 1492,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 2765, "tid": 2765,
    "ts": 1638252373389616, "dur": 2,
    "args": {
       "External id": 1498,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2765, "tid": 2765,
    "ts": 1638252373389572, "dur": 49,
    "args": {
       "External id": 1497,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373389700, "dur": 6,
    "args": {
       "External id": 1500,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373389759,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440175116288, "Bytes": 18874368, "Total Allocated": 161905664, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2765, "tid": 2765,
    "ts": 1638252373389753, "dur": 13,
    "args": {
       "External id": 1501,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::index_select", "pid": 2765, "tid": 2765,
    "ts": 1638252373389656, "dur": 143,
    "args": {
       "External id": 1499,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], [3072]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "long int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373389840, "dur": 2,
    "args": {
       "External id": 1502,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::embedding", "pid": 2765, "tid": 2765,
    "ts": 1638252373389535, "dur": 313,
    "args": {
       "External id": 1496,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [512, 6], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "Int", "Bool", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373389926, "dur": 1,
    "args": {
       "External id": 1504,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373389895, "dur": 36,
    "args": {
       "External id": 1503,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373389995, "dur": 1,
    "args": {
       "External id": 1506,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373389964, "dur": 35,
    "args": {
       "External id": 1505,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373390051,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": 18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 2765, "tid": 2765,
    "ts": 1638252373390041, "dur": 41,
    "args": {
       "External id": 1507,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373390262,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440619712512, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373390252, "dur": 17,
    "args": {
       "External id": 1511,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373390216, "dur": 56,
    "args": {
       "External id": 1510,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373390352,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440638586880, "Bytes": 4718592, "Total Allocated": 204372992, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373390344, "dur": 14,
    "args": {
       "External id": 1513,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373390309, "dur": 51,
    "args": {
       "External id": 1512,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373390176, "dur": 209,
    "args": {
       "External id": 1509,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373390389,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440638586880, "Bytes": -4718592, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373390140, "dur": 255,
    "args": {
       "External id": 1508,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373390400,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373390569,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440638586880, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373390565, "dur": 11,
    "args": {
       "External id": 1516,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373390631,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225498112, "Bytes": 12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373390627, "dur": 10,
    "args": {
       "External id": 1517,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373390684,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225510400, "Bytes": 12288, "Total Allocated": 199678976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373390680, "dur": 9,
    "args": {
       "External id": 1518,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373390766, "dur": 2,
    "args": {
       "External id": 1519,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373390811, "dur": 1,
    "args": {
       "External id": 1520,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373390517, "dur": 300,
    "args": {
       "External id": 1515,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373390820,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225498112, "Bytes": -12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373390825,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225510400, "Bytes": -12288, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373390475, "dur": 353,
    "args": {
       "External id": 1514,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373391033, "dur": 1,
    "args": {
       "External id": 1524,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373390988, "dur": 49,
    "args": {
       "External id": 1523,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373390943, "dur": 97,
    "args": {
       "External id": 1522,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373391130, "dur": 4,
    "args": {
       "External id": 1526,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373391188,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": 18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373391182, "dur": 69,
    "args": {
       "External id": 1527,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373391352, "dur": 1,
    "args": {
       "External id": 1529,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373391305, "dur": 51,
    "args": {
       "External id": 1528,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373391085, "dur": 274,
    "args": {
       "External id": 1525,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373391406, "dur": 28,
    "args": {
       "External id": 1530,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373390898, "dur": 539,
    "args": {
       "External id": 1521,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373391494, "dur": 3,
    "args": {
       "External id": 1531,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373391582, "dur": 2,
    "args": {
       "External id": 1533,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373391542, "dur": 45,
    "args": {
       "External id": 1532,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373391796, "dur": 2,
    "args": {
       "External id": 1537,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373391752, "dur": 48,
    "args": {
       "External id": 1536,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373391703, "dur": 100,
    "args": {
       "External id": 1535,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373391893, "dur": 2,
    "args": {
       "External id": 1539,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373391950,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373391943, "dur": 65,
    "args": {
       "External id": 1540,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373392104, "dur": 2,
    "args": {
       "External id": 1542,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373392060, "dur": 48,
    "args": {
       "External id": 1541,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373391848, "dur": 263,
    "args": {
       "External id": 1538,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373392159, "dur": 26,
    "args": {
       "External id": 1543,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373391658, "dur": 530,
    "args": {
       "External id": 1534,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373392240, "dur": 3,
    "args": {
       "External id": 1544,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373392330, "dur": 2,
    "args": {
       "External id": 1546,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373392289, "dur": 46,
    "args": {
       "External id": 1545,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373392529, "dur": 1,
    "args": {
       "External id": 1550,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373392484, "dur": 48,
    "args": {
       "External id": 1549,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373392440, "dur": 95,
    "args": {
       "External id": 1548,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373392634, "dur": 3,
    "args": {
       "External id": 1552,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373392692,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440676335616, "Bytes": 18874368, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373392685, "dur": 63,
    "args": {
       "External id": 1553,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373392845, "dur": 1,
    "args": {
       "External id": 1555,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373392800, "dur": 49,
    "args": {
       "External id": 1554,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373392581, "dur": 271,
    "args": {
       "External id": 1551,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373392896, "dur": 24,
    "args": {
       "External id": 1556,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373392396, "dur": 530,
    "args": {
       "External id": 1547,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373392974, "dur": 3,
    "args": {
       "External id": 1557,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373393063, "dur": 2,
    "args": {
       "External id": 1559,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373393022, "dur": 46,
    "args": {
       "External id": 1558,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373393153, "dur": 1,
    "args": {
       "External id": 1561,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373393113, "dur": 51,
    "args": {
       "External id": 1560,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373393288, "dur": 1,
    "args": {
       "External id": 1564,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373393247, "dur": 45,
    "args": {
       "External id": 1563,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373393459,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": 18874368, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373393453, "dur": 14,
    "args": {
       "External id": 1568,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373393413, "dur": 57,
    "args": {
       "External id": 1567,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373393512, "dur": 29,
    "args": {
       "External id": 1569,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2765, "tid": 2765,
    "ts": 1638252373393372, "dur": 171,
    "args": {
       "External id": 1566,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373393642, "dur": 2,
    "args": {
       "External id": 1571,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373393586, "dur": 60,
    "args": {
       "External id": 1570,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2765, "tid": 2765,
    "ts": 1638252373393333, "dur": 315,
    "args": {
       "External id": 1565,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373393729, "dur": 2,
    "args": {
       "External id": 1573,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373393688, "dur": 46,
    "args": {
       "External id": 1572,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373393897,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": 18874368, "Total Allocated": 294026240, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373393893, "dur": 13,
    "args": {
       "External id": 1577,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373393854, "dur": 55,
    "args": {
       "External id": 1576,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373393950, "dur": 24,
    "args": {
       "External id": 1578,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2765, "tid": 2765,
    "ts": 1638252373393814, "dur": 162,
    "args": {
       "External id": 1575,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373394058, "dur": 1,
    "args": {
       "External id": 1580,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373394019, "dur": 43,
    "args": {
       "External id": 1579,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2765, "tid": 2765,
    "ts": 1638252373393775, "dur": 289,
    "args": {
       "External id": 1574,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373394149,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436576403456, "Bytes": 3538944, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373394145, "dur": 11,
    "args": {
       "External id": 1582,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 2765, "tid": 2765,
    "ts": 1638252373394105, "dur": 76,
    "args": {
       "External id": 1581,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], [24576, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373394264, "dur": 2,
    "args": {
       "External id": 1584,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373394225, "dur": 43,
    "args": {
       "External id": 1583,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373394271,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373394276,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": -18874368, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373393207, "dur": 1075,
    "args": {
       "External id": 1562,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373394296,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904985263936, "Bytes": 8, "Total Allocated": 11752, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373394355,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436579942400, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mul", "pid": 2765, "tid": 2765,
    "ts": 1638252373394346, "dur": 36,
    "args": {
       "External id": 1585,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373394387,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904985263936, "Bytes": -8, "Total Allocated": 11744, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373394393,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436576403456, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373394491, "dur": 1,
    "args": {
       "External id": 1587,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373394450, "dur": 46,
    "args": {
       "External id": 1586,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373394577, "dur": 1,
    "args": {
       "External id": 1589,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2765, "tid": 2765,
    "ts": 1638252373394537, "dur": 44,
    "args": {
       "External id": 1588,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373394639,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904985286272, "Bytes": 8, "Total Allocated": 11752, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373394651,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497088, "Bytes": 512, "Total Allocated": 259816960, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373394658,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904985286272, "Bytes": -8, "Total Allocated": 11744, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::eq", "pid": 2765, "tid": 2765,
    "ts": 1638252373394636, "dur": 46,
    "args": {
       "External id": 1590,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373394823, "dur": 1,
    "args": {
       "External id": 1593,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373394782, "dur": 46,
    "args": {
       "External id": 1592,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373394909, "dur": 1,
    "args": {
       "External id": 1595,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373394869, "dur": 44,
    "args": {
       "External id": 1594,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373395037,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436583481344, "Bytes": 3538944, "Total Allocated": 263355904, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373395032, "dur": 11,
    "args": {
       "External id": 1598,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373394992, "dur": 58,
    "args": {
       "External id": 1597,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373395090, "dur": 31,
    "args": {
       "External id": 1599,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2765, "tid": 2765,
    "ts": 1638252373394954, "dur": 169,
    "args": {
       "External id": 1596,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373395248, "dur": 2,
    "args": {
       "External id": 1602,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373395209, "dur": 43,
    "args": {
       "External id": 1601,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill_", "pid": 2765, "tid": 2765,
    "ts": 1638252373395166, "dur": 113,
    "args": {
       "External id": 1600,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill", "pid": 2765, "tid": 2765,
    "ts": 1638252373394736, "dur": 546,
    "args": {
       "External id": 1591,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373395287,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497088, "Bytes": -512, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373395293,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436579942400, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373396262,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436587020288, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_softmax", "pid": 2765, "tid": 2765,
    "ts": 1638252373396252, "dur": 47,
    "args": {
       "External id": 1604,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::softmax", "pid": 2765, "tid": 2765,
    "ts": 1638252373396209, "dur": 94,
    "args": {
       "External id": 1603,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373396308,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436583481344, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373396526,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436590559232, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373396516, "dur": 17,
    "args": {
       "External id": 1608,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373396473, "dur": 63,
    "args": {
       "External id": 1607,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373396642,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225804800, "Bytes": 884736, "Total Allocated": 264240128, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373396634, "dur": 14,
    "args": {
       "External id": 1610,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373396581, "dur": 70,
    "args": {
       "External id": 1609,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373396425, "dur": 255,
    "args": {
       "External id": 1606,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373396684,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225804800, "Bytes": -884736, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373396382, "dur": 306,
    "args": {
       "External id": 1605,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373396698,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436587020288, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373396828, "dur": 2,
    "args": {
       "External id": 1613,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373396788, "dur": 46,
    "args": {
       "External id": 1612,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 2765, "tid": 2765,
    "ts": 1638252373396913, "dur": 4,
    "args": {
       "External id": 1615,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2765, "tid": 2765,
    "ts": 1638252373396874, "dur": 45,
    "args": {
       "External id": 1614,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373396998, "dur": 1,
    "args": {
       "External id": 1617,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2765, "tid": 2765,
    "ts": 1638252373396959, "dur": 43,
    "args": {
       "External id": 1616,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373397160,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436594098176, "Bytes": 18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373397155, "dur": 11,
    "args": {
       "External id": 1621,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373397117, "dur": 52,
    "args": {
       "External id": 1620,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373397208, "dur": 30,
    "args": {
       "External id": 1622,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2765, "tid": 2765,
    "ts": 1638252373397079, "dur": 162,
    "args": {
       "External id": 1619,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373397320, "dur": 2,
    "args": {
       "External id": 1624,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373397282, "dur": 42,
    "args": {
       "External id": 1623,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2765, "tid": 2765,
    "ts": 1638252373397041, "dur": 288,
    "args": {
       "External id": 1618,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373397414,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373397410, "dur": 11,
    "args": {
       "External id": 1626,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 2765, "tid": 2765,
    "ts": 1638252373397369, "dur": 77,
    "args": {
       "External id": 1625,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], [24576, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373397526, "dur": 2,
    "args": {
       "External id": 1628,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373397488, "dur": 42,
    "args": {
       "External id": 1627,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373397534,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436594098176, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373396746, "dur": 792,
    "args": {
       "External id": 1611,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373397630, "dur": 2,
    "args": {
       "External id": 1630,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373397584, "dur": 51,
    "args": {
       "External id": 1629,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373397797,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436594098176, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373397793, "dur": 10,
    "args": {
       "External id": 1634,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373397755, "dur": 50,
    "args": {
       "External id": 1633,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2765, "tid": 2765,
    "ts": 1638252373397845, "dur": 25,
    "args": {
       "External id": 1635,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2765, "tid": 2765,
    "ts": 1638252373397716, "dur": 159,
    "args": {
       "External id": 1632,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::contiguous", "pid": 2765, "tid": 2765,
    "ts": 1638252373397679, "dur": 198,
    "args": {
       "External id": 1631,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373397925, "dur": 4,
    "args": {
       "External id": 1636,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373397933,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373398127, "dur": 1,
    "args": {
       "External id": 1640,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373398084, "dur": 47,
    "args": {
       "External id": 1639,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373398040, "dur": 94,
    "args": {
       "External id": 1638,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373398221, "dur": 2,
    "args": {
       "External id": 1642,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373398277,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373398271, "dur": 68,
    "args": {
       "External id": 1643,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373398432, "dur": 2,
    "args": {
       "External id": 1645,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373398390, "dur": 46,
    "args": {
       "External id": 1644,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373398178, "dur": 261,
    "args": {
       "External id": 1641,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373398484, "dur": 27,
    "args": {
       "External id": 1646,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373397997, "dur": 524,
    "args": {
       "External id": 1637,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373398741,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": 18874368, "Total Allocated": 316439552, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373398731, "dur": 18,
    "args": {
       "External id": 1650,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373398688, "dur": 64,
    "args": {
       "External id": 1649,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373398845,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436576403456, "Bytes": 4718592, "Total Allocated": 321158144, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373398838, "dur": 13,
    "args": {
       "External id": 1652,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373398796, "dur": 58,
    "args": {
       "External id": 1651,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373398640, "dur": 240,
    "args": {
       "External id": 1648,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373398883,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436576403456, "Bytes": -4718592, "Total Allocated": 316439552, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373398589, "dur": 298,
    "args": {
       "External id": 1647,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373398893,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": -18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373398899,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436594098176, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373398904,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": -18874368, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373398908,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": -18874368, "Total Allocated": 240942080, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373398916,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440676335616, "Bytes": -18874368, "Total Allocated": 222067712, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373398921,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436590559232, "Bytes": -3538944, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373398978,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 2765, "tid": 2765,
    "ts": 1638252373398970, "dur": 32,
    "args": {
       "External id": 1653,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373399009,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": -18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373399164,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373399159, "dur": 10,
    "args": {
       "External id": 1656,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373399216,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225498112, "Bytes": 12288, "Total Allocated": 237415424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373399212, "dur": 9,
    "args": {
       "External id": 1657,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373399266,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225510400, "Bytes": 12288, "Total Allocated": 237427712, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373399263, "dur": 8,
    "args": {
       "External id": 1658,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373399343, "dur": 3,
    "args": {
       "External id": 1659,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373399387, "dur": 2,
    "args": {
       "External id": 1660,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373399116, "dur": 278,
    "args": {
       "External id": 1655,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373399397,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225498112, "Bytes": -12288, "Total Allocated": 237415424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373399405,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225510400, "Bytes": -12288, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373399074, "dur": 334,
    "args": {
       "External id": 1654,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373399608, "dur": 2,
    "args": {
       "External id": 1664,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373399559, "dur": 53,
    "args": {
       "External id": 1663,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373399515, "dur": 101,
    "args": {
       "External id": 1662,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373399703, "dur": 3,
    "args": {
       "External id": 1666,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373399759,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436941307904, "Bytes": 75497472, "Total Allocated": 312900608, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373399753, "dur": 49,
    "args": {
       "External id": 1667,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373399894, "dur": 2,
    "args": {
       "External id": 1669,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373399852, "dur": 46,
    "args": {
       "External id": 1668,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373399660, "dur": 241,
    "args": {
       "External id": 1665,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373399946, "dur": 26,
    "args": {
       "External id": 1670,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373399472, "dur": 502,
    "args": {
       "External id": 1661,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [6144, 1536], [6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373400039,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140437645950976, "Bytes": 75497472, "Total Allocated": 388398080, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::gelu", "pid": 2765, "tid": 2765,
    "ts": 1638252373400032, "dur": 38,
    "args": {
       "External id": 1671,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1556): gelu;/miniconda/lib/python3.8/site-packages/torch/nn/modules/activation.py(652): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373400075,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436941307904, "Bytes": -75497472, "Total Allocated": 312900608, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373400259, "dur": 1,
    "args": {
       "External id": 1675,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373400216, "dur": 47,
    "args": {
       "External id": 1674,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373400173, "dur": 93,
    "args": {
       "External id": 1673,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373400352, "dur": 3,
    "args": {
       "External id": 1677,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373400407,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": 18874368, "Total Allocated": 331774976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373400401, "dur": 58,
    "args": {
       "External id": 1678,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373400551, "dur": 2,
    "args": {
       "External id": 1680,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373400509, "dur": 46,
    "args": {
       "External id": 1679,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373400310, "dur": 248,
    "args": {
       "External id": 1676,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2765, "tid": 2765,
    "ts": 1638252373400610, "dur": 25,
    "args": {
       "External id": 1681,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373400131, "dur": 507,
    "args": {
       "External id": 1672,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [1536, 6144], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373400644,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140437645950976, "Bytes": -75497472, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373400854,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440676335616, "Bytes": 18874368, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373400845, "dur": 16,
    "args": {
       "External id": 1685,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373400802, "dur": 62,
    "args": {
       "External id": 1684,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373400958,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": 4718592, "Total Allocated": 279870464, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373400950, "dur": 14,
    "args": {
       "External id": 1687,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2765, "tid": 2765,
    "ts": 1638252373400908, "dur": 58,
    "args": {
       "External id": 1686,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373400755, "dur": 236,
    "args": {
       "External id": 1683,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373400994,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436557529088, "Bytes": -4718592, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2765, "tid": 2765,
    "ts": 1638252373400712, "dur": 286,
    "args": {
       "External id": 1682,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373401003,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": -18874368, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373401009,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140436538654720, "Bytes": -18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373401013,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440638586880, "Bytes": -18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373401017,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440598740992, "Bytes": -18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373401022,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440619712512, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373401162,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373401158, "dur": 10,
    "args": {
       "External id": 1690,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373401208,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225498112, "Bytes": 12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373401204, "dur": 9,
    "args": {
       "External id": 1691,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373401252,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225510400, "Bytes": 12288, "Total Allocated": 199678976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2765, "tid": 2765,
    "ts": 1638252373401249, "dur": 8,
    "args": {
       "External id": 1692,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373401324, "dur": 2,
    "args": {
       "External id": 1693,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373401362, "dur": 1,
    "args": {
       "External id": 1694,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373401120, "dur": 247,
    "args": {
       "External id": 1689,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373401370,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225498112, "Bytes": -12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373401375,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225510400, "Bytes": -12288, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2765, "tid": 2765,
    "ts": 1638252373401085, "dur": 293,
    "args": {
       "External id": 1688,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373401383,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440676335616, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2765, "tid": 2765,
    "ts": 1638252373401533, "dur": 1,
    "args": {
       "External id": 1698,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2765, "tid": 2765,
    "ts": 1638252373401498, "dur": 39,
    "args": {
       "External id": 1697,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2765, "tid": 2765,
    "ts": 1638252373401464, "dur": 81,
    "args": {
       "External id": 1696,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373401621, "dur": 3,
    "args": {
       "External id": 1700,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373401669,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225559040, "Bytes": 122880, "Total Allocated": 180902912, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2765, "tid": 2765,
    "ts": 1638252373401662, "dur": 43,
    "args": {
       "External id": 1701,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 10]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373401779, "dur": 2,
    "args": {
       "External id": 1703,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2765, "tid": 2765,
    "ts": 1638252373401745, "dur": 38,
    "args": {
       "External id": 1702,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2765, "tid": 2765,
    "ts": 1638252373401580, "dur": 206,
    "args": {
       "External id": 1699,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 10]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2765, "tid": 2765,
    "ts": 1638252373401431, "dur": 357,
    "args": {
       "External id": 1695,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [10, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373401794,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440657461248, "Bytes": -18874368, "Total Allocated": 162028544, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373401833, "dur": 2,
    "args": {
       "External id": 1704,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 10], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2765, "tid": 2765,
    "ts": 1638252373401868, "dur": 2,
    "args": {
       "External id": 1705,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2765, "tid": 2765,
    "ts": 1638252373401972, "dur": 1,
    "args": {
       "External id": 1708,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373402011,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225804800, "Bytes": 122880, "Total Allocated": 162151424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_log_softmax", "pid": 2765, "tid": 2765,
    "ts": 1638252373402005, "dur": 33,
    "args": {
       "External id": 1709,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::log_softmax", "pid": 2765, "tid": 2765,
    "ts": 1638252373401941, "dur": 103,
    "args": {
       "External id": 1707,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373402146,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497088, "Bytes": 512, "Total Allocated": 162151936, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373402153,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225498112, "Bytes": 512, "Total Allocated": 162152448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2765, "tid": 2765,
    "ts": 1638252373402189, "dur": 1,
    "args": {
       "External id": 1713,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2765, "tid": 2765,
    "ts": 1638252373402222, "dur": 0,
    "args": {
       "External id": 1714,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss_forward", "pid": 2765, "tid": 2765,
    "ts": 1638252373402141, "dur": 103,
    "args": {
       "External id": 1712,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373402247,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225498112, "Bytes": -512, "Total Allocated": 162151936, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss", "pid": 2765, "tid": 2765,
    "ts": 1638252373402110, "dur": 141,
    "args": {
       "External id": 1711,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss_nd", "pid": 2765, "tid": 2765,
    "ts": 1638252373402079, "dur": 174,
    "args": {
       "External id": 1710,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373402255,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225804800, "Bytes": -122880, "Total Allocated": 162029056, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::cross_entropy_loss", "pid": 2765, "tid": 2765,
    "ts": 1638252373401909, "dur": 349,
    "args": {
       "External id": 1706,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373402264,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440175116288, "Bytes": -18874368, "Total Allocated": 143154688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "CheckpointFunction", "pid": 2765, "tid": 2765,
    "ts": 1638252373389053, "dur": 13310,
    "args": {
       "External id": 1487,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Fwd thread id": 0, "Sequence number": 275
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2765, "tid": 2765,
    "ts": 1638252373402414, "dur": 1,
    "args": {
       "External id": 1715,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [7093632]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1822): _use_fp32_param_shard;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1153): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373402483,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225681920, "Bytes": -122880, "Total Allocated": 143031808, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373402516,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904983768448, "Bytes": -5056, "Total Allocated": 6688, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373402521,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94904982233024, "Bytes": -816, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2765, "tid": 2765,
    "ts": 1638252373402530,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140440225497600, "Bytes": -512, "Total Allocated": 143031296, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "ProfilerStep#10", "pid": 2765, "tid": 2765,
    "ts": 1638252373384828, "dur": 26851,
    "args": {
       "External id": 1376,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(330): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;"
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 2765, "tid": 487929600,
    "ts": 1638252373277457, "dur": 4,
    "args": {
      "cbid": 151, "correlation": 2426,
      "external id": 0, "external ts": 1638252373402530
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 487929600,
    "ts": 1638252373277467, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 2429,
      "external id": 0, "external ts": 1638252373402530
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2765, "tid": 487929600,
    "ts": 1638252373277472, "dur": 2,
    "args": {
      "cbid": 136, "correlation": 2430,
      "external id": 0, "external ts": 1638252373402530
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 487929600,
    "ts": 1638252373277475, "dur": 1,
    "args": {
      "cbid": 138, "correlation": 2431,
      "external id": 0, "external ts": 1638252373402530
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2765, "tid": 487929600,
    "ts": 1638252373277477, "dur": 0,
    "args": {
      "cbid": 136, "correlation": 2432,
      "external id": 0, "external ts": 1638252373402530
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 2765, "tid": 487929600,
    "ts": 1638252373277658, "dur": 1,
    "args": {
      "cbid": 151, "correlation": 2436,
      "external id": 0, "external ts": 1638252373402530
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy HtoD (Pinned -> Device)", "pid": 3, "tid": 7,
    "ts": 1638252373278069, "dur": 2,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 2457, "external id": 14,
      "bytes": 24576, "memory bandwidth (GB/s)": 10.24
    }
  },
  {
    "ph": "f", "id": 2457, "pid": 3, "tid": 7, "ts": 1638252373278069,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373278044, "dur": 21,
    "args": {
      "cbid": 41, "correlation": 2457,
      "external id": 14, "external ts": 1638252373278035
    }
  },
  {
    "ph": "s", "id": 2457, "pid": 2765, "tid": 2765, "ts": 1638252373278044,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamSynchronize", "pid": 2765, "tid": 2765,
    "ts": 1638252373278066, "dur": 8,
    "args": {
      "cbid": 131, "correlation": 2458,
      "external id": 14, "external ts": 1638252373278035
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy HtoD (Pinned -> Device)", "pid": 3, "tid": 7,
    "ts": 1638252373278208, "dur": 2,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 2470, "external id": 18,
      "bytes": 24576, "memory bandwidth (GB/s)": 10.378378378378379
    }
  },
  {
    "ph": "f", "id": 2470, "pid": 3, "tid": 7, "ts": 1638252373278208,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373278188, "dur": 16,
    "args": {
      "cbid": 41, "correlation": 2470,
      "external id": 18, "external ts": 1638252373278183
    }
  },
  {
    "ph": "s", "id": 2470, "pid": 2765, "tid": 2765, "ts": 1638252373278188,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamSynchronize", "pid": 2765, "tid": 2765,
    "ts": 1638252373278204, "dur": 8,
    "args": {
      "cbid": 131, "correlation": 2471,
      "external id": 18, "external ts": 1638252373278183
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 2765, "tid": 2765,
    "ts": 1638252373278248, "dur": 4,
    "args": {
      "cbid": 165, "correlation": 2475,
      "external id": 4, "external ts": 1638252373277106
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373278543, "dur": 2,
    "args": {
      "cbid": 134, "correlation": 2481,
      "external id": 4, "external ts": 1638252373277106
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373278547, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 2484,
      "external id": 4, "external ts": 1638252373277106
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamWaitEvent", "pid": 2765, "tid": 2765,
    "ts": 1638252373278555, "dur": 1,
    "args": {
      "cbid": 147, "correlation": 2487,
      "external id": 4, "external ts": 1638252373277106
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2765, "tid": 2765,
    "ts": 1638252373278560, "dur": 1,
    "args": {
      "cbid": 136, "correlation": 2490,
      "external id": 4, "external ts": 1638252373277106
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoH (Device -> Pinned)", "pid": 3, "tid": 7,
    "ts": 1638252373282299, "dur": 2,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 2499, "external id": 119,
      "bytes": 24576, "memory bandwidth (GB/s)": 8.533333333333333
    }
  },
  {
    "ph": "f", "id": 2499, "pid": 3, "tid": 7, "ts": 1638252373282299,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373282281, "dur": 16,
    "args": {
      "cbid": 41, "correlation": 2499,
      "external id": 119, "external ts": 1638252373282273
    }
  },
  {
    "ph": "s", "id": 2499, "pid": 2765, "tid": 2765, "ts": 1638252373282281,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoH (Device -> Pinned)", "pid": 3, "tid": 7,
    "ts": 1638252373282498, "dur": 3,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 2505, "external id": 123,
      "bytes": 24576, "memory bandwidth (GB/s)": 7.836734693877551
    }
  },
  {
    "ph": "f", "id": 2505, "pid": 3, "tid": 7, "ts": 1638252373282498,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373282485, "dur": 11,
    "args": {
      "cbid": 41, "correlation": 2505,
      "external id": 123, "external ts": 1638252373282480
    }
  },
  {
    "ph": "s", "id": 2505, "pid": 2765, "tid": 2765, "ts": 1638252373282485,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::indexSelectLargeIndex<float, long, unsigned int, 2, 2, -2, true>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<long, unsigned int>, int, int, unsigned int, unsigned int, long)", "pid": 3, "tid": 7,
    "ts": 1638252373282879, "dur": 76,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2518, "external id": 127,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 8.0,
      "warps per SM": 32.0,
      "grid": [544, 1, 1],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2518, "pid": 3, "tid": 7, "ts": 1638252373282879,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373282854, "dur": 24,
    "args": {
      "cbid": 211, "correlation": 2518,
      "external id": 127, "external ts": 1638252373282731
    }
  },
  {
    "ph": "s", "id": 2518, "pid": 2765, "tid": 2765, "ts": 1638252373282854,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373283185, "dur": 73,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2526, "external id": 135,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2526, "pid": 3, "tid": 7, "ts": 1638252373283185,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373283167, "dur": 17,
    "args": {
      "cbid": 211, "correlation": 2526,
      "external id": 135, "external ts": 1638252373283144
    }
  },
  {
    "ph": "s", "id": 2526, "pid": 2765, "tid": 2765, "ts": 1638252373283167,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 3, "tid": 7,
    "ts": 1638252373283531, "dur": 84,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2548, "external id": 137,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2548, "pid": 3, "tid": 7, "ts": 1638252373283531,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373283514, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 2548,
      "external id": 137, "external ts": 1638252373283308
    }
  },
  {
    "ph": "s", "id": 2548, "pid": 2765, "tid": 2765, "ts": 1638252373283514,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373283897, "dur": 133,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2562, "external id": 143,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2562, "pid": 3, "tid": 7, "ts": 1638252373283897,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373283881, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 2562,
      "external id": 143, "external ts": 1638252373283696
    }
  },
  {
    "ph": "s", "id": 2562, "pid": 2765, "tid": 2765, "ts": 1638252373283881,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373284033, "dur": 68,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2564, "external id": 143,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2564, "pid": 3, "tid": 7, "ts": 1638252373284033,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373283897, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 2564,
      "external id": 143, "external ts": 1638252373283696
    }
  },
  {
    "ph": "s", "id": 2564, "pid": 2765, "tid": 2765, "ts": 1638252373283897,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373284444, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 2571,
      "external id": 155, "external ts": 1638252373284421
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373284450, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 2572,
      "external id": 155, "external ts": 1638252373284421
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638252373284470, "dur": 0,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 2573, "external id": 155,
      "bytes": 2304, "memory bandwidth (GB/s)": 3.6
    }
  },
  {
    "ph": "f", "id": 2573, "pid": 3, "tid": 7, "ts": 1638252373284470,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373284456, "dur": 11,
    "args": {
      "cbid": 51, "correlation": 2573,
      "external id": 155, "external ts": 1638252373284421
    }
  },
  {
    "ph": "s", "id": 2573, "pid": 2765, "tid": 2765, "ts": 1638252373284456,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373284468, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 2574,
      "external id": 155, "external ts": 1638252373284421
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 3, "tid": 7,
    "ts": 1638252373284490, "dur": 1382,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2575, "external id": 155,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 2575, "pid": 3, "tid": 7, "ts": 1638252373284490,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373284474, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 2575,
      "external id": 155, "external ts": 1638252373284421
    }
  },
  {
    "ph": "s", "id": 2575, "pid": 2765, "tid": 2765, "ts": 1638252373284474,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373284491, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 2577,
      "external id": 155, "external ts": 1638252373284421
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373285874, "dur": 74,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2581, "external id": 158,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2581, "pid": 3, "tid": 7, "ts": 1638252373285874,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373284687, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 2581,
      "external id": 158, "external ts": 1638252373284674
    }
  },
  {
    "ph": "s", "id": 2581, "pid": 2765, "tid": 2765, "ts": 1638252373284687,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373285222, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 2588,
      "external id": 168, "external ts": 1638252373285200
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373285226, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 2589,
      "external id": 168, "external ts": 1638252373285200
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638252373285951, "dur": 0,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 2590, "external id": 168,
      "bytes": 2304, "memory bandwidth (GB/s)": 2.4827586206896552
    }
  },
  {
    "ph": "f", "id": 2590, "pid": 3, "tid": 7, "ts": 1638252373285951,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373285231, "dur": 9,
    "args": {
      "cbid": 51, "correlation": 2590,
      "external id": 168, "external ts": 1638252373285200
    }
  },
  {
    "ph": "s", "id": 2590, "pid": 2765, "tid": 2765, "ts": 1638252373285231,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373285241, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 2591,
      "external id": 168, "external ts": 1638252373285200
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 3, "tid": 7,
    "ts": 1638252373285954, "dur": 1376,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2592, "external id": 168,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 2592, "pid": 3, "tid": 7, "ts": 1638252373285954,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373285247, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 2592,
      "external id": 168, "external ts": 1638252373285200
    }
  },
  {
    "ph": "s", "id": 2592, "pid": 2765, "tid": 2765, "ts": 1638252373285247,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373285262, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 2594,
      "external id": 168, "external ts": 1638252373285200
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373287332, "dur": 74,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2598, "external id": 171,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2598, "pid": 3, "tid": 7, "ts": 1638252373287332,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373285431, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 2598,
      "external id": 171, "external ts": 1638252373285420
    }
  },
  {
    "ph": "s", "id": 2598, "pid": 2765, "tid": 2765, "ts": 1638252373285431,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373285972, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 2605,
      "external id": 181, "external ts": 1638252373285949
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373285976, "dur": 2,
    "args": {
      "cbid": 138, "correlation": 2606,
      "external id": 181, "external ts": 1638252373285949
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638252373287410, "dur": 0,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 2607, "external id": 181,
      "bytes": 2304, "memory bandwidth (GB/s)": 4.8
    }
  },
  {
    "ph": "f", "id": 2607, "pid": 3, "tid": 7, "ts": 1638252373287410,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373285980, "dur": 8,
    "args": {
      "cbid": 51, "correlation": 2607,
      "external id": 181, "external ts": 1638252373285949
    }
  },
  {
    "ph": "s", "id": 2607, "pid": 2765, "tid": 2765, "ts": 1638252373285980,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373285990, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 2608,
      "external id": 181, "external ts": 1638252373285949
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 3, "tid": 7,
    "ts": 1638252373287412, "dur": 1378,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2609, "external id": 181,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 2609, "pid": 3, "tid": 7, "ts": 1638252373287412,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373285995, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 2609,
      "external id": 181, "external ts": 1638252373285949
    }
  },
  {
    "ph": "s", "id": 2609, "pid": 2765, "tid": 2765, "ts": 1638252373285995,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373286011, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 2611,
      "external id": 181, "external ts": 1638252373285949
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373288792, "dur": 75,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2615, "external id": 184,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2615, "pid": 3, "tid": 7, "ts": 1638252373288792,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373286173, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 2615,
      "external id": 184, "external ts": 1638252373286163
    }
  },
  {
    "ph": "s", "id": 2615, "pid": 2765, "tid": 2765, "ts": 1638252373286173,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373288869, "dur": 74,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2623, "external id": 197,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2623, "pid": 3, "tid": 7, "ts": 1638252373288869,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373286817, "dur": 18,
    "args": {
      "cbid": 211, "correlation": 2623,
      "external id": 197, "external ts": 1638252373286807
    }
  },
  {
    "ph": "s", "id": 2623, "pid": 2765, "tid": 2765, "ts": 1638252373286817,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373288946, "dur": 71,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2632, "external id": 206,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2632, "pid": 3, "tid": 7, "ts": 1638252373288946,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373287245, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 2632,
      "external id": 206, "external ts": 1638252373287238
    }
  },
  {
    "ph": "s", "id": 2632, "pid": 2765, "tid": 2765, "ts": 1638252373287245,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 3, "tid": 7,
    "ts": 1638252373289020, "dur": 282,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2642, "external id": 209,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2642, "pid": 3, "tid": 7, "ts": 1638252373289020,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373287467, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 2642,
      "external id": 209, "external ts": 1638252373287403
    }
  },
  {
    "ph": "s", "id": 2642, "pid": 2765, "tid": 2765, "ts": 1638252373287467,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 3, "tid": 7,
    "ts": 1638252373289305, "dur": 9,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2648, "external id": 213,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2648, "pid": 3, "tid": 7, "ts": 1638252373289305,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373287683, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 2648,
      "external id": 213, "external ts": 1638252373287662
    }
  },
  {
    "ph": "s", "id": 2648, "pid": 2765, "tid": 2765, "ts": 1638252373287683,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 3, "tid": 7,
    "ts": 1638252373289317, "dur": 2,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2656, "external id": 218,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.029411765,
      "grid": [1, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 2656, "pid": 3, "tid": 7, "ts": 1638252373289317,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373287990, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 2656,
      "external id": 218, "external ts": 1638252373287961
    }
  },
  {
    "ph": "s", "id": 2656, "pid": 2765, "tid": 2765, "ts": 1638252373287990,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoD (Device -> Device)", "pid": 3, "tid": 7,
    "ts": 1638252373289321, "dur": 8,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 2663, "external id": 227,
      "bytes": 3538944, "memory bandwidth (GB/s)": 428.6511627906977
    }
  },
  {
    "ph": "f", "id": 2663, "pid": 3, "tid": 7, "ts": 1638252373289321,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373288507, "dur": 27,
    "args": {
      "cbid": 41, "correlation": 2663,
      "external id": 227, "external ts": 1638252373288501
    }
  },
  {
    "ph": "s", "id": 2663, "pid": 2765, "tid": 2765, "ts": 1638252373288507,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast>(int, at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373289331, "dur": 14,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2668, "external id": 228,
      "registers per thread": 24,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2668, "pid": 3, "tid": 7, "ts": 1638252373289331,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373288686, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 2668,
      "external id": 228, "external ts": 1638252373288586
    }
  },
  {
    "ph": "s", "id": 2668, "pid": 2765, "tid": 2765, "ts": 1638252373288686,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 3, false>(float*, float const*, int, int, int)", "pid": 3, "tid": 7,
    "ts": 1638252373289347, "dur": 20,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2675, "external id": 232,
      "registers per thread": 19,
      "shared memory": 0,
      "blocks per SM": 67.76471,
      "warps per SM": 271.05884,
      "grid": [4608, 1, 1],
      "block": [8, 16, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2675, "pid": 3, "tid": 7, "ts": 1638252373289347,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373288845, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 2675,
      "external id": 232, "external ts": 1638252373288829
    }
  },
  {
    "ph": "s", "id": 2675, "pid": 2765, "tid": 2765, "ts": 1638252373288845,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 3, "tid": 7,
    "ts": 1638252373289370, "dur": 12,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2697, "external id": 234,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2697, "pid": 3, "tid": 7, "ts": 1638252373289370,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373289225, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 2697,
      "external id": 234, "external ts": 1638252373288987
    }
  },
  {
    "ph": "s", "id": 2697, "pid": 2765, "tid": 2765, "ts": 1638252373289225,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373289819, "dur": 75,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2705, "external id": 250,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2705, "pid": 3, "tid": 7, "ts": 1638252373289819,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373289802, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 2705,
      "external id": 250, "external ts": 1638252373289792
    }
  },
  {
    "ph": "s", "id": 2705, "pid": 2765, "tid": 2765, "ts": 1638252373289802,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 3, "tid": 7,
    "ts": 1638252373290033, "dur": 271,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2715, "external id": 253,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2715, "pid": 3, "tid": 7, "ts": 1638252373290033,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373290019, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 2715,
      "external id": 253, "external ts": 1638252373289955
    }
  },
  {
    "ph": "s", "id": 2715, "pid": 2765, "tid": 2765, "ts": 1638252373290019,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373290482, "dur": 73,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2724, "external id": 263,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2724, "pid": 3, "tid": 7, "ts": 1638252373290482,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373290467, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 2724,
      "external id": 263, "external ts": 1638252373290459
    }
  },
  {
    "ph": "s", "id": 2724, "pid": 2765, "tid": 2765, "ts": 1638252373290467,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373290932, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 2733,
      "external id": 271, "external ts": 1638252373290910
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373290937, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 2734,
      "external id": 271, "external ts": 1638252373290910
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638252373290957, "dur": 1,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 2735, "external id": 271,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.894736842105263
    }
  },
  {
    "ph": "f", "id": 2735, "pid": 3, "tid": 7, "ts": 1638252373290957,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373290943, "dur": 10,
    "args": {
      "cbid": 51, "correlation": 2735,
      "external id": 271, "external ts": 1638252373290910
    }
  },
  {
    "ph": "s", "id": 2735, "pid": 2765, "tid": 2765, "ts": 1638252373290943,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373290954, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 2736,
      "external id": 271, "external ts": 1638252373290910
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 3, "tid": 7,
    "ts": 1638252373290976, "dur": 1379,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2737, "external id": 271,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 2737, "pid": 3, "tid": 7, "ts": 1638252373290976,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373290960, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 2737,
      "external id": 271, "external ts": 1638252373290910
    }
  },
  {
    "ph": "s", "id": 2737, "pid": 2765, "tid": 2765, "ts": 1638252373290960,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373290977, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 2739,
      "external id": 271, "external ts": 1638252373290910
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373292357, "dur": 74,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2743, "external id": 274,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2743, "pid": 3, "tid": 7, "ts": 1638252373292357,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373291146, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 2743,
      "external id": 274, "external ts": 1638252373291134
    }
  },
  {
    "ph": "s", "id": 2743, "pid": 2765, "tid": 2765, "ts": 1638252373291146,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 3, "tid": 7,
    "ts": 1638252373292433, "dur": 86,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2765, "external id": 276,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2765, "pid": 3, "tid": 7, "ts": 1638252373292433,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373291507, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 2765,
      "external id": 276, "external ts": 1638252373291276
    }
  },
  {
    "ph": "s", "id": 2765, "pid": 2765, "tid": 2765, "ts": 1638252373291507,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3> >(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>)", "pid": 3, "tid": 7,
    "ts": 1638252373292522, "dur": 104,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2771, "external id": 281,
      "registers per thread": 20,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2771, "pid": 3, "tid": 7, "ts": 1638252373292522,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373291639, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 2771,
      "external id": 281, "external ts": 1638252373291622
    }
  },
  {
    "ph": "s", "id": 2771, "pid": 2765, "tid": 2765, "ts": 1638252373291639,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373292628, "dur": 125,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2785, "external id": 283,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2785, "pid": 3, "tid": 7, "ts": 1638252373292628,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373292061, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 2785,
      "external id": 283, "external ts": 1638252373291879
    }
  },
  {
    "ph": "s", "id": 2785, "pid": 2765, "tid": 2765, "ts": 1638252373292061,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373292755, "dur": 68,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2787, "external id": 283,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2787, "pid": 3, "tid": 7, "ts": 1638252373292755,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373292077, "dur": 9,
    "args": {
      "cbid": 211, "correlation": 2787,
      "external id": 283, "external ts": 1638252373291879
    }
  },
  {
    "ph": "s", "id": 2787, "pid": 2765, "tid": 2765, "ts": 1638252373292077,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 2765, "tid": 487929600,
    "ts": 1638252373292742, "dur": 4,
    "args": {
      "cbid": 151, "correlation": 2795,
      "external id": 0, "external ts": 1638252373402530
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373292761, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 2800,
      "external id": 295, "external ts": 1638252373292737
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373292766, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 2801,
      "external id": 295, "external ts": 1638252373292737
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 2765, "tid": 487929600,
    "ts": 1638252373292779, "dur": 1,
    "args": {
      "cbid": 151, "correlation": 2806,
      "external id": 0, "external ts": 1638252373402530
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 3, "tid": 7,
    "ts": 1638252373292826, "dur": 5128,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2802, "external id": 295,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [48, 24, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 2802, "pid": 3, "tid": 7, "ts": 1638252373292826,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373292771, "dur": 17,
    "args": {
      "cbid": 211, "correlation": 2802,
      "external id": 295, "external ts": 1638252373292737
    }
  },
  {
    "ph": "s", "id": 2802, "pid": 2765, "tid": 2765, "ts": 1638252373292771,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373297956, "dur": 281,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2813, "external id": 298,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2813, "pid": 3, "tid": 7, "ts": 1638252373297956,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373293032, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 2813,
      "external id": 298, "external ts": 1638252373293020
    }
  },
  {
    "ph": "s", "id": 2813, "pid": 2765, "tid": 2765, "ts": 1638252373293032,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2> >(int, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>)", "pid": 3, "tid": 7,
    "ts": 1638252373298240, "dur": 280,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2819, "external id": 299,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2819, "pid": 3, "tid": 7, "ts": 1638252373298240,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373293148, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 2819,
      "external id": 299, "external ts": 1638252373293128
    }
  },
  {
    "ph": "s", "id": 2819, "pid": 2765, "tid": 2765, "ts": 1638252373293148,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373293544, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 2826,
      "external id": 306, "external ts": 1638252373293521
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373293549, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 2827,
      "external id": 306, "external ts": 1638252373293521
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638252373298522, "dur": 0,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 2828, "external id": 306,
      "bytes": 1152, "memory bandwidth (GB/s)": 4.0
    }
  },
  {
    "ph": "f", "id": 2828, "pid": 3, "tid": 7, "ts": 1638252373298522,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373293554, "dur": 10,
    "args": {
      "cbid": 51, "correlation": 2828,
      "external id": 306, "external ts": 1638252373293521
    }
  },
  {
    "ph": "s", "id": 2828, "pid": 2765, "tid": 2765, "ts": 1638252373293554,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 3, "tid": 7,
    "ts": 1638252373298524, "dur": 5160,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2829, "external id": 306,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [12, 24, 4],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 2829, "pid": 3, "tid": 7, "ts": 1638252373298524,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373293566, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 2829,
      "external id": 306, "external ts": 1638252373293521
    }
  },
  {
    "ph": "s", "id": 2829, "pid": 2765, "tid": 2765, "ts": 1638252373293566,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373293581, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 2831,
      "external id": 306, "external ts": 1638252373293521
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373303687, "dur": 74,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2835, "external id": 309,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2835, "pid": 3, "tid": 7, "ts": 1638252373303687,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373293757, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 2835,
      "external id": 309, "external ts": 1638252373293746
    }
  },
  {
    "ph": "s", "id": 2835, "pid": 2765, "tid": 2765, "ts": 1638252373293757,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 3, "tid": 7,
    "ts": 1638252373303765, "dur": 85,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2857, "external id": 311,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2857, "pid": 3, "tid": 7, "ts": 1638252373303765,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373294134, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 2857,
      "external id": 311, "external ts": 1638252373293904
    }
  },
  {
    "ph": "s", "id": 2857, "pid": 2765, "tid": 2765, "ts": 1638252373294134,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373303852, "dur": 133,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2871, "external id": 317,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2871, "pid": 3, "tid": 7, "ts": 1638252373303852,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373294434, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 2871,
      "external id": 317, "external ts": 1638252373294285
    }
  },
  {
    "ph": "s", "id": 2871, "pid": 2765, "tid": 2765, "ts": 1638252373294434,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373303987, "dur": 69,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2873, "external id": 317,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2873, "pid": 3, "tid": 7, "ts": 1638252373303987,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373294449, "dur": 9,
    "args": {
      "cbid": 211, "correlation": 2873,
      "external id": 317, "external ts": 1638252373294285
    }
  },
  {
    "ph": "s", "id": 2873, "pid": 2765, "tid": 2765, "ts": 1638252373294449,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373294866, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 2880,
      "external id": 329, "external ts": 1638252373294846
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_32x32_sliced1x4_tn", "pid": 3, "tid": 7,
    "ts": 1638252373304058, "dur": 81,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2881, "external id": 329,
      "registers per thread": 86,
      "shared memory": 32768,
      "blocks per SM": 1.4117647,
      "warps per SM": 5.647059,
      "grid": [1, 96, 1],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 18
    }
  },
  {
    "ph": "f", "id": 2881, "pid": 3, "tid": 7, "ts": 1638252373304058,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373294872, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 2881,
      "external id": 329, "external ts": 1638252373294846
    }
  },
  {
    "ph": "s", "id": 2881, "pid": 2765, "tid": 2765, "ts": 1638252373294872,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 4, true>(float*, float const*, int, int, int)", "pid": 3, "tid": 7,
    "ts": 1638252373304143, "dur": 2,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2888, "external id": 337,
      "registers per thread": 18,
      "shared memory": 0,
      "blocks per SM": 2.8235295,
      "warps per SM": 11.294118,
      "grid": [192, 1, 1],
      "block": [16, 8, 1],
      "est. achieved occupancy %": 35
    }
  },
  {
    "ph": "f", "id": 2888, "pid": 3, "tid": 7, "ts": 1638252373304143,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373295250, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 2888,
      "external id": 337, "external ts": 1638252373295234
    }
  },
  {
    "ph": "s", "id": 2888, "pid": 2765, "tid": 2765, "ts": 1638252373295250,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::nll_loss_forward_reduce_cuda_kernel_2d<float, float, long>(float*, float*, float*, long*, float*, bool, int, int, int, long)", "pid": 3, "tid": 7,
    "ts": 1638252373304148, "dur": 58,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2895, "external id": 340,
      "registers per thread": 38,
      "shared memory": 256,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.014705882,
      "grid": [1, 1, 1],
      "block": [32, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 2895, "pid": 3, "tid": 7, "ts": 1638252373304148,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373295495, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 2895,
      "external id": 340, "external ts": 1638252373295395
    }
  },
  {
    "ph": "s", "id": 2895, "pid": 2765, "tid": 2765, "ts": 1638252373295495,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373295788, "dur": 2,
    "args": {
      "cbid": 134, "correlation": 2900,
      "external id": 4, "external ts": 1638252373277106
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373295791, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 2901,
      "external id": 4, "external ts": 1638252373277106
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373295796, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 2903,
      "external id": 4, "external ts": 1638252373277106
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373295803, "dur": 0,
    "args": {
      "cbid": 134, "correlation": 2907,
      "external id": 4, "external ts": 1638252373277106
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373295805, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 2908,
      "external id": 4, "external ts": 1638252373277106
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 2765, "tid": 2765,
    "ts": 1638252373295931, "dur": 8278,
    "args": {
      "cbid": 165, "correlation": 2912,
      "external id": 4, "external ts": 1638252373277106
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy HtoD (Pinned -> Device)", "pid": 3, "tid": 7,
    "ts": 1638252373305445, "dur": 2,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 2923, "external id": 357,
      "bytes": 24576, "memory bandwidth (GB/s)": 12.0
    }
  },
  {
    "ph": "f", "id": 2923, "pid": 3, "tid": 7, "ts": 1638252373305445,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373305419, "dur": 22,
    "args": {
      "cbid": 41, "correlation": 2923,
      "external id": 357, "external ts": 1638252373305411
    }
  },
  {
    "ph": "s", "id": 2923, "pid": 2765, "tid": 2765, "ts": 1638252373305419,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamSynchronize", "pid": 2765, "tid": 2765,
    "ts": 1638252373305442, "dur": 8,
    "args": {
      "cbid": 131, "correlation": 2924,
      "external id": 357, "external ts": 1638252373305411
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy HtoD (Pinned -> Device)", "pid": 3, "tid": 7,
    "ts": 1638252373305582, "dur": 2,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 2936, "external id": 361,
      "bytes": 24576, "memory bandwidth (GB/s)": 12.0
    }
  },
  {
    "ph": "f", "id": 2936, "pid": 3, "tid": 7, "ts": 1638252373305582,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373305563, "dur": 15,
    "args": {
      "cbid": 41, "correlation": 2936,
      "external id": 361, "external ts": 1638252373305558
    }
  },
  {
    "ph": "s", "id": 2936, "pid": 2765, "tid": 2765, "ts": 1638252373305563,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamSynchronize", "pid": 2765, "tid": 2765,
    "ts": 1638252373305579, "dur": 8,
    "args": {
      "cbid": 131, "correlation": 2937,
      "external id": 361, "external ts": 1638252373305558
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 2765, "tid": 2765,
    "ts": 1638252373305633, "dur": 4,
    "args": {
      "cbid": 165, "correlation": 2941,
      "external id": 347, "external ts": 1638252373304432
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373305913, "dur": 2,
    "args": {
      "cbid": 134, "correlation": 2947,
      "external id": 347, "external ts": 1638252373304432
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373305918, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 2950,
      "external id": 347, "external ts": 1638252373304432
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamWaitEvent", "pid": 2765, "tid": 2765,
    "ts": 1638252373305925, "dur": 1,
    "args": {
      "cbid": 147, "correlation": 2953,
      "external id": 347, "external ts": 1638252373304432
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2765, "tid": 2765,
    "ts": 1638252373305930, "dur": 1,
    "args": {
      "cbid": 136, "correlation": 2956,
      "external id": 347, "external ts": 1638252373304432
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373309611, "dur": 5,
    "args": {
      "cbid": 138, "correlation": 2961,
      "external id": 461, "external ts": 1638252373309600
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2765, "tid": 2765,
    "ts": 1638252373309617, "dur": 2,
    "args": {
      "cbid": 136, "correlation": 2962,
      "external id": 461, "external ts": 1638252373309600
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373309622, "dur": 1,
    "args": {
      "cbid": 138, "correlation": 2963,
      "external id": 461, "external ts": 1638252373309600
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2765, "tid": 2765,
    "ts": 1638252373309623, "dur": 1,
    "args": {
      "cbid": 136, "correlation": 2964,
      "external id": 461, "external ts": 1638252373309600
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoH (Device -> Pinned)", "pid": 3, "tid": 7,
    "ts": 1638252373309690, "dur": 2,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 2969, "external id": 462,
      "bytes": 24576, "memory bandwidth (GB/s)": 8.629213483146067
    }
  },
  {
    "ph": "f", "id": 2969, "pid": 3, "tid": 7, "ts": 1638252373309690,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373309673, "dur": 15,
    "args": {
      "cbid": 41, "correlation": 2969,
      "external id": 462, "external ts": 1638252373309665
    }
  },
  {
    "ph": "s", "id": 2969, "pid": 2765, "tid": 2765, "ts": 1638252373309673,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoH (Device -> Pinned)", "pid": 3, "tid": 7,
    "ts": 1638252373309854, "dur": 2,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 2975, "external id": 466,
      "bytes": 24576, "memory bandwidth (GB/s)": 8.533333333333333
    }
  },
  {
    "ph": "f", "id": 2975, "pid": 3, "tid": 7, "ts": 1638252373309854,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373309842, "dur": 10,
    "args": {
      "cbid": 41, "correlation": 2975,
      "external id": 466, "external ts": 1638252373309837
    }
  },
  {
    "ph": "s", "id": 2975, "pid": 2765, "tid": 2765, "ts": 1638252373309842,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::indexSelectLargeIndex<float, long, unsigned int, 2, 2, -2, true>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<long, unsigned int>, int, int, unsigned int, unsigned int, long)", "pid": 3, "tid": 7,
    "ts": 1638252373310183, "dur": 75,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2988, "external id": 470,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 8.0,
      "warps per SM": 32.0,
      "grid": [544, 1, 1],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2988, "pid": 3, "tid": 7, "ts": 1638252373310183,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373310160, "dur": 23,
    "args": {
      "cbid": 211, "correlation": 2988,
      "external id": 470, "external ts": 1638252373310053
    }
  },
  {
    "ph": "s", "id": 2988, "pid": 2765, "tid": 2765, "ts": 1638252373310160,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373310462, "dur": 73,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 2996, "external id": 478,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2996, "pid": 3, "tid": 7, "ts": 1638252373310462,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373310445, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 2996,
      "external id": 478, "external ts": 1638252373310424
    }
  },
  {
    "ph": "s", "id": 2996, "pid": 2765, "tid": 2765, "ts": 1638252373310445,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 3, "tid": 7,
    "ts": 1638252373310779, "dur": 87,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3018, "external id": 480,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3018, "pid": 3, "tid": 7, "ts": 1638252373310779,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373310762, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3018,
      "external id": 480, "external ts": 1638252373310561
    }
  },
  {
    "ph": "s", "id": 3018, "pid": 2765, "tid": 2765, "ts": 1638252373310762,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373311109, "dur": 133,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3032, "external id": 486,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3032, "pid": 3, "tid": 7, "ts": 1638252373311109,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373311093, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3032,
      "external id": 486, "external ts": 1638252373310922
    }
  },
  {
    "ph": "s", "id": 3032, "pid": 2765, "tid": 2765, "ts": 1638252373311093,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373311246, "dur": 68,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3034, "external id": 486,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3034, "pid": 3, "tid": 7, "ts": 1638252373311246,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373311109, "dur": 10,
    "args": {
      "cbid": 211, "correlation": 3034,
      "external id": 486, "external ts": 1638252373310922
    }
  },
  {
    "ph": "s", "id": 3034, "pid": 2765, "tid": 2765, "ts": 1638252373311109,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373311610, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 3041,
      "external id": 498, "external ts": 1638252373311582
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373311615, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 3042,
      "external id": 498, "external ts": 1638252373311582
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638252373311635, "dur": 0,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 3043, "external id": 498,
      "bytes": 2304, "memory bandwidth (GB/s)": 2.769230769230769
    }
  },
  {
    "ph": "f", "id": 3043, "pid": 3, "tid": 7, "ts": 1638252373311635,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373311621, "dur": 10,
    "args": {
      "cbid": 51, "correlation": 3043,
      "external id": 498, "external ts": 1638252373311582
    }
  },
  {
    "ph": "s", "id": 3043, "pid": 2765, "tid": 2765, "ts": 1638252373311621,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373311632, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 3044,
      "external id": 498, "external ts": 1638252373311582
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 3, "tid": 7,
    "ts": 1638252373311654, "dur": 1380,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3045, "external id": 498,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 3045, "pid": 3, "tid": 7, "ts": 1638252373311654,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373311638, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3045,
      "external id": 498, "external ts": 1638252373311582
    }
  },
  {
    "ph": "s", "id": 3045, "pid": 2765, "tid": 2765, "ts": 1638252373311638,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373311655, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3047,
      "external id": 498, "external ts": 1638252373311582
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373313038, "dur": 74,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3051, "external id": 501,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3051, "pid": 3, "tid": 7, "ts": 1638252373313038,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373311824, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3051,
      "external id": 501, "external ts": 1638252373311812
    }
  },
  {
    "ph": "s", "id": 3051, "pid": 2765, "tid": 2765, "ts": 1638252373311824,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373312354, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 3058,
      "external id": 511, "external ts": 1638252373312334
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373312358, "dur": 2,
    "args": {
      "cbid": 138, "correlation": 3059,
      "external id": 511, "external ts": 1638252373312334
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638252373313114, "dur": 1,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 3060, "external id": 511,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.2
    }
  },
  {
    "ph": "f", "id": 3060, "pid": 3, "tid": 7, "ts": 1638252373313114,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373312363, "dur": 9,
    "args": {
      "cbid": 51, "correlation": 3060,
      "external id": 511, "external ts": 1638252373312334
    }
  },
  {
    "ph": "s", "id": 3060, "pid": 2765, "tid": 2765, "ts": 1638252373312363,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373312372, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 3061,
      "external id": 511, "external ts": 1638252373312334
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 3, "tid": 7,
    "ts": 1638252373313118, "dur": 1376,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3062, "external id": 511,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 3062, "pid": 3, "tid": 7, "ts": 1638252373313118,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373312378, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3062,
      "external id": 511, "external ts": 1638252373312334
    }
  },
  {
    "ph": "s", "id": 3062, "pid": 2765, "tid": 2765, "ts": 1638252373312378,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373312393, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3064,
      "external id": 511, "external ts": 1638252373312334
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373314498, "dur": 74,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3068, "external id": 514,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3068, "pid": 3, "tid": 7, "ts": 1638252373314498,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373312557, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 3068,
      "external id": 514, "external ts": 1638252373312547
    }
  },
  {
    "ph": "s", "id": 3068, "pid": 2765, "tid": 2765, "ts": 1638252373312557,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373313103, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 3075,
      "external id": 524, "external ts": 1638252373313083
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373313107, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 3076,
      "external id": 524, "external ts": 1638252373313083
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638252373314575, "dur": 2,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 3077, "external id": 524,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.1428571428571428
    }
  },
  {
    "ph": "f", "id": 3077, "pid": 3, "tid": 7, "ts": 1638252373314575,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373313111, "dur": 9,
    "args": {
      "cbid": 51, "correlation": 3077,
      "external id": 524, "external ts": 1638252373313083
    }
  },
  {
    "ph": "s", "id": 3077, "pid": 2765, "tid": 2765, "ts": 1638252373313111,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373313121, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 3078,
      "external id": 524, "external ts": 1638252373313083
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 3, "tid": 7,
    "ts": 1638252373314578, "dur": 1377,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3079, "external id": 524,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 3079, "pid": 3, "tid": 7, "ts": 1638252373314578,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373313127, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 3079,
      "external id": 524, "external ts": 1638252373313083
    }
  },
  {
    "ph": "s", "id": 3079, "pid": 2765, "tid": 2765, "ts": 1638252373313127,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373313142, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3081,
      "external id": 524, "external ts": 1638252373313083
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373315959, "dur": 74,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3085, "external id": 527,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3085, "pid": 3, "tid": 7, "ts": 1638252373315959,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373313305, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 3085,
      "external id": 527, "external ts": 1638252373313295
    }
  },
  {
    "ph": "s", "id": 3085, "pid": 2765, "tid": 2765, "ts": 1638252373313305,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373316035, "dur": 75,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3093, "external id": 540,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3093, "pid": 3, "tid": 7, "ts": 1638252373316035,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373313924, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 3093,
      "external id": 540, "external ts": 1638252373313914
    }
  },
  {
    "ph": "s", "id": 3093, "pid": 2765, "tid": 2765, "ts": 1638252373313924,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373316113, "dur": 71,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3102, "external id": 549,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3102, "pid": 3, "tid": 7, "ts": 1638252373316113,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373314348, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 3102,
      "external id": 549, "external ts": 1638252373314341
    }
  },
  {
    "ph": "s", "id": 3102, "pid": 2765, "tid": 2765, "ts": 1638252373314348,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 3, "tid": 7,
    "ts": 1638252373316186, "dur": 282,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3112, "external id": 552,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3112, "pid": 3, "tid": 7, "ts": 1638252373316186,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373314557, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3112,
      "external id": 552, "external ts": 1638252373314495
    }
  },
  {
    "ph": "s", "id": 3112, "pid": 2765, "tid": 2765, "ts": 1638252373314557,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 3, "tid": 7,
    "ts": 1638252373316472, "dur": 9,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3118, "external id": 556,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3118, "pid": 3, "tid": 7, "ts": 1638252373316472,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373314771, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 3118,
      "external id": 556, "external ts": 1638252373314750
    }
  },
  {
    "ph": "s", "id": 3118, "pid": 2765, "tid": 2765, "ts": 1638252373314771,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 3, "tid": 7,
    "ts": 1638252373316483, "dur": 2,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3126, "external id": 561,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.029411765,
      "grid": [1, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 3126, "pid": 3, "tid": 7, "ts": 1638252373316483,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373315068, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 3126,
      "external id": 561, "external ts": 1638252373315040
    }
  },
  {
    "ph": "s", "id": 3126, "pid": 2765, "tid": 2765, "ts": 1638252373315068,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoD (Device -> Device)", "pid": 3, "tid": 7,
    "ts": 1638252373316487, "dur": 9,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 3133, "external id": 570,
      "bytes": 3538944, "memory bandwidth (GB/s)": 366.19867549668874
    }
  },
  {
    "ph": "f", "id": 3133, "pid": 3, "tid": 7, "ts": 1638252373316487,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373315498, "dur": 24,
    "args": {
      "cbid": 41, "correlation": 3133,
      "external id": 570, "external ts": 1638252373315492
    }
  },
  {
    "ph": "s", "id": 3133, "pid": 2765, "tid": 2765, "ts": 1638252373315498,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast>(int, at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373316499, "dur": 13,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3138, "external id": 571,
      "registers per thread": 24,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3138, "pid": 3, "tid": 7, "ts": 1638252373316499,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373315674, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 3138,
      "external id": 571, "external ts": 1638252373315569
    }
  },
  {
    "ph": "s", "id": 3138, "pid": 2765, "tid": 2765, "ts": 1638252373315674,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 3, false>(float*, float const*, int, int, int)", "pid": 3, "tid": 7,
    "ts": 1638252373316514, "dur": 20,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3145, "external id": 575,
      "registers per thread": 19,
      "shared memory": 0,
      "blocks per SM": 67.76471,
      "warps per SM": 271.05884,
      "grid": [4608, 1, 1],
      "block": [8, 16, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3145, "pid": 3, "tid": 7, "ts": 1638252373316514,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373315822, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3145,
      "external id": 575, "external ts": 1638252373315806
    }
  },
  {
    "ph": "s", "id": 3145, "pid": 2765, "tid": 2765, "ts": 1638252373315822,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 3, "tid": 7,
    "ts": 1638252373316536, "dur": 13,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3167, "external id": 577,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3167, "pid": 3, "tid": 7, "ts": 1638252373316536,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373316197, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3167,
      "external id": 577, "external ts": 1638252373315966
    }
  },
  {
    "ph": "s", "id": 3167, "pid": 2765, "tid": 2765, "ts": 1638252373316197,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373316791, "dur": 75,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3175, "external id": 593,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3175, "pid": 3, "tid": 7, "ts": 1638252373316791,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373316775, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3175,
      "external id": 593, "external ts": 1638252373316765
    }
  },
  {
    "ph": "s", "id": 3175, "pid": 2765, "tid": 2765, "ts": 1638252373316775,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 3, "tid": 7,
    "ts": 1638252373317007, "dur": 270,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3185, "external id": 596,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3185, "pid": 3, "tid": 7, "ts": 1638252373317007,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373316993, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 3185,
      "external id": 596, "external ts": 1638252373316928
    }
  },
  {
    "ph": "s", "id": 3185, "pid": 2765, "tid": 2765, "ts": 1638252373316993,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373317438, "dur": 72,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3194, "external id": 606,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3194, "pid": 3, "tid": 7, "ts": 1638252373317438,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373317423, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3194,
      "external id": 606, "external ts": 1638252373317415
    }
  },
  {
    "ph": "s", "id": 3194, "pid": 2765, "tid": 2765, "ts": 1638252373317423,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373317884, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 3203,
      "external id": 614, "external ts": 1638252373317863
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373317889, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 3204,
      "external id": 614, "external ts": 1638252373317863
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638252373317909, "dur": 1,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 3205, "external id": 614,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.5
    }
  },
  {
    "ph": "f", "id": 3205, "pid": 3, "tid": 7, "ts": 1638252373317909,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373317895, "dur": 10,
    "args": {
      "cbid": 51, "correlation": 3205,
      "external id": 614, "external ts": 1638252373317863
    }
  },
  {
    "ph": "s", "id": 3205, "pid": 2765, "tid": 2765, "ts": 1638252373317895,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373317906, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 3206,
      "external id": 614, "external ts": 1638252373317863
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 3, "tid": 7,
    "ts": 1638252373317927, "dur": 1379,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3207, "external id": 614,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 3207, "pid": 3, "tid": 7, "ts": 1638252373317927,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373317912, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3207,
      "external id": 614, "external ts": 1638252373317863
    }
  },
  {
    "ph": "s", "id": 3207, "pid": 2765, "tid": 2765, "ts": 1638252373317912,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373317928, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3209,
      "external id": 614, "external ts": 1638252373317863
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373319308, "dur": 75,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3213, "external id": 617,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3213, "pid": 3, "tid": 7, "ts": 1638252373319308,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373318097, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3213,
      "external id": 617, "external ts": 1638252373318086
    }
  },
  {
    "ph": "s", "id": 3213, "pid": 2765, "tid": 2765, "ts": 1638252373318097,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 3, "tid": 7,
    "ts": 1638252373319385, "dur": 87,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3235, "external id": 619,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3235, "pid": 3, "tid": 7, "ts": 1638252373319385,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373318458, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3235,
      "external id": 619, "external ts": 1638252373318226
    }
  },
  {
    "ph": "s", "id": 3235, "pid": 2765, "tid": 2765, "ts": 1638252373318458,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3> >(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>)", "pid": 3, "tid": 7,
    "ts": 1638252373319474, "dur": 104,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3241, "external id": 624,
      "registers per thread": 20,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3241, "pid": 3, "tid": 7, "ts": 1638252373319474,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373318580, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3241,
      "external id": 624, "external ts": 1638252373318565
    }
  },
  {
    "ph": "s", "id": 3241, "pid": 2765, "tid": 2765, "ts": 1638252373318580,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373319580, "dur": 124,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3255, "external id": 626,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3255, "pid": 3, "tid": 7, "ts": 1638252373319580,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373318894, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3255,
      "external id": 626, "external ts": 1638252373318725
    }
  },
  {
    "ph": "s", "id": 3255, "pid": 2765, "tid": 2765, "ts": 1638252373318894,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373319707, "dur": 69,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3257, "external id": 626,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3257, "pid": 3, "tid": 7, "ts": 1638252373319707,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373318909, "dur": 9,
    "args": {
      "cbid": 211, "correlation": 3257,
      "external id": 626, "external ts": 1638252373318725
    }
  },
  {
    "ph": "s", "id": 3257, "pid": 2765, "tid": 2765, "ts": 1638252373318909,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373319465, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 3264,
      "external id": 638, "external ts": 1638252373319444
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373319469, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 3265,
      "external id": 638, "external ts": 1638252373319444
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 3, "tid": 7,
    "ts": 1638252373319778, "dur": 5128,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3266, "external id": 638,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [48, 24, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 3266, "pid": 3, "tid": 7, "ts": 1638252373319778,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373319475, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 3266,
      "external id": 638, "external ts": 1638252373319444
    }
  },
  {
    "ph": "s", "id": 3266, "pid": 2765, "tid": 2765, "ts": 1638252373319475,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373324909, "dur": 281,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3271, "external id": 641,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3271, "pid": 3, "tid": 7, "ts": 1638252373324909,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373319716, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3271,
      "external id": 641, "external ts": 1638252373319704
    }
  },
  {
    "ph": "s", "id": 3271, "pid": 2765, "tid": 2765, "ts": 1638252373319716,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2> >(int, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>)", "pid": 3, "tid": 7,
    "ts": 1638252373325193, "dur": 280,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3277, "external id": 642,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3277, "pid": 3, "tid": 7, "ts": 1638252373325193,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373319832, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 3277,
      "external id": 642, "external ts": 1638252373319813
    }
  },
  {
    "ph": "s", "id": 3277, "pid": 2765, "tid": 2765, "ts": 1638252373319832,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 2765, "tid": 487929600,
    "ts": 1638252373320279, "dur": 4,
    "args": {
      "cbid": 151, "correlation": 3283,
      "external id": 0, "external ts": 1638252373402530
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 2765, "tid": 487929600,
    "ts": 1638252373320317, "dur": 1,
    "args": {
      "cbid": 151, "correlation": 3289,
      "external id": 0, "external ts": 1638252373402530
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373320358, "dur": 3,
    "args": {
      "cbid": 251, "correlation": 3296,
      "external id": 649, "external ts": 1638252373320334
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373320364, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 3297,
      "external id": 649, "external ts": 1638252373320334
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638252373325476, "dur": 1,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 3298, "external id": 649,
      "bytes": 1152, "memory bandwidth (GB/s)": 0.8181818181818182
    }
  },
  {
    "ph": "f", "id": 3298, "pid": 3, "tid": 7, "ts": 1638252373325476,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373320371, "dur": 10,
    "args": {
      "cbid": 51, "correlation": 3298,
      "external id": 649, "external ts": 1638252373320334
    }
  },
  {
    "ph": "s", "id": 3298, "pid": 2765, "tid": 2765, "ts": 1638252373320371,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 3, "tid": 7,
    "ts": 1638252373325478, "dur": 5160,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3299, "external id": 649,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [12, 24, 4],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 3299, "pid": 3, "tid": 7, "ts": 1638252373325478,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373320383, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3299,
      "external id": 649, "external ts": 1638252373320334
    }
  },
  {
    "ph": "s", "id": 3299, "pid": 2765, "tid": 2765, "ts": 1638252373320383,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373320399, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3301,
      "external id": 649, "external ts": 1638252373320334
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373330640, "dur": 74,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3305, "external id": 652,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3305, "pid": 3, "tid": 7, "ts": 1638252373330640,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373320570, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3305,
      "external id": 652, "external ts": 1638252373320559
    }
  },
  {
    "ph": "s", "id": 3305, "pid": 2765, "tid": 2765, "ts": 1638252373320570,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 3, "tid": 7,
    "ts": 1638252373330716, "dur": 84,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3327, "external id": 654,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3327, "pid": 3, "tid": 7, "ts": 1638252373330716,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373320953, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3327,
      "external id": 654, "external ts": 1638252373320721
    }
  },
  {
    "ph": "s", "id": 3327, "pid": 2765, "tid": 2765, "ts": 1638252373320953,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373330803, "dur": 133,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3341, "external id": 660,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3341, "pid": 3, "tid": 7, "ts": 1638252373330803,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373321266, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3341,
      "external id": 660, "external ts": 1638252373321109
    }
  },
  {
    "ph": "s", "id": 3341, "pid": 2765, "tid": 2765, "ts": 1638252373321266,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373330938, "dur": 69,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3343, "external id": 660,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3343, "pid": 3, "tid": 7, "ts": 1638252373330938,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373321281, "dur": 9,
    "args": {
      "cbid": 211, "correlation": 3343,
      "external id": 660, "external ts": 1638252373321109
    }
  },
  {
    "ph": "s", "id": 3343, "pid": 2765, "tid": 2765, "ts": 1638252373321281,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373321697, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 3350,
      "external id": 672, "external ts": 1638252373321677
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_32x32_sliced1x4_tn", "pid": 3, "tid": 7,
    "ts": 1638252373331009, "dur": 80,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3351, "external id": 672,
      "registers per thread": 86,
      "shared memory": 32768,
      "blocks per SM": 1.4117647,
      "warps per SM": 5.647059,
      "grid": [1, 96, 1],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 18
    }
  },
  {
    "ph": "f", "id": 3351, "pid": 3, "tid": 7, "ts": 1638252373331009,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373321702, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 3351,
      "external id": 672, "external ts": 1638252373321677
    }
  },
  {
    "ph": "s", "id": 3351, "pid": 2765, "tid": 2765, "ts": 1638252373321702,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 4, true>(float*, float const*, int, int, int)", "pid": 3, "tid": 7,
    "ts": 1638252373331093, "dur": 2,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3358, "external id": 680,
      "registers per thread": 18,
      "shared memory": 0,
      "blocks per SM": 2.8235295,
      "warps per SM": 11.294118,
      "grid": [192, 1, 1],
      "block": [16, 8, 1],
      "est. achieved occupancy %": 35
    }
  },
  {
    "ph": "f", "id": 3358, "pid": 3, "tid": 7, "ts": 1638252373331093,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373322050, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 3358,
      "external id": 680, "external ts": 1638252373322035
    }
  },
  {
    "ph": "s", "id": 3358, "pid": 2765, "tid": 2765, "ts": 1638252373322050,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::nll_loss_forward_reduce_cuda_kernel_2d<float, float, long>(float*, float*, float*, long*, float*, bool, int, int, int, long)", "pid": 3, "tid": 7,
    "ts": 1638252373331098, "dur": 58,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3365, "external id": 683,
      "registers per thread": 38,
      "shared memory": 256,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.014705882,
      "grid": [1, 1, 1],
      "block": [32, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 3365, "pid": 3, "tid": 7, "ts": 1638252373331098,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373322267, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3365,
      "external id": 683, "external ts": 1638252373322176
    }
  },
  {
    "ph": "s", "id": 3365, "pid": 2765, "tid": 2765, "ts": 1638252373322267,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373322542, "dur": 2,
    "args": {
      "cbid": 134, "correlation": 3370,
      "external id": 347, "external ts": 1638252373304432
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373322545, "dur": 2,
    "args": {
      "cbid": 135, "correlation": 3371,
      "external id": 347, "external ts": 1638252373304432
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373322551, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 3373,
      "external id": 347, "external ts": 1638252373304432
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373322557, "dur": 1,
    "args": {
      "cbid": 134, "correlation": 3377,
      "external id": 347, "external ts": 1638252373304432
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373322559, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3378,
      "external id": 347, "external ts": 1638252373304432
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 2765, "tid": 2765,
    "ts": 1638252373322617, "dur": 8542,
    "args": {
      "cbid": 165, "correlation": 3382,
      "external id": 347, "external ts": 1638252373304432
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373331864, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 3383,
      "external id": 690, "external ts": 1638252373331395
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2765, "tid": 2765,
    "ts": 1638252373331868, "dur": 2,
    "args": {
      "cbid": 136, "correlation": 3384,
      "external id": 690, "external ts": 1638252373331395
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373331872, "dur": 1,
    "args": {
      "cbid": 138, "correlation": 3385,
      "external id": 690, "external ts": 1638252373331395
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2765, "tid": 2765,
    "ts": 1638252373331874, "dur": 1,
    "args": {
      "cbid": 136, "correlation": 3386,
      "external id": 690, "external ts": 1638252373331395
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy HtoD (Pinned -> Device)", "pid": 3, "tid": 7,
    "ts": 1638252373332064, "dur": 2,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 3405, "external id": 700,
      "bytes": 24576, "memory bandwidth (GB/s)": 12.0
    }
  },
  {
    "ph": "f", "id": 3405, "pid": 3, "tid": 7, "ts": 1638252373332064,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373332040, "dur": 20,
    "args": {
      "cbid": 41, "correlation": 3405,
      "external id": 700, "external ts": 1638252373332032
    }
  },
  {
    "ph": "s", "id": 3405, "pid": 2765, "tid": 2765, "ts": 1638252373332040,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamSynchronize", "pid": 2765, "tid": 2765,
    "ts": 1638252373332062, "dur": 8,
    "args": {
      "cbid": 131, "correlation": 3406,
      "external id": 700, "external ts": 1638252373332032
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy HtoD (Pinned -> Device)", "pid": 3, "tid": 7,
    "ts": 1638252373332204, "dur": 3,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 3418, "external id": 704,
      "bytes": 24576, "memory bandwidth (GB/s)": 7.384615384615385
    }
  },
  {
    "ph": "f", "id": 3418, "pid": 3, "tid": 7, "ts": 1638252373332204,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373332184, "dur": 16,
    "args": {
      "cbid": 41, "correlation": 3418,
      "external id": 704, "external ts": 1638252373332179
    }
  },
  {
    "ph": "s", "id": 3418, "pid": 2765, "tid": 2765, "ts": 1638252373332184,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamSynchronize", "pid": 2765, "tid": 2765,
    "ts": 1638252373332201, "dur": 8,
    "args": {
      "cbid": 131, "correlation": 3419,
      "external id": 704, "external ts": 1638252373332179
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 2765, "tid": 2765,
    "ts": 1638252373332241, "dur": 4,
    "args": {
      "cbid": 165, "correlation": 3423,
      "external id": 690, "external ts": 1638252373331395
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373332529, "dur": 2,
    "args": {
      "cbid": 134, "correlation": 3429,
      "external id": 690, "external ts": 1638252373331395
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373332534, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3432,
      "external id": 690, "external ts": 1638252373331395
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamWaitEvent", "pid": 2765, "tid": 2765,
    "ts": 1638252373332540, "dur": 1,
    "args": {
      "cbid": 147, "correlation": 3435,
      "external id": 690, "external ts": 1638252373331395
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2765, "tid": 2765,
    "ts": 1638252373332545, "dur": 1,
    "args": {
      "cbid": 136, "correlation": 3438,
      "external id": 690, "external ts": 1638252373331395
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoH (Device -> Pinned)", "pid": 3, "tid": 7,
    "ts": 1638252373336143, "dur": 2,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 3447, "external id": 805,
      "bytes": 24576, "memory bandwidth (GB/s)": 8.533333333333333
    }
  },
  {
    "ph": "f", "id": 3447, "pid": 3, "tid": 7, "ts": 1638252373336143,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373336125, "dur": 16,
    "args": {
      "cbid": 41, "correlation": 3447,
      "external id": 805, "external ts": 1638252373336116
    }
  },
  {
    "ph": "s", "id": 3447, "pid": 2765, "tid": 2765, "ts": 1638252373336125,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoH (Device -> Pinned)", "pid": 3, "tid": 7,
    "ts": 1638252373336302, "dur": 2,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 3453, "external id": 809,
      "bytes": 24576, "memory bandwidth (GB/s)": 8.533333333333333
    }
  },
  {
    "ph": "f", "id": 3453, "pid": 3, "tid": 7, "ts": 1638252373336302,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373336289, "dur": 10,
    "args": {
      "cbid": 41, "correlation": 3453,
      "external id": 809, "external ts": 1638252373336284
    }
  },
  {
    "ph": "s", "id": 3453, "pid": 2765, "tid": 2765, "ts": 1638252373336289,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::indexSelectLargeIndex<float, long, unsigned int, 2, 2, -2, true>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<long, unsigned int>, int, int, unsigned int, unsigned int, long)", "pid": 3, "tid": 7,
    "ts": 1638252373336977, "dur": 74,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3466, "external id": 813,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 8.0,
      "warps per SM": 32.0,
      "grid": [544, 1, 1],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3466, "pid": 3, "tid": 7, "ts": 1638252373336977,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373336952, "dur": 24,
    "args": {
      "cbid": 211, "correlation": 3466,
      "external id": 813, "external ts": 1638252373336841
    }
  },
  {
    "ph": "s", "id": 3466, "pid": 2765, "tid": 2765, "ts": 1638252373336952,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373337258, "dur": 73,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3474, "external id": 821,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3474, "pid": 3, "tid": 7, "ts": 1638252373337258,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373337240, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 3474,
      "external id": 821, "external ts": 1638252373337217
    }
  },
  {
    "ph": "s", "id": 3474, "pid": 2765, "tid": 2765, "ts": 1638252373337240,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 3, "tid": 7,
    "ts": 1638252373337557, "dur": 85,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3496, "external id": 823,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3496, "pid": 3, "tid": 7, "ts": 1638252373337557,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373337542, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3496,
      "external id": 823, "external ts": 1638252373337352
    }
  },
  {
    "ph": "s", "id": 3496, "pid": 2765, "tid": 2765, "ts": 1638252373337542,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373337874, "dur": 134,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3510, "external id": 829,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3510, "pid": 3, "tid": 7, "ts": 1638252373337874,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373337859, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3510,
      "external id": 829, "external ts": 1638252373337695
    }
  },
  {
    "ph": "s", "id": 3510, "pid": 2765, "tid": 2765, "ts": 1638252373337859,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373338011, "dur": 67,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3512, "external id": 829,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3512, "pid": 3, "tid": 7, "ts": 1638252373338011,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373337875, "dur": 10,
    "args": {
      "cbid": 211, "correlation": 3512,
      "external id": 829, "external ts": 1638252373337695
    }
  },
  {
    "ph": "s", "id": 3512, "pid": 2765, "tid": 2765, "ts": 1638252373337875,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373338353, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 3519,
      "external id": 841, "external ts": 1638252373338332
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373338358, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 3520,
      "external id": 841, "external ts": 1638252373338332
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638252373338376, "dur": 1,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 3521, "external id": 841,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.3846153846153846
    }
  },
  {
    "ph": "f", "id": 3521, "pid": 3, "tid": 7, "ts": 1638252373338376,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373338363, "dur": 9,
    "args": {
      "cbid": 51, "correlation": 3521,
      "external id": 841, "external ts": 1638252373338332
    }
  },
  {
    "ph": "s", "id": 3521, "pid": 2765, "tid": 2765, "ts": 1638252373338363,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373338374, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 3522,
      "external id": 841, "external ts": 1638252373338332
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 3, "tid": 7,
    "ts": 1638252373338395, "dur": 1382,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3523, "external id": 841,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 3523, "pid": 3, "tid": 7, "ts": 1638252373338395,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373338380, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3523,
      "external id": 841, "external ts": 1638252373338332
    }
  },
  {
    "ph": "s", "id": 3523, "pid": 2765, "tid": 2765, "ts": 1638252373338380,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373338396, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3525,
      "external id": 841, "external ts": 1638252373338332
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373339779, "dur": 75,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3529, "external id": 844,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3529, "pid": 3, "tid": 7, "ts": 1638252373339779,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373338563, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3529,
      "external id": 844, "external ts": 1638252373338550
    }
  },
  {
    "ph": "s", "id": 3529, "pid": 2765, "tid": 2765, "ts": 1638252373338563,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373339084, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 3536,
      "external id": 854, "external ts": 1638252373339064
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373339088, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 3537,
      "external id": 854, "external ts": 1638252373339064
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638252373339857, "dur": 2,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 3538, "external id": 854,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.125
    }
  },
  {
    "ph": "f", "id": 3538, "pid": 3, "tid": 7, "ts": 1638252373339857,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373339092, "dur": 9,
    "args": {
      "cbid": 51, "correlation": 3538,
      "external id": 854, "external ts": 1638252373339064
    }
  },
  {
    "ph": "s", "id": 3538, "pid": 2765, "tid": 2765, "ts": 1638252373339092,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373339102, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 3539,
      "external id": 854, "external ts": 1638252373339064
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 3, "tid": 7,
    "ts": 1638252373339861, "dur": 1376,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3540, "external id": 854,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 3540, "pid": 3, "tid": 7, "ts": 1638252373339861,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373339107, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 3540,
      "external id": 854, "external ts": 1638252373339064
    }
  },
  {
    "ph": "s", "id": 3540, "pid": 2765, "tid": 2765, "ts": 1638252373339107,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373339122, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3542,
      "external id": 854, "external ts": 1638252373339064
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373341240, "dur": 75,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3546, "external id": 857,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3546, "pid": 3, "tid": 7, "ts": 1638252373341240,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373339284, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 3546,
      "external id": 857, "external ts": 1638252373339273
    }
  },
  {
    "ph": "s", "id": 3546, "pid": 2765, "tid": 2765, "ts": 1638252373339284,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373339798, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 3553,
      "external id": 867, "external ts": 1638252373339778
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373339802, "dur": 2,
    "args": {
      "cbid": 138, "correlation": 3554,
      "external id": 867, "external ts": 1638252373339778
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638252373341317, "dur": 1,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 3555, "external id": 867,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.180327868852459
    }
  },
  {
    "ph": "f", "id": 3555, "pid": 3, "tid": 7, "ts": 1638252373341317,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373339806, "dur": 9,
    "args": {
      "cbid": 51, "correlation": 3555,
      "external id": 867, "external ts": 1638252373339778
    }
  },
  {
    "ph": "s", "id": 3555, "pid": 2765, "tid": 2765, "ts": 1638252373339806,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373339816, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 3556,
      "external id": 867, "external ts": 1638252373339778
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 3, "tid": 7,
    "ts": 1638252373341321, "dur": 1376,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3557, "external id": 867,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 3557, "pid": 3, "tid": 7, "ts": 1638252373341321,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373339821, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 3557,
      "external id": 867, "external ts": 1638252373339778
    }
  },
  {
    "ph": "s", "id": 3557, "pid": 2765, "tid": 2765, "ts": 1638252373339821,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373339836, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3559,
      "external id": 867, "external ts": 1638252373339778
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373342701, "dur": 74,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3563, "external id": 870,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3563, "pid": 3, "tid": 7, "ts": 1638252373342701,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373340003, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 3563,
      "external id": 870, "external ts": 1638252373339994
    }
  },
  {
    "ph": "s", "id": 3563, "pid": 2765, "tid": 2765, "ts": 1638252373340003,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373342777, "dur": 74,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3571, "external id": 883,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3571, "pid": 3, "tid": 7, "ts": 1638252373342777,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373340624, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 3571,
      "external id": 883, "external ts": 1638252373340613
    }
  },
  {
    "ph": "s", "id": 3571, "pid": 2765, "tid": 2765, "ts": 1638252373340624,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373342853, "dur": 71,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3580, "external id": 892,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3580, "pid": 3, "tid": 7, "ts": 1638252373342853,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373341052, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 3580,
      "external id": 892, "external ts": 1638252373341044
    }
  },
  {
    "ph": "s", "id": 3580, "pid": 2765, "tid": 2765, "ts": 1638252373341052,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 3, "tid": 7,
    "ts": 1638252373342928, "dur": 282,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3590, "external id": 895,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3590, "pid": 3, "tid": 7, "ts": 1638252373342928,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373341268, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 3590,
      "external id": 895, "external ts": 1638252373341204
    }
  },
  {
    "ph": "s", "id": 3590, "pid": 2765, "tid": 2765, "ts": 1638252373341268,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 3, "tid": 7,
    "ts": 1638252373343213, "dur": 8,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3596, "external id": 899,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3596, "pid": 3, "tid": 7, "ts": 1638252373343213,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373341466, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3596,
      "external id": 899, "external ts": 1638252373341446
    }
  },
  {
    "ph": "s", "id": 3596, "pid": 2765, "tid": 2765, "ts": 1638252373341466,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 3, "tid": 7,
    "ts": 1638252373343224, "dur": 1,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3604, "external id": 904,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.029411765,
      "grid": [1, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 3604, "pid": 3, "tid": 7, "ts": 1638252373343224,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373341777, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 3604,
      "external id": 904, "external ts": 1638252373341748
    }
  },
  {
    "ph": "s", "id": 3604, "pid": 2765, "tid": 2765, "ts": 1638252373341777,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoD (Device -> Device)", "pid": 3, "tid": 7,
    "ts": 1638252373343228, "dur": 9,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 3611, "external id": 913,
      "bytes": 3538944, "memory bandwidth (GB/s)": 366.19867549668874
    }
  },
  {
    "ph": "f", "id": 3611, "pid": 3, "tid": 7, "ts": 1638252373343228,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373342204, "dur": 24,
    "args": {
      "cbid": 41, "correlation": 3611,
      "external id": 913, "external ts": 1638252373342198
    }
  },
  {
    "ph": "s", "id": 3611, "pid": 2765, "tid": 2765, "ts": 1638252373342204,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast>(int, at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373343240, "dur": 12,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3616, "external id": 914,
      "registers per thread": 24,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3616, "pid": 3, "tid": 7, "ts": 1638252373343240,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373342375, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3616,
      "external id": 914, "external ts": 1638252373342280
    }
  },
  {
    "ph": "s", "id": 3616, "pid": 2765, "tid": 2765, "ts": 1638252373342375,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 3, false>(float*, float const*, int, int, int)", "pid": 3, "tid": 7,
    "ts": 1638252373343255, "dur": 20,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3623, "external id": 918,
      "registers per thread": 19,
      "shared memory": 0,
      "blocks per SM": 67.76471,
      "warps per SM": 271.05884,
      "grid": [4608, 1, 1],
      "block": [8, 16, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3623, "pid": 3, "tid": 7, "ts": 1638252373343255,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373342516, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3623,
      "external id": 918, "external ts": 1638252373342501
    }
  },
  {
    "ph": "s", "id": 3623, "pid": 2765, "tid": 2765, "ts": 1638252373342516,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 3, "tid": 7,
    "ts": 1638252373343277, "dur": 13,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3645, "external id": 920,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3645, "pid": 3, "tid": 7, "ts": 1638252373343277,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373342900, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3645,
      "external id": 920, "external ts": 1638252373342661
    }
  },
  {
    "ph": "s", "id": 3645, "pid": 2765, "tid": 2765, "ts": 1638252373342900,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373343481, "dur": 74,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3653, "external id": 936,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3653, "pid": 3, "tid": 7, "ts": 1638252373343481,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373343466, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3653,
      "external id": 936, "external ts": 1638252373343456
    }
  },
  {
    "ph": "s", "id": 3653, "pid": 2765, "tid": 2765, "ts": 1638252373343466,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 3, "tid": 7,
    "ts": 1638252373343704, "dur": 271,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3663, "external id": 939,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3663, "pid": 3, "tid": 7, "ts": 1638252373343704,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373343689, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 3663,
      "external id": 939, "external ts": 1638252373343626
    }
  },
  {
    "ph": "s", "id": 3663, "pid": 2765, "tid": 2765, "ts": 1638252373343689,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373344140, "dur": 72,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3672, "external id": 949,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3672, "pid": 3, "tid": 7, "ts": 1638252373344140,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373344126, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3672,
      "external id": 949, "external ts": 1638252373344117
    }
  },
  {
    "ph": "s", "id": 3672, "pid": 2765, "tid": 2765, "ts": 1638252373344126,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373344579, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 3681,
      "external id": 957, "external ts": 1638252373344555
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373344584, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 3682,
      "external id": 957, "external ts": 1638252373344555
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638252373344604, "dur": 0,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 3683, "external id": 957,
      "bytes": 2304, "memory bandwidth (GB/s)": 4.235294117647059
    }
  },
  {
    "ph": "f", "id": 3683, "pid": 3, "tid": 7, "ts": 1638252373344604,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373344590, "dur": 16,
    "args": {
      "cbid": 51, "correlation": 3683,
      "external id": 957, "external ts": 1638252373344555
    }
  },
  {
    "ph": "s", "id": 3683, "pid": 2765, "tid": 2765, "ts": 1638252373344590,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373344607, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 3684,
      "external id": 957, "external ts": 1638252373344555
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 3, "tid": 7,
    "ts": 1638252373344628, "dur": 1378,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3685, "external id": 957,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 3685, "pid": 3, "tid": 7, "ts": 1638252373344628,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373344613, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3685,
      "external id": 957, "external ts": 1638252373344555
    }
  },
  {
    "ph": "s", "id": 3685, "pid": 2765, "tid": 2765, "ts": 1638252373344613,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373344629, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3687,
      "external id": 957, "external ts": 1638252373344555
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373346009, "dur": 75,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3691, "external id": 960,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3691, "pid": 3, "tid": 7, "ts": 1638252373346009,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373344798, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3691,
      "external id": 960, "external ts": 1638252373344786
    }
  },
  {
    "ph": "s", "id": 3691, "pid": 2765, "tid": 2765, "ts": 1638252373344798,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 3, "tid": 7,
    "ts": 1638252373346086, "dur": 86,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3713, "external id": 962,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3713, "pid": 3, "tid": 7, "ts": 1638252373346086,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373345158, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3713,
      "external id": 962, "external ts": 1638252373344927
    }
  },
  {
    "ph": "s", "id": 3713, "pid": 2765, "tid": 2765, "ts": 1638252373345158,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3> >(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>)", "pid": 3, "tid": 7,
    "ts": 1638252373346175, "dur": 103,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3719, "external id": 967,
      "registers per thread": 20,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3719, "pid": 3, "tid": 7, "ts": 1638252373346175,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373345278, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 3719,
      "external id": 967, "external ts": 1638252373345262
    }
  },
  {
    "ph": "s", "id": 3719, "pid": 2765, "tid": 2765, "ts": 1638252373345278,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373346281, "dur": 125,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3733, "external id": 969,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3733, "pid": 3, "tid": 7, "ts": 1638252373346281,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373345583, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3733,
      "external id": 969, "external ts": 1638252373345409
    }
  },
  {
    "ph": "s", "id": 3733, "pid": 2765, "tid": 2765, "ts": 1638252373345583,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373346408, "dur": 68,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3735, "external id": 969,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3735, "pid": 3, "tid": 7, "ts": 1638252373346408,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373345598, "dur": 17,
    "args": {
      "cbid": 211, "correlation": 3735,
      "external id": 969, "external ts": 1638252373345409
    }
  },
  {
    "ph": "s", "id": 3735, "pid": 2765, "tid": 2765, "ts": 1638252373345598,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373346096, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 3742,
      "external id": 981, "external ts": 1638252373346076
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373346100, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 3743,
      "external id": 981, "external ts": 1638252373346076
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 3, "tid": 7,
    "ts": 1638252373346479, "dur": 5128,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3744, "external id": 981,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [48, 24, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 3744, "pid": 3, "tid": 7, "ts": 1638252373346479,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373346105, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3744,
      "external id": 981, "external ts": 1638252373346076
    }
  },
  {
    "ph": "s", "id": 3744, "pid": 2765, "tid": 2765, "ts": 1638252373346105,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373351610, "dur": 280,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3749, "external id": 984,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3749, "pid": 3, "tid": 7, "ts": 1638252373351610,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373346297, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 3749,
      "external id": 984, "external ts": 1638252373346286
    }
  },
  {
    "ph": "s", "id": 3749, "pid": 2765, "tid": 2765, "ts": 1638252373346297,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2> >(int, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>)", "pid": 3, "tid": 7,
    "ts": 1638252373351893, "dur": 280,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3755, "external id": 985,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3755, "pid": 3, "tid": 7, "ts": 1638252373351893,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373346396, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3755,
      "external id": 985, "external ts": 1638252373346378
    }
  },
  {
    "ph": "s", "id": 3755, "pid": 2765, "tid": 2765, "ts": 1638252373346396,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 2765, "tid": 487929600,
    "ts": 1638252373346952, "dur": 4,
    "args": {
      "cbid": 151, "correlation": 3761,
      "external id": 0, "external ts": 1638252373402530
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373346975, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 3768,
      "external id": 992, "external ts": 1638252373346953
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373346979, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 3769,
      "external id": 992, "external ts": 1638252373346953
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 2765, "tid": 487929600,
    "ts": 1638252373346991, "dur": 1,
    "args": {
      "cbid": 151, "correlation": 3774,
      "external id": 0, "external ts": 1638252373402530
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638252373352176, "dur": 2,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 3770, "external id": 992,
      "bytes": 1152, "memory bandwidth (GB/s)": 0.5714285714285714
    }
  },
  {
    "ph": "f", "id": 3770, "pid": 3, "tid": 7, "ts": 1638252373352176,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373346985, "dur": 12,
    "args": {
      "cbid": 51, "correlation": 3770,
      "external id": 992, "external ts": 1638252373346953
    }
  },
  {
    "ph": "s", "id": 3770, "pid": 2765, "tid": 2765, "ts": 1638252373346985,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 3, "tid": 7,
    "ts": 1638252373352179, "dur": 5155,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3777, "external id": 992,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [12, 24, 4],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 3777, "pid": 3, "tid": 7, "ts": 1638252373352179,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373346999, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3777,
      "external id": 992, "external ts": 1638252373346953
    }
  },
  {
    "ph": "s", "id": 3777, "pid": 2765, "tid": 2765, "ts": 1638252373346999,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373347015, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3779,
      "external id": 992, "external ts": 1638252373346953
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373357337, "dur": 75,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3783, "external id": 995,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3783, "pid": 3, "tid": 7, "ts": 1638252373357337,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373347245, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3783,
      "external id": 995, "external ts": 1638252373347233
    }
  },
  {
    "ph": "s", "id": 3783, "pid": 2765, "tid": 2765, "ts": 1638252373347245,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 3, "tid": 7,
    "ts": 1638252373357414, "dur": 85,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3805, "external id": 997,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3805, "pid": 3, "tid": 7, "ts": 1638252373357414,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373347630, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3805,
      "external id": 997, "external ts": 1638252373347389
    }
  },
  {
    "ph": "s", "id": 3805, "pid": 2765, "tid": 2765, "ts": 1638252373347630,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373357501, "dur": 133,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3819, "external id": 1003,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3819, "pid": 3, "tid": 7, "ts": 1638252373357501,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373347935, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3819,
      "external id": 1003, "external ts": 1638252373347782
    }
  },
  {
    "ph": "s", "id": 3819, "pid": 2765, "tid": 2765, "ts": 1638252373347935,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373357637, "dur": 68,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3821, "external id": 1003,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3821, "pid": 3, "tid": 7, "ts": 1638252373357637,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373347950, "dur": 9,
    "args": {
      "cbid": 211, "correlation": 3821,
      "external id": 1003, "external ts": 1638252373347782
    }
  },
  {
    "ph": "s", "id": 3821, "pid": 2765, "tid": 2765, "ts": 1638252373347950,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373348367, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 3828,
      "external id": 1015, "external ts": 1638252373348347
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_32x32_sliced1x4_tn", "pid": 3, "tid": 7,
    "ts": 1638252373357708, "dur": 80,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3829, "external id": 1015,
      "registers per thread": 86,
      "shared memory": 32768,
      "blocks per SM": 1.4117647,
      "warps per SM": 5.647059,
      "grid": [1, 96, 1],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 18
    }
  },
  {
    "ph": "f", "id": 3829, "pid": 3, "tid": 7, "ts": 1638252373357708,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373348372, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3829,
      "external id": 1015, "external ts": 1638252373348347
    }
  },
  {
    "ph": "s", "id": 3829, "pid": 2765, "tid": 2765, "ts": 1638252373348372,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 4, true>(float*, float const*, int, int, int)", "pid": 3, "tid": 7,
    "ts": 1638252373357791, "dur": 2,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3836, "external id": 1023,
      "registers per thread": 18,
      "shared memory": 0,
      "blocks per SM": 2.8235295,
      "warps per SM": 11.294118,
      "grid": [192, 1, 1],
      "block": [16, 8, 1],
      "est. achieved occupancy %": 35
    }
  },
  {
    "ph": "f", "id": 3836, "pid": 3, "tid": 7, "ts": 1638252373357791,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373348729, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3836,
      "external id": 1023, "external ts": 1638252373348713
    }
  },
  {
    "ph": "s", "id": 3836, "pid": 2765, "tid": 2765, "ts": 1638252373348729,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::nll_loss_forward_reduce_cuda_kernel_2d<float, float, long>(float*, float*, float*, long*, float*, bool, int, int, int, long)", "pid": 3, "tid": 7,
    "ts": 1638252373357795, "dur": 59,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3843, "external id": 1026,
      "registers per thread": 38,
      "shared memory": 256,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.014705882,
      "grid": [1, 1, 1],
      "block": [32, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 3843, "pid": 3, "tid": 7, "ts": 1638252373357795,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373348944, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3843,
      "external id": 1026, "external ts": 1638252373348853
    }
  },
  {
    "ph": "s", "id": 3843, "pid": 2765, "tid": 2765, "ts": 1638252373348944,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373349211, "dur": 2,
    "args": {
      "cbid": 134, "correlation": 3848,
      "external id": 690, "external ts": 1638252373331395
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373349215, "dur": 2,
    "args": {
      "cbid": 135, "correlation": 3849,
      "external id": 690, "external ts": 1638252373331395
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373349220, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 3851,
      "external id": 690, "external ts": 1638252373331395
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373349228, "dur": 0,
    "args": {
      "cbid": 134, "correlation": 3855,
      "external id": 690, "external ts": 1638252373331395
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373349229, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3856,
      "external id": 690, "external ts": 1638252373331395
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 2765, "tid": 2765,
    "ts": 1638252373349273, "dur": 8583,
    "args": {
      "cbid": 165, "correlation": 3860,
      "external id": 690, "external ts": 1638252373331395
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy HtoD (Pinned -> Device)", "pid": 3, "tid": 7,
    "ts": 1638252373358805, "dur": 2,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 3871, "external id": 1043,
      "bytes": 24576, "memory bandwidth (GB/s)": 12.0
    }
  },
  {
    "ph": "f", "id": 3871, "pid": 3, "tid": 7, "ts": 1638252373358805,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373358781, "dur": 21,
    "args": {
      "cbid": 41, "correlation": 3871,
      "external id": 1043, "external ts": 1638252373358772
    }
  },
  {
    "ph": "s", "id": 3871, "pid": 2765, "tid": 2765, "ts": 1638252373358781,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamSynchronize", "pid": 2765, "tid": 2765,
    "ts": 1638252373358803, "dur": 8,
    "args": {
      "cbid": 131, "correlation": 3872,
      "external id": 1043, "external ts": 1638252373358772
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy HtoD (Pinned -> Device)", "pid": 3, "tid": 7,
    "ts": 1638252373358938, "dur": 2,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 3884, "external id": 1047,
      "bytes": 24576, "memory bandwidth (GB/s)": 11.462686567164178
    }
  },
  {
    "ph": "f", "id": 3884, "pid": 3, "tid": 7, "ts": 1638252373358938,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373358919, "dur": 14,
    "args": {
      "cbid": 41, "correlation": 3884,
      "external id": 1047, "external ts": 1638252373358915
    }
  },
  {
    "ph": "s", "id": 3884, "pid": 2765, "tid": 2765, "ts": 1638252373358919,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamSynchronize", "pid": 2765, "tid": 2765,
    "ts": 1638252373358935, "dur": 8,
    "args": {
      "cbid": 131, "correlation": 3885,
      "external id": 1047, "external ts": 1638252373358915
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 2765, "tid": 2765,
    "ts": 1638252373358977, "dur": 4,
    "args": {
      "cbid": 165, "correlation": 3889,
      "external id": 1033, "external ts": 1638252373358091
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373359243, "dur": 2,
    "args": {
      "cbid": 134, "correlation": 3895,
      "external id": 1033, "external ts": 1638252373358091
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373359247, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3898,
      "external id": 1033, "external ts": 1638252373358091
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamWaitEvent", "pid": 2765, "tid": 2765,
    "ts": 1638252373359254, "dur": 1,
    "args": {
      "cbid": 147, "correlation": 3901,
      "external id": 1033, "external ts": 1638252373358091
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2765, "tid": 2765,
    "ts": 1638252373359259, "dur": 1,
    "args": {
      "cbid": 136, "correlation": 3904,
      "external id": 1033, "external ts": 1638252373358091
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373362779, "dur": 5,
    "args": {
      "cbid": 138, "correlation": 3909,
      "external id": 1147, "external ts": 1638252373362776
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2765, "tid": 2765,
    "ts": 1638252373362785, "dur": 2,
    "args": {
      "cbid": 136, "correlation": 3910,
      "external id": 1147, "external ts": 1638252373362776
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373362788, "dur": 1,
    "args": {
      "cbid": 138, "correlation": 3911,
      "external id": 1147, "external ts": 1638252373362776
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2765, "tid": 2765,
    "ts": 1638252373362790, "dur": 1,
    "args": {
      "cbid": 136, "correlation": 3912,
      "external id": 1147, "external ts": 1638252373362776
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoH (Device -> Pinned)", "pid": 3, "tid": 7,
    "ts": 1638252373362855, "dur": 2,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 3917, "external id": 1148,
      "bytes": 24576, "memory bandwidth (GB/s)": 8.629213483146067
    }
  },
  {
    "ph": "f", "id": 3917, "pid": 3, "tid": 7, "ts": 1638252373362855,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373362838, "dur": 15,
    "args": {
      "cbid": 41, "correlation": 3917,
      "external id": 1148, "external ts": 1638252373362830
    }
  },
  {
    "ph": "s", "id": 3917, "pid": 2765, "tid": 2765, "ts": 1638252373362838,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoH (Device -> Pinned)", "pid": 3, "tid": 7,
    "ts": 1638252373363018, "dur": 2,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 3923, "external id": 1152,
      "bytes": 24576, "memory bandwidth (GB/s)": 8.533333333333333
    }
  },
  {
    "ph": "f", "id": 3923, "pid": 3, "tid": 7, "ts": 1638252373363018,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373363006, "dur": 10,
    "args": {
      "cbid": 41, "correlation": 3923,
      "external id": 1152, "external ts": 1638252373363001
    }
  },
  {
    "ph": "s", "id": 3923, "pid": 2765, "tid": 2765, "ts": 1638252373363006,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::indexSelectLargeIndex<float, long, unsigned int, 2, 2, -2, true>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<long, unsigned int>, int, int, unsigned int, unsigned int, long)", "pid": 3, "tid": 7,
    "ts": 1638252373363343, "dur": 77,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3936, "external id": 1156,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 8.0,
      "warps per SM": 32.0,
      "grid": [544, 1, 1],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3936, "pid": 3, "tid": 7, "ts": 1638252373363343,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373363322, "dur": 21,
    "args": {
      "cbid": 211, "correlation": 3936,
      "external id": 1156, "external ts": 1638252373363213
    }
  },
  {
    "ph": "s", "id": 3936, "pid": 2765, "tid": 2765, "ts": 1638252373363322,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373363640, "dur": 73,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3944, "external id": 1164,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3944, "pid": 3, "tid": 7, "ts": 1638252373363640,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373363623, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 3944,
      "external id": 1164, "external ts": 1638252373363593
    }
  },
  {
    "ph": "s", "id": 3944, "pid": 2765, "tid": 2765, "ts": 1638252373363623,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 3, "tid": 7,
    "ts": 1638252373363945, "dur": 84,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3966, "external id": 1166,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3966, "pid": 3, "tid": 7, "ts": 1638252373363945,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373363929, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3966,
      "external id": 1166, "external ts": 1638252373363738
    }
  },
  {
    "ph": "s", "id": 3966, "pid": 2765, "tid": 2765, "ts": 1638252373363929,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373364271, "dur": 133,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3980, "external id": 1172,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3980, "pid": 3, "tid": 7, "ts": 1638252373364271,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373364255, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3980,
      "external id": 1172, "external ts": 1638252373364080
    }
  },
  {
    "ph": "s", "id": 3980, "pid": 2765, "tid": 2765, "ts": 1638252373364255,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373364406, "dur": 68,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3982, "external id": 1172,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3982, "pid": 3, "tid": 7, "ts": 1638252373364406,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373364270, "dur": 10,
    "args": {
      "cbid": 211, "correlation": 3982,
      "external id": 1172, "external ts": 1638252373364080
    }
  },
  {
    "ph": "s", "id": 3982, "pid": 2765, "tid": 2765, "ts": 1638252373364270,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373364781, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 3989,
      "external id": 1184, "external ts": 1638252373364759
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373364786, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 3990,
      "external id": 1184, "external ts": 1638252373364759
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638252373364805, "dur": 0,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 3991, "external id": 1184,
      "bytes": 2304, "memory bandwidth (GB/s)": 3.130434782608696
    }
  },
  {
    "ph": "f", "id": 3991, "pid": 3, "tid": 7, "ts": 1638252373364805,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373364791, "dur": 9,
    "args": {
      "cbid": 51, "correlation": 3991,
      "external id": 1184, "external ts": 1638252373364759
    }
  },
  {
    "ph": "s", "id": 3991, "pid": 2765, "tid": 2765, "ts": 1638252373364791,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373364802, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 3992,
      "external id": 1184, "external ts": 1638252373364759
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 3, "tid": 7,
    "ts": 1638252373364824, "dur": 1382,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3993, "external id": 1184,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 3993, "pid": 3, "tid": 7, "ts": 1638252373364824,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373364809, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3993,
      "external id": 1184, "external ts": 1638252373364759
    }
  },
  {
    "ph": "s", "id": 3993, "pid": 2765, "tid": 2765, "ts": 1638252373364809,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373364825, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3995,
      "external id": 1184, "external ts": 1638252373364759
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373366208, "dur": 75,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3999, "external id": 1187,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3999, "pid": 3, "tid": 7, "ts": 1638252373366208,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373364992, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3999,
      "external id": 1187, "external ts": 1638252373364979
    }
  },
  {
    "ph": "s", "id": 3999, "pid": 2765, "tid": 2765, "ts": 1638252373364992,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373365529, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4006,
      "external id": 1197, "external ts": 1638252373365508
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373365533, "dur": 2,
    "args": {
      "cbid": 138, "correlation": 4007,
      "external id": 1197, "external ts": 1638252373365508
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638252373366286, "dur": 0,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 4008, "external id": 1197,
      "bytes": 2304, "memory bandwidth (GB/s)": 4.0
    }
  },
  {
    "ph": "f", "id": 4008, "pid": 3, "tid": 7, "ts": 1638252373366286,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373365538, "dur": 8,
    "args": {
      "cbid": 51, "correlation": 4008,
      "external id": 1197, "external ts": 1638252373365508
    }
  },
  {
    "ph": "s", "id": 4008, "pid": 2765, "tid": 2765, "ts": 1638252373365538,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373365547, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4009,
      "external id": 1197, "external ts": 1638252373365508
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 3, "tid": 7,
    "ts": 1638252373366288, "dur": 1377,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4010, "external id": 1197,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4010, "pid": 3, "tid": 7, "ts": 1638252373366288,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373365553, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4010,
      "external id": 1197, "external ts": 1638252373365508
    }
  },
  {
    "ph": "s", "id": 4010, "pid": 2765, "tid": 2765, "ts": 1638252373365553,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373365568, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4012,
      "external id": 1197, "external ts": 1638252373365508
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373367668, "dur": 74,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4016, "external id": 1200,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4016, "pid": 3, "tid": 7, "ts": 1638252373367668,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373365743, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4016,
      "external id": 1200, "external ts": 1638252373365732
    }
  },
  {
    "ph": "s", "id": 4016, "pid": 2765, "tid": 2765, "ts": 1638252373365743,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373366268, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4023,
      "external id": 1210, "external ts": 1638252373366248
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373366272, "dur": 2,
    "args": {
      "cbid": 138, "correlation": 4024,
      "external id": 1210, "external ts": 1638252373366248
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638252373367744, "dur": 2,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 4025, "external id": 1210,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.1428571428571428
    }
  },
  {
    "ph": "f", "id": 4025, "pid": 3, "tid": 7, "ts": 1638252373367744,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373366276, "dur": 8,
    "args": {
      "cbid": 51, "correlation": 4025,
      "external id": 1210, "external ts": 1638252373366248
    }
  },
  {
    "ph": "s", "id": 4025, "pid": 2765, "tid": 2765, "ts": 1638252373366276,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373366286, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4026,
      "external id": 1210, "external ts": 1638252373366248
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 3, "tid": 7,
    "ts": 1638252373367748, "dur": 1376,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4027, "external id": 1210,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4027, "pid": 3, "tid": 7, "ts": 1638252373367748,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373366291, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4027,
      "external id": 1210, "external ts": 1638252373366248
    }
  },
  {
    "ph": "s", "id": 4027, "pid": 2765, "tid": 2765, "ts": 1638252373366291,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373366306, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4029,
      "external id": 1210, "external ts": 1638252373366248
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373369127, "dur": 75,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4033, "external id": 1213,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4033, "pid": 3, "tid": 7, "ts": 1638252373369127,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373366470, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4033,
      "external id": 1213, "external ts": 1638252373366460
    }
  },
  {
    "ph": "s", "id": 4033, "pid": 2765, "tid": 2765, "ts": 1638252373366470,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373369204, "dur": 74,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4041, "external id": 1226,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4041, "pid": 3, "tid": 7, "ts": 1638252373369204,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373367093, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4041,
      "external id": 1226, "external ts": 1638252373367083
    }
  },
  {
    "ph": "s", "id": 4041, "pid": 2765, "tid": 2765, "ts": 1638252373367093,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373369280, "dur": 71,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4050, "external id": 1235,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4050, "pid": 3, "tid": 7, "ts": 1638252373369280,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373367595, "dur": 21,
    "args": {
      "cbid": 211, "correlation": 4050,
      "external id": 1235, "external ts": 1638252373367588
    }
  },
  {
    "ph": "s", "id": 4050, "pid": 2765, "tid": 2765, "ts": 1638252373367595,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 3, "tid": 7,
    "ts": 1638252373369355, "dur": 281,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4060, "external id": 1238,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4060, "pid": 3, "tid": 7, "ts": 1638252373369355,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373367920, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4060,
      "external id": 1238, "external ts": 1638252373367795
    }
  },
  {
    "ph": "s", "id": 4060, "pid": 2765, "tid": 2765, "ts": 1638252373367920,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 3, "tid": 7,
    "ts": 1638252373369639, "dur": 10,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4066, "external id": 1242,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4066, "pid": 3, "tid": 7, "ts": 1638252373369639,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373368172, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4066,
      "external id": 1242, "external ts": 1638252373368151
    }
  },
  {
    "ph": "s", "id": 4066, "pid": 2765, "tid": 2765, "ts": 1638252373368172,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 2765, "tid": 487929600,
    "ts": 1638252373368191, "dur": 3,
    "args": {
      "cbid": 151, "correlation": 4072,
      "external id": 0, "external ts": 1638252373402530
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 2765, "tid": 487929600,
    "ts": 1638252373368423, "dur": 1,
    "args": {
      "cbid": 151, "correlation": 4080,
      "external id": 0, "external ts": 1638252373402530
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 3, "tid": 7,
    "ts": 1638252373369651, "dur": 2,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4086, "external id": 1247,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.029411765,
      "grid": [1, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 4086, "pid": 3, "tid": 7, "ts": 1638252373369651,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373368506, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 4086,
      "external id": 1247, "external ts": 1638252373368472
    }
  },
  {
    "ph": "s", "id": 4086, "pid": 2765, "tid": 2765, "ts": 1638252373368506,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoD (Device -> Device)", "pid": 3, "tid": 7,
    "ts": 1638252373369655, "dur": 8,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 4093, "external id": 1256,
      "bytes": 3538944, "memory bandwidth (GB/s)": 418.90909090909093
    }
  },
  {
    "ph": "f", "id": 4093, "pid": 3, "tid": 7, "ts": 1638252373369655,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373368953, "dur": 24,
    "args": {
      "cbid": 41, "correlation": 4093,
      "external id": 1256, "external ts": 1638252373368948
    }
  },
  {
    "ph": "s", "id": 4093, "pid": 2765, "tid": 2765, "ts": 1638252373368953,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast>(int, at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373369666, "dur": 13,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4098, "external id": 1257,
      "registers per thread": 24,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4098, "pid": 3, "tid": 7, "ts": 1638252373369666,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373369124, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4098,
      "external id": 1257, "external ts": 1638252373369027
    }
  },
  {
    "ph": "s", "id": 4098, "pid": 2765, "tid": 2765, "ts": 1638252373369124,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 3, false>(float*, float const*, int, int, int)", "pid": 3, "tid": 7,
    "ts": 1638252373369682, "dur": 20,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4105, "external id": 1261,
      "registers per thread": 19,
      "shared memory": 0,
      "blocks per SM": 67.76471,
      "warps per SM": 271.05884,
      "grid": [4608, 1, 1],
      "block": [8, 16, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4105, "pid": 3, "tid": 7, "ts": 1638252373369682,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373369265, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4105,
      "external id": 1261, "external ts": 1638252373369250
    }
  },
  {
    "ph": "s", "id": 4105, "pid": 2765, "tid": 2765, "ts": 1638252373369265,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 3, "tid": 7,
    "ts": 1638252373369704, "dur": 12,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4127, "external id": 1263,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4127, "pid": 3, "tid": 7, "ts": 1638252373369704,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373369648, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4127,
      "external id": 1263, "external ts": 1638252373369411
    }
  },
  {
    "ph": "s", "id": 4127, "pid": 2765, "tid": 2765, "ts": 1638252373369648,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373370233, "dur": 73,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4135, "external id": 1279,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4135, "pid": 3, "tid": 7, "ts": 1638252373370233,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373370217, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4135,
      "external id": 1279, "external ts": 1638252373370207
    }
  },
  {
    "ph": "s", "id": 4135, "pid": 2765, "tid": 2765, "ts": 1638252373370217,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 3, "tid": 7,
    "ts": 1638252373370455, "dur": 271,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4145, "external id": 1282,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4145, "pid": 3, "tid": 7, "ts": 1638252373370455,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373370441, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4145,
      "external id": 1282, "external ts": 1638252373370376
    }
  },
  {
    "ph": "s", "id": 4145, "pid": 2765, "tid": 2765, "ts": 1638252373370441,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373370894, "dur": 73,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4154, "external id": 1292,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4154, "pid": 3, "tid": 7, "ts": 1638252373370894,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373370880, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4154,
      "external id": 1292, "external ts": 1638252373370871
    }
  },
  {
    "ph": "s", "id": 4154, "pid": 2765, "tid": 2765, "ts": 1638252373370880,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373371331, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4163,
      "external id": 1300, "external ts": 1638252373371310
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373371336, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 4164,
      "external id": 1300, "external ts": 1638252373371310
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638252373371357, "dur": 0,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 4165, "external id": 1300,
      "bytes": 2304, "memory bandwidth (GB/s)": 5.142857142857143
    }
  },
  {
    "ph": "f", "id": 4165, "pid": 3, "tid": 7, "ts": 1638252373371357,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373371343, "dur": 10,
    "args": {
      "cbid": 51, "correlation": 4165,
      "external id": 1300, "external ts": 1638252373371310
    }
  },
  {
    "ph": "s", "id": 4165, "pid": 2765, "tid": 2765, "ts": 1638252373371343,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373371354, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4166,
      "external id": 1300, "external ts": 1638252373371310
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 3, "tid": 7,
    "ts": 1638252373371374, "dur": 1379,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4167, "external id": 1300,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4167, "pid": 3, "tid": 7, "ts": 1638252373371374,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373371360, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4167,
      "external id": 1300, "external ts": 1638252373371310
    }
  },
  {
    "ph": "s", "id": 4167, "pid": 2765, "tid": 2765, "ts": 1638252373371360,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373371376, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4169,
      "external id": 1300, "external ts": 1638252373371310
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373372756, "dur": 74,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4173, "external id": 1303,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4173, "pid": 3, "tid": 7, "ts": 1638252373372756,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373371543, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4173,
      "external id": 1303, "external ts": 1638252373371532
    }
  },
  {
    "ph": "s", "id": 4173, "pid": 2765, "tid": 2765, "ts": 1638252373371543,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 3, "tid": 7,
    "ts": 1638252373372833, "dur": 87,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4195, "external id": 1305,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4195, "pid": 3, "tid": 7, "ts": 1638252373372833,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373371913, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4195,
      "external id": 1305, "external ts": 1638252373371678
    }
  },
  {
    "ph": "s", "id": 4195, "pid": 2765, "tid": 2765, "ts": 1638252373371913,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3> >(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>)", "pid": 3, "tid": 7,
    "ts": 1638252373372924, "dur": 102,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4201, "external id": 1310,
      "registers per thread": 20,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4201, "pid": 3, "tid": 7, "ts": 1638252373372924,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373372036, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4201,
      "external id": 1310, "external ts": 1638252373372019
    }
  },
  {
    "ph": "s", "id": 4201, "pid": 2765, "tid": 2765, "ts": 1638252373372036,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373373028, "dur": 124,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4215, "external id": 1312,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4215, "pid": 3, "tid": 7, "ts": 1638252373373028,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373372342, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4215,
      "external id": 1312, "external ts": 1638252373372170
    }
  },
  {
    "ph": "s", "id": 4215, "pid": 2765, "tid": 2765, "ts": 1638252373372342,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373373157, "dur": 68,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4217, "external id": 1312,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4217, "pid": 3, "tid": 7, "ts": 1638252373373157,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373372356, "dur": 9,
    "args": {
      "cbid": 211, "correlation": 4217,
      "external id": 1312, "external ts": 1638252373372170
    }
  },
  {
    "ph": "s", "id": 4217, "pid": 2765, "tid": 2765, "ts": 1638252373372356,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373372857, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4224,
      "external id": 1324, "external ts": 1638252373372837
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373372861, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4225,
      "external id": 1324, "external ts": 1638252373372837
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 3, "tid": 7,
    "ts": 1638252373373227, "dur": 5130,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4226, "external id": 1324,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [48, 24, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4226, "pid": 3, "tid": 7, "ts": 1638252373373227,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373372866, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4226,
      "external id": 1324, "external ts": 1638252373372837
    }
  },
  {
    "ph": "s", "id": 4226, "pid": 2765, "tid": 2765, "ts": 1638252373372866,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373378359, "dur": 280,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4231, "external id": 1327,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4231, "pid": 3, "tid": 7, "ts": 1638252373378359,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373373045, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 4231,
      "external id": 1327, "external ts": 1638252373373035
    }
  },
  {
    "ph": "s", "id": 4231, "pid": 2765, "tid": 2765, "ts": 1638252373373045,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2> >(int, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>)", "pid": 3, "tid": 7,
    "ts": 1638252373378643, "dur": 280,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4237, "external id": 1328,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4237, "pid": 3, "tid": 7, "ts": 1638252373378643,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373373138, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4237,
      "external id": 1328, "external ts": 1638252373373121
    }
  },
  {
    "ph": "s", "id": 4237, "pid": 2765, "tid": 2765, "ts": 1638252373373138,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373373520, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4244,
      "external id": 1335, "external ts": 1638252373373501
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373373524, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 4245,
      "external id": 1335, "external ts": 1638252373373501
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638252373378926, "dur": 0,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 4246, "external id": 1335,
      "bytes": 1152, "memory bandwidth (GB/s)": 1.3846153846153846
    }
  },
  {
    "ph": "f", "id": 4246, "pid": 3, "tid": 7, "ts": 1638252373378926,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373373530, "dur": 10,
    "args": {
      "cbid": 51, "correlation": 4246,
      "external id": 1335, "external ts": 1638252373373501
    }
  },
  {
    "ph": "s", "id": 4246, "pid": 2765, "tid": 2765, "ts": 1638252373373530,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 3, "tid": 7,
    "ts": 1638252373378928, "dur": 5158,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4247, "external id": 1335,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [12, 24, 4],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4247, "pid": 3, "tid": 7, "ts": 1638252373378928,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373373541, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4247,
      "external id": 1335, "external ts": 1638252373373501
    }
  },
  {
    "ph": "s", "id": 4247, "pid": 2765, "tid": 2765, "ts": 1638252373373541,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373373556, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4249,
      "external id": 1335, "external ts": 1638252373373501
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373384090, "dur": 75,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4253, "external id": 1338,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4253, "pid": 3, "tid": 7, "ts": 1638252373384090,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373373727, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4253,
      "external id": 1338, "external ts": 1638252373373718
    }
  },
  {
    "ph": "s", "id": 4253, "pid": 2765, "tid": 2765, "ts": 1638252373373727,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 3, "tid": 7,
    "ts": 1638252373384167, "dur": 85,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4275, "external id": 1340,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4275, "pid": 3, "tid": 7, "ts": 1638252373384167,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373374101, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4275,
      "external id": 1340, "external ts": 1638252373373871
    }
  },
  {
    "ph": "s", "id": 4275, "pid": 2765, "tid": 2765, "ts": 1638252373374101,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373384254, "dur": 132,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4289, "external id": 1346,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4289, "pid": 3, "tid": 7, "ts": 1638252373384254,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373374397, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4289,
      "external id": 1346, "external ts": 1638252373374247
    }
  },
  {
    "ph": "s", "id": 4289, "pid": 2765, "tid": 2765, "ts": 1638252373374397,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373384389, "dur": 69,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4291, "external id": 1346,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4291, "pid": 3, "tid": 7, "ts": 1638252373384389,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373374412, "dur": 9,
    "args": {
      "cbid": 211, "correlation": 4291,
      "external id": 1346, "external ts": 1638252373374247
    }
  },
  {
    "ph": "s", "id": 4291, "pid": 2765, "tid": 2765, "ts": 1638252373374412,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373374835, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4298,
      "external id": 1358, "external ts": 1638252373374815
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_32x32_sliced1x4_tn", "pid": 3, "tid": 7,
    "ts": 1638252373384460, "dur": 80,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4299, "external id": 1358,
      "registers per thread": 86,
      "shared memory": 32768,
      "blocks per SM": 1.4117647,
      "warps per SM": 5.647059,
      "grid": [1, 96, 1],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 18
    }
  },
  {
    "ph": "f", "id": 4299, "pid": 3, "tid": 7, "ts": 1638252373384460,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373374840, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4299,
      "external id": 1358, "external ts": 1638252373374815
    }
  },
  {
    "ph": "s", "id": 4299, "pid": 2765, "tid": 2765, "ts": 1638252373374840,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 4, true>(float*, float const*, int, int, int)", "pid": 3, "tid": 7,
    "ts": 1638252373384543, "dur": 2,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4306, "external id": 1366,
      "registers per thread": 18,
      "shared memory": 0,
      "blocks per SM": 2.8235295,
      "warps per SM": 11.294118,
      "grid": [192, 1, 1],
      "block": [16, 8, 1],
      "est. achieved occupancy %": 35
    }
  },
  {
    "ph": "f", "id": 4306, "pid": 3, "tid": 7, "ts": 1638252373384543,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373375187, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4306,
      "external id": 1366, "external ts": 1638252373375172
    }
  },
  {
    "ph": "s", "id": 4306, "pid": 2765, "tid": 2765, "ts": 1638252373375187,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::nll_loss_forward_reduce_cuda_kernel_2d<float, float, long>(float*, float*, float*, long*, float*, bool, int, int, int, long)", "pid": 3, "tid": 7,
    "ts": 1638252373384548, "dur": 57,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4313, "external id": 1369,
      "registers per thread": 38,
      "shared memory": 256,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.014705882,
      "grid": [1, 1, 1],
      "block": [32, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 4313, "pid": 3, "tid": 7, "ts": 1638252373384548,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373375403, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4313,
      "external id": 1369, "external ts": 1638252373375311
    }
  },
  {
    "ph": "s", "id": 4313, "pid": 2765, "tid": 2765, "ts": 1638252373375403,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373375673, "dur": 2,
    "args": {
      "cbid": 134, "correlation": 4318,
      "external id": 1033, "external ts": 1638252373358091
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373375677, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4319,
      "external id": 1033, "external ts": 1638252373358091
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373375682, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 4321,
      "external id": 1033, "external ts": 1638252373358091
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373375689, "dur": 0,
    "args": {
      "cbid": 134, "correlation": 4325,
      "external id": 1033, "external ts": 1638252373358091
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373375690, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4326,
      "external id": 1033, "external ts": 1638252373358091
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 2765, "tid": 2765,
    "ts": 1638252373375735, "dur": 8874,
    "args": {
      "cbid": 165, "correlation": 4330,
      "external id": 1033, "external ts": 1638252373358091
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373385075, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 4331,
      "external id": 1376, "external ts": 1638252373384828
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2765, "tid": 2765,
    "ts": 1638252373385080, "dur": 2,
    "args": {
      "cbid": 136, "correlation": 4332,
      "external id": 1376, "external ts": 1638252373384828
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373385083, "dur": 1,
    "args": {
      "cbid": 138, "correlation": 4333,
      "external id": 1376, "external ts": 1638252373384828
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2765, "tid": 2765,
    "ts": 1638252373385084, "dur": 1,
    "args": {
      "cbid": 136, "correlation": 4334,
      "external id": 1376, "external ts": 1638252373384828
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy HtoD (Pinned -> Device)", "pid": 3, "tid": 7,
    "ts": 1638252373385247, "dur": 3,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 4353, "external id": 1386,
      "bytes": 24576, "memory bandwidth (GB/s)": 7.314285714285714
    }
  },
  {
    "ph": "f", "id": 4353, "pid": 3, "tid": 7, "ts": 1638252373385247,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373385224, "dur": 20,
    "args": {
      "cbid": 41, "correlation": 4353,
      "external id": 1386, "external ts": 1638252373385215
    }
  },
  {
    "ph": "s", "id": 4353, "pid": 2765, "tid": 2765, "ts": 1638252373385224,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamSynchronize", "pid": 2765, "tid": 2765,
    "ts": 1638252373385245, "dur": 8,
    "args": {
      "cbid": 131, "correlation": 4354,
      "external id": 1386, "external ts": 1638252373385215
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy HtoD (Pinned -> Device)", "pid": 3, "tid": 7,
    "ts": 1638252373385380, "dur": 3,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 4366, "external id": 1390,
      "bytes": 24576, "memory bandwidth (GB/s)": 7.384615384615385
    }
  },
  {
    "ph": "f", "id": 4366, "pid": 3, "tid": 7, "ts": 1638252373385380,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373385361, "dur": 15,
    "args": {
      "cbid": 41, "correlation": 4366,
      "external id": 1390, "external ts": 1638252373385356
    }
  },
  {
    "ph": "s", "id": 4366, "pid": 2765, "tid": 2765, "ts": 1638252373385361,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamSynchronize", "pid": 2765, "tid": 2765,
    "ts": 1638252373385377, "dur": 8,
    "args": {
      "cbid": 131, "correlation": 4367,
      "external id": 1390, "external ts": 1638252373385356
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 2765, "tid": 2765,
    "ts": 1638252373385417, "dur": 4,
    "args": {
      "cbid": 165, "correlation": 4371,
      "external id": 1376, "external ts": 1638252373384828
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373385700, "dur": 2,
    "args": {
      "cbid": 134, "correlation": 4377,
      "external id": 1376, "external ts": 1638252373384828
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373385704, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4380,
      "external id": 1376, "external ts": 1638252373384828
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamWaitEvent", "pid": 2765, "tid": 2765,
    "ts": 1638252373385711, "dur": 1,
    "args": {
      "cbid": 147, "correlation": 4383,
      "external id": 1376, "external ts": 1638252373384828
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2765, "tid": 2765,
    "ts": 1638252373385716, "dur": 1,
    "args": {
      "cbid": 136, "correlation": 4386,
      "external id": 1376, "external ts": 1638252373384828
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoH (Device -> Pinned)", "pid": 3, "tid": 7,
    "ts": 1638252373389294, "dur": 2,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 4395, "external id": 1491,
      "bytes": 24576, "memory bandwidth (GB/s)": 8.629213483146067
    }
  },
  {
    "ph": "f", "id": 4395, "pid": 3, "tid": 7, "ts": 1638252373389294,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373389276, "dur": 16,
    "args": {
      "cbid": 41, "correlation": 4395,
      "external id": 1491, "external ts": 1638252373389267
    }
  },
  {
    "ph": "s", "id": 4395, "pid": 2765, "tid": 2765, "ts": 1638252373389276,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoH (Device -> Pinned)", "pid": 3, "tid": 7,
    "ts": 1638252373389454, "dur": 2,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 4401, "external id": 1495,
      "bytes": 24576, "memory bandwidth (GB/s)": 8.533333333333333
    }
  },
  {
    "ph": "f", "id": 4401, "pid": 3, "tid": 7, "ts": 1638252373389454,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373389441, "dur": 10,
    "args": {
      "cbid": 41, "correlation": 4401,
      "external id": 1495, "external ts": 1638252373389436
    }
  },
  {
    "ph": "s", "id": 4401, "pid": 2765, "tid": 2765, "ts": 1638252373389441,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::indexSelectLargeIndex<float, long, unsigned int, 2, 2, -2, true>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<long, unsigned int>, int, int, unsigned int, unsigned int, long)", "pid": 3, "tid": 7,
    "ts": 1638252373389797, "dur": 74,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4414, "external id": 1499,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 8.0,
      "warps per SM": 32.0,
      "grid": [544, 1, 1],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4414, "pid": 3, "tid": 7, "ts": 1638252373389797,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373389774, "dur": 21,
    "args": {
      "cbid": 211, "correlation": 4414,
      "external id": 1499, "external ts": 1638252373389656
    }
  },
  {
    "ph": "s", "id": 4414, "pid": 2765, "tid": 2765, "ts": 1638252373389774,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373390080, "dur": 73,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4422, "external id": 1507,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4422, "pid": 3, "tid": 7, "ts": 1638252373390080,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373390062, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 4422,
      "external id": 1507, "external ts": 1638252373390041
    }
  },
  {
    "ph": "s", "id": 4422, "pid": 2765, "tid": 2765, "ts": 1638252373390062,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 3, "tid": 7,
    "ts": 1638252373390383, "dur": 87,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4444, "external id": 1509,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4444, "pid": 3, "tid": 7, "ts": 1638252373390383,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373390368, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4444,
      "external id": 1509, "external ts": 1638252373390176
    }
  },
  {
    "ph": "s", "id": 4444, "pid": 2765, "tid": 2765, "ts": 1638252373390368,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373390709, "dur": 134,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4458, "external id": 1515,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4458, "pid": 3, "tid": 7, "ts": 1638252373390709,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373390694, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4458,
      "external id": 1515, "external ts": 1638252373390517
    }
  },
  {
    "ph": "s", "id": 4458, "pid": 2765, "tid": 2765, "ts": 1638252373390694,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373390846, "dur": 68,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4460, "external id": 1515,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4460, "pid": 3, "tid": 7, "ts": 1638252373390846,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373390709, "dur": 10,
    "args": {
      "cbid": 211, "correlation": 4460,
      "external id": 1515, "external ts": 1638252373390517
    }
  },
  {
    "ph": "s", "id": 4460, "pid": 2765, "tid": 2765, "ts": 1638252373390709,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373391203, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4467,
      "external id": 1527, "external ts": 1638252373391182
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373391208, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 4468,
      "external id": 1527, "external ts": 1638252373391182
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638252373391227, "dur": 1,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 4469, "external id": 1527,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.1612903225806452
    }
  },
  {
    "ph": "f", "id": 4469, "pid": 3, "tid": 7, "ts": 1638252373391227,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373391214, "dur": 10,
    "args": {
      "cbid": 51, "correlation": 4469,
      "external id": 1527, "external ts": 1638252373391182
    }
  },
  {
    "ph": "s", "id": 4469, "pid": 2765, "tid": 2765, "ts": 1638252373391214,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373391224, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4470,
      "external id": 1527, "external ts": 1638252373391182
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 3, "tid": 7,
    "ts": 1638252373391245, "dur": 1382,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4471, "external id": 1527,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4471, "pid": 3, "tid": 7, "ts": 1638252373391245,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373391231, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4471,
      "external id": 1527, "external ts": 1638252373391182
    }
  },
  {
    "ph": "s", "id": 4471, "pid": 2765, "tid": 2765, "ts": 1638252373391231,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373391247, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4473,
      "external id": 1527, "external ts": 1638252373391182
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373392630, "dur": 75,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4477, "external id": 1530,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4477, "pid": 3, "tid": 7, "ts": 1638252373392630,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373391418, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4477,
      "external id": 1530, "external ts": 1638252373391406
    }
  },
  {
    "ph": "s", "id": 4477, "pid": 2765, "tid": 2765, "ts": 1638252373391418,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373391965, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4484,
      "external id": 1540, "external ts": 1638252373391943
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373391969, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 4485,
      "external id": 1540, "external ts": 1638252373391943
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638252373392707, "dur": 1,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 4486, "external id": 1540,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.6744186046511629
    }
  },
  {
    "ph": "f", "id": 4486, "pid": 3, "tid": 7, "ts": 1638252373392707,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373391973, "dur": 9,
    "args": {
      "cbid": 51, "correlation": 4486,
      "external id": 1540, "external ts": 1638252373391943
    }
  },
  {
    "ph": "s", "id": 4486, "pid": 2765, "tid": 2765, "ts": 1638252373391973,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373391983, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4487,
      "external id": 1540, "external ts": 1638252373391943
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 3, "tid": 7,
    "ts": 1638252373392709, "dur": 1378,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4488, "external id": 1540,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4488, "pid": 3, "tid": 7, "ts": 1638252373392709,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373391989, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4488,
      "external id": 1540, "external ts": 1638252373391943
    }
  },
  {
    "ph": "s", "id": 4488, "pid": 2765, "tid": 2765, "ts": 1638252373391989,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373392004, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4490,
      "external id": 1540, "external ts": 1638252373391943
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373394090, "dur": 75,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4494, "external id": 1543,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4494, "pid": 3, "tid": 7, "ts": 1638252373394090,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373392170, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4494,
      "external id": 1543, "external ts": 1638252373392159
    }
  },
  {
    "ph": "s", "id": 4494, "pid": 2765, "tid": 2765, "ts": 1638252373392170,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373392706, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4501,
      "external id": 1553, "external ts": 1638252373392685
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373392710, "dur": 2,
    "args": {
      "cbid": 138, "correlation": 4502,
      "external id": 1553, "external ts": 1638252373392685
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638252373394168, "dur": 1,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 4503, "external id": 1553,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.6011118832522586
    }
  },
  {
    "ph": "f", "id": 4503, "pid": 3, "tid": 7, "ts": 1638252373394168,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373392714, "dur": 9,
    "args": {
      "cbid": 51, "correlation": 4503,
      "external id": 1553, "external ts": 1638252373392685
    }
  },
  {
    "ph": "s", "id": 4503, "pid": 2765, "tid": 2765, "ts": 1638252373392714,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373392724, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4504,
      "external id": 1553, "external ts": 1638252373392685
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 3, "tid": 7,
    "ts": 1638252373394171, "dur": 1377,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4505, "external id": 1553,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4505, "pid": 3, "tid": 7, "ts": 1638252373394171,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373392729, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4505,
      "external id": 1553, "external ts": 1638252373392685
    }
  },
  {
    "ph": "s", "id": 4505, "pid": 2765, "tid": 2765, "ts": 1638252373392729,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373392744, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4507,
      "external id": 1553, "external ts": 1638252373392685
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373395550, "dur": 73,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4511, "external id": 1556,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4511, "pid": 3, "tid": 7, "ts": 1638252373395550,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373392905, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4511,
      "external id": 1556, "external ts": 1638252373392896
    }
  },
  {
    "ph": "s", "id": 4511, "pid": 2765, "tid": 2765, "ts": 1638252373392905,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373395626, "dur": 75,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4519, "external id": 1569,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4519, "pid": 3, "tid": 7, "ts": 1638252373395626,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373393522, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4519,
      "external id": 1569, "external ts": 1638252373393512
    }
  },
  {
    "ph": "s", "id": 4519, "pid": 2765, "tid": 2765, "ts": 1638252373393522,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373395703, "dur": 72,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4528, "external id": 1578,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4528, "pid": 3, "tid": 7, "ts": 1638252373395703,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373393958, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4528,
      "external id": 1578, "external ts": 1638252373393950
    }
  },
  {
    "ph": "s", "id": 4528, "pid": 2765, "tid": 2765, "ts": 1638252373393958,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 3, "tid": 7,
    "ts": 1638252373395777, "dur": 282,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4538, "external id": 1581,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4538, "pid": 3, "tid": 7, "ts": 1638252373395777,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373394165, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4538,
      "external id": 1581, "external ts": 1638252373394105
    }
  },
  {
    "ph": "s", "id": 4538, "pid": 2765, "tid": 2765, "ts": 1638252373394165,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 3, "tid": 7,
    "ts": 1638252373396061, "dur": 8,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4544, "external id": 1585,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4544, "pid": 3, "tid": 7, "ts": 1638252373396061,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373394365, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4544,
      "external id": 1585, "external ts": 1638252373394346
    }
  },
  {
    "ph": "s", "id": 4544, "pid": 2765, "tid": 2765, "ts": 1638252373394365,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 3, "tid": 7,
    "ts": 1638252373396072, "dur": 1,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4552, "external id": 1590,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.029411765,
      "grid": [1, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 4552, "pid": 3, "tid": 7, "ts": 1638252373396072,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373394664, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4552,
      "external id": 1590, "external ts": 1638252373394636
    }
  },
  {
    "ph": "s", "id": 4552, "pid": 2765, "tid": 2765, "ts": 1638252373394664,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoD (Device -> Device)", "pid": 3, "tid": 7,
    "ts": 1638252373396076, "dur": 10,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 4559, "external id": 1599,
      "bytes": 3538944, "memory bandwidth (GB/s)": 352.20382165605093
    }
  },
  {
    "ph": "f", "id": 4559, "pid": 3, "tid": 7, "ts": 1638252373396076,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373395095, "dur": 22,
    "args": {
      "cbid": 41, "correlation": 4559,
      "external id": 1599, "external ts": 1638252373395090
    }
  },
  {
    "ph": "s", "id": 4559, "pid": 2765, "tid": 2765, "ts": 1638252373395095,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast>(int, at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373396088, "dur": 12,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4564, "external id": 1600,
      "registers per thread": 24,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4564, "pid": 3, "tid": 7, "ts": 1638252373396088,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373395261, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4564,
      "external id": 1600, "external ts": 1638252373395166
    }
  },
  {
    "ph": "s", "id": 4564, "pid": 2765, "tid": 2765, "ts": 1638252373395261,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 3, false>(float*, float const*, int, int, int)", "pid": 3, "tid": 7,
    "ts": 1638252373396296, "dur": 21,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4571, "external id": 1604,
      "registers per thread": 19,
      "shared memory": 0,
      "blocks per SM": 67.76471,
      "warps per SM": 271.05884,
      "grid": [4608, 1, 1],
      "block": [8, 16, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4571, "pid": 3, "tid": 7, "ts": 1638252373396296,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373396274, "dur": 21,
    "args": {
      "cbid": 211, "correlation": 4571,
      "external id": 1604, "external ts": 1638252373396252
    }
  },
  {
    "ph": "s", "id": 4571, "pid": 2765, "tid": 2765, "ts": 1638252373396274,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 3, "tid": 7,
    "ts": 1638252373396678, "dur": 13,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4593, "external id": 1606,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4593, "pid": 3, "tid": 7, "ts": 1638252373396678,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373396660, "dur": 17,
    "args": {
      "cbid": 211, "correlation": 4593,
      "external id": 1606, "external ts": 1638252373396425
    }
  },
  {
    "ph": "s", "id": 4593, "pid": 2765, "tid": 2765, "ts": 1638252373396660,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373397235, "dur": 75,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4601, "external id": 1622,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4601, "pid": 3, "tid": 7, "ts": 1638252373397235,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373397220, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4601,
      "external id": 1622, "external ts": 1638252373397208
    }
  },
  {
    "ph": "s", "id": 4601, "pid": 2765, "tid": 2765, "ts": 1638252373397220,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 3, "tid": 7,
    "ts": 1638252373397444, "dur": 271,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4611, "external id": 1625,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4611, "pid": 3, "tid": 7, "ts": 1638252373397444,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373397430, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4611,
      "external id": 1625, "external ts": 1638252373397369
    }
  },
  {
    "ph": "s", "id": 4611, "pid": 2765, "tid": 2765, "ts": 1638252373397430,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373397868, "dur": 73,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4620, "external id": 1635,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4620, "pid": 3, "tid": 7, "ts": 1638252373397868,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373397853, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4620,
      "external id": 1635, "external ts": 1638252373397845
    }
  },
  {
    "ph": "s", "id": 4620, "pid": 2765, "tid": 2765, "ts": 1638252373397853,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373398292, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4629,
      "external id": 1643, "external ts": 1638252373398271
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373398296, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 4630,
      "external id": 1643, "external ts": 1638252373398271
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638252373398316, "dur": 0,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 4631, "external id": 1643,
      "bytes": 2304, "memory bandwidth (GB/s)": 2.6666666666666665
    }
  },
  {
    "ph": "f", "id": 4631, "pid": 3, "tid": 7, "ts": 1638252373398316,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373398302, "dur": 10,
    "args": {
      "cbid": 51, "correlation": 4631,
      "external id": 1643, "external ts": 1638252373398271
    }
  },
  {
    "ph": "s", "id": 4631, "pid": 2765, "tid": 2765, "ts": 1638252373398302,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373398313, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4632,
      "external id": 1643, "external ts": 1638252373398271
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 3, "tid": 7,
    "ts": 1638252373398333, "dur": 1380,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4633, "external id": 1643,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4633, "pid": 3, "tid": 7, "ts": 1638252373398333,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373398319, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4633,
      "external id": 1643, "external ts": 1638252373398271
    }
  },
  {
    "ph": "s", "id": 4633, "pid": 2765, "tid": 2765, "ts": 1638252373398319,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373398335, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4635,
      "external id": 1643, "external ts": 1638252373398271
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373399716, "dur": 75,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4639, "external id": 1646,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4639, "pid": 3, "tid": 7, "ts": 1638252373399716,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373398495, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4639,
      "external id": 1646, "external ts": 1638252373398484
    }
  },
  {
    "ph": "s", "id": 4639, "pid": 2765, "tid": 2765, "ts": 1638252373398495,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 3, "tid": 7,
    "ts": 1638252373399793, "dur": 88,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4661, "external id": 1648,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4661, "pid": 3, "tid": 7, "ts": 1638252373399793,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373398862, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4661,
      "external id": 1648, "external ts": 1638252373398640
    }
  },
  {
    "ph": "s", "id": 4661, "pid": 2765, "tid": 2765, "ts": 1638252373398862,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3> >(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>)", "pid": 3, "tid": 7,
    "ts": 1638252373399883, "dur": 104,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4667, "external id": 1653,
      "registers per thread": 20,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4667, "pid": 3, "tid": 7, "ts": 1638252373399883,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373398987, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4667,
      "external id": 1653, "external ts": 1638252373398970
    }
  },
  {
    "ph": "s", "id": 4667, "pid": 2765, "tid": 2765, "ts": 1638252373398987,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373399988, "dur": 125,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4681, "external id": 1655,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4681, "pid": 3, "tid": 7, "ts": 1638252373399988,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373399276, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4681,
      "external id": 1655, "external ts": 1638252373399116
    }
  },
  {
    "ph": "s", "id": 4681, "pid": 2765, "tid": 2765, "ts": 1638252373399276,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373400116, "dur": 68,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4683, "external id": 1655,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4683, "pid": 3, "tid": 7, "ts": 1638252373400116,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373399290, "dur": 9,
    "args": {
      "cbid": 211, "correlation": 4683,
      "external id": 1655, "external ts": 1638252373399116
    }
  },
  {
    "ph": "s", "id": 4683, "pid": 2765, "tid": 2765, "ts": 1638252373399290,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373399773, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4690,
      "external id": 1667, "external ts": 1638252373399753
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373399777, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4691,
      "external id": 1667, "external ts": 1638252373399753
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 3, "tid": 7,
    "ts": 1638252373400188, "dur": 5125,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4692, "external id": 1667,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [48, 24, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4692, "pid": 3, "tid": 7, "ts": 1638252373400188,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373399782, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4692,
      "external id": 1667, "external ts": 1638252373399753
    }
  },
  {
    "ph": "s", "id": 4692, "pid": 2765, "tid": 2765, "ts": 1638252373399782,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373405315, "dur": 280,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4697, "external id": 1670,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4697, "pid": 3, "tid": 7, "ts": 1638252373405315,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373399956, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4697,
      "external id": 1670, "external ts": 1638252373399946
    }
  },
  {
    "ph": "s", "id": 4697, "pid": 2765, "tid": 2765, "ts": 1638252373399956,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2> >(int, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>)", "pid": 3, "tid": 7,
    "ts": 1638252373405598, "dur": 280,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4703, "external id": 1671,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4703, "pid": 3, "tid": 7, "ts": 1638252373405598,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373400054, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4703,
      "external id": 1671, "external ts": 1638252373400032
    }
  },
  {
    "ph": "s", "id": 4703, "pid": 2765, "tid": 2765, "ts": 1638252373400054,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373400419, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4710,
      "external id": 1678, "external ts": 1638252373400401
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373400423, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 4711,
      "external id": 1678, "external ts": 1638252373400401
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638252373405880, "dur": 1,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 4712, "external id": 1678,
      "bytes": 1152, "memory bandwidth (GB/s)": 0.7346938775510204
    }
  },
  {
    "ph": "f", "id": 4712, "pid": 3, "tid": 7, "ts": 1638252373405880,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2765, "tid": 2765,
    "ts": 1638252373400429, "dur": 9,
    "args": {
      "cbid": 51, "correlation": 4712,
      "external id": 1678, "external ts": 1638252373400401
    }
  },
  {
    "ph": "s", "id": 4712, "pid": 2765, "tid": 2765, "ts": 1638252373400429,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 3, "tid": 7,
    "ts": 1638252373405883, "dur": 5159,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4713, "external id": 1678,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [12, 24, 4],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4713, "pid": 3, "tid": 7, "ts": 1638252373405883,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373400440, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 4713,
      "external id": 1678, "external ts": 1638252373400401
    }
  },
  {
    "ph": "s", "id": 4713, "pid": 2765, "tid": 2765, "ts": 1638252373400440,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373400455, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4715,
      "external id": 1678, "external ts": 1638252373400401
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638252373411045, "dur": 74,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4719, "external id": 1681,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4719, "pid": 3, "tid": 7, "ts": 1638252373411045,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373400619, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4719,
      "external id": 1681, "external ts": 1638252373400610
    }
  },
  {
    "ph": "s", "id": 4719, "pid": 2765, "tid": 2765, "ts": 1638252373400619,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 3, "tid": 7,
    "ts": 1638252373411122, "dur": 84,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4741, "external id": 1683,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4741, "pid": 3, "tid": 7, "ts": 1638252373411122,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373400974, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4741,
      "external id": 1683, "external ts": 1638252373400755
    }
  },
  {
    "ph": "s", "id": 4741, "pid": 2765, "tid": 2765, "ts": 1638252373400974,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373411209, "dur": 132,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4755, "external id": 1689,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4755, "pid": 3, "tid": 7, "ts": 1638252373411209,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373401261, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4755,
      "external id": 1689, "external ts": 1638252373401120
    }
  },
  {
    "ph": "s", "id": 4755, "pid": 2765, "tid": 2765, "ts": 1638252373401261,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 3, "tid": 7,
    "ts": 1638252373411344, "dur": 69,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4757, "external id": 1689,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4757, "pid": 3, "tid": 7, "ts": 1638252373411344,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373401276, "dur": 9,
    "args": {
      "cbid": 211, "correlation": 4757,
      "external id": 1689, "external ts": 1638252373401120
    }
  },
  {
    "ph": "s", "id": 4757, "pid": 2765, "tid": 2765, "ts": 1638252373401276,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373401682, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4764,
      "external id": 1701, "external ts": 1638252373401662
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_32x32_sliced1x4_tn", "pid": 3, "tid": 7,
    "ts": 1638252373411415, "dur": 81,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4765, "external id": 1701,
      "registers per thread": 86,
      "shared memory": 32768,
      "blocks per SM": 1.4117647,
      "warps per SM": 5.647059,
      "grid": [1, 96, 1],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 18
    }
  },
  {
    "ph": "f", "id": 4765, "pid": 3, "tid": 7, "ts": 1638252373411415,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373401687, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4765,
      "external id": 1701, "external ts": 1638252373401662
    }
  },
  {
    "ph": "s", "id": 4765, "pid": 2765, "tid": 2765, "ts": 1638252373401687,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 4, true>(float*, float const*, int, int, int)", "pid": 3, "tid": 7,
    "ts": 1638252373411499, "dur": 2,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4772, "external id": 1709,
      "registers per thread": 18,
      "shared memory": 0,
      "blocks per SM": 2.8235295,
      "warps per SM": 11.294118,
      "grid": [192, 1, 1],
      "block": [16, 8, 1],
      "est. achieved occupancy %": 35
    }
  },
  {
    "ph": "f", "id": 4772, "pid": 3, "tid": 7, "ts": 1638252373411499,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373402020, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4772,
      "external id": 1709, "external ts": 1638252373402005
    }
  },
  {
    "ph": "s", "id": 4772, "pid": 2765, "tid": 2765, "ts": 1638252373402020,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::nll_loss_forward_reduce_cuda_kernel_2d<float, float, long>(float*, float*, float*, long*, float*, bool, int, int, int, long)", "pid": 3, "tid": 7,
    "ts": 1638252373411504, "dur": 58,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4779, "external id": 1712,
      "registers per thread": 38,
      "shared memory": 256,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.014705882,
      "grid": [1, 1, 1],
      "block": [32, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 4779, "pid": 3, "tid": 7, "ts": 1638252373411504,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2765, "tid": 2765,
    "ts": 1638252373402227, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4779,
      "external id": 1712, "external ts": 1638252373402141
    }
  },
  {
    "ph": "s", "id": 4779, "pid": 2765, "tid": 2765, "ts": 1638252373402227,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373402495, "dur": 2,
    "args": {
      "cbid": 134, "correlation": 4784,
      "external id": 1376, "external ts": 1638252373384828
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373402498, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4785,
      "external id": 1376, "external ts": 1638252373384828
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2765, "tid": 2765,
    "ts": 1638252373402502, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 4787,
      "external id": 1376, "external ts": 1638252373384828
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2765, "tid": 2765,
    "ts": 1638252373402509, "dur": 1,
    "args": {
      "cbid": 134, "correlation": 4791,
      "external id": 1376, "external ts": 1638252373384828
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2765, "tid": 2765,
    "ts": 1638252373402511, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4792,
      "external id": 1376, "external ts": 1638252373384828
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 2765, "tid": 2765,
    "ts": 1638252373402556, "dur": 9009,
    "args": {
      "cbid": 165, "correlation": 4796,
      "external id": 1376, "external ts": 1638252373384828
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 2765, "tid": 2765,
    "ts": 1638252373411712, "dur": 4,
    "args": {
      "cbid": 165, "correlation": 4799,
      "external id": 0, "external ts": 1638252373402530
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638252373276561, "pid": 2765, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638252373276561, "pid": 2765, "tid": 0,
    "args": {
      "labels": "CPU"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638252373276561, "pid": 2765, "tid": 0,
    "args": {
      "sort_index": 2765
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638252373276561, "pid": 0, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638252373276561, "pid": 0, "tid": 0,
    "args": {
      "labels": "GPU 0"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638252373276561, "pid": 0, "tid": 0,
    "args": {
      "sort_index": 16777216
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638252373276561, "pid": 1, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638252373276561, "pid": 1, "tid": 0,
    "args": {
      "labels": "GPU 1"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638252373276561, "pid": 1, "tid": 0,
    "args": {
      "sort_index": 16777217
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638252373276561, "pid": 2, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638252373276561, "pid": 2, "tid": 0,
    "args": {
      "labels": "GPU 2"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638252373276561, "pid": 2, "tid": 0,
    "args": {
      "sort_index": 16777218
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638252373276561, "pid": 3, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638252373276561, "pid": 3, "tid": 0,
    "args": {
      "labels": "GPU 3"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638252373276561, "pid": 3, "tid": 0,
    "args": {
      "sort_index": 16777219
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638252373276561, "pid": 4, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638252373276561, "pid": 4, "tid": 0,
    "args": {
      "labels": "GPU 4"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638252373276561, "pid": 4, "tid": 0,
    "args": {
      "sort_index": 16777220
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638252373276561, "pid": 5, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638252373276561, "pid": 5, "tid": 0,
    "args": {
      "labels": "GPU 5"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638252373276561, "pid": 5, "tid": 0,
    "args": {
      "sort_index": 16777221
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638252373276561, "pid": 6, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638252373276561, "pid": 6, "tid": 0,
    "args": {
      "labels": "GPU 6"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638252373276561, "pid": 6, "tid": 0,
    "args": {
      "sort_index": 16777222
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638252373276561, "pid": 7, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638252373276561, "pid": 7, "tid": 0,
    "args": {
      "labels": "GPU 7"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638252373276561, "pid": 7, "tid": 0,
    "args": {
      "sort_index": 16777223
    }
  },
  {
    "name": "thread_name", "ph": "M", "ts": 1638252373276561, "pid": 3, "tid": 7,
    "args": {
      "name": "stream 7"
    }
  },
  {
    "name": "thread_sort_index", "ph": "M", "ts": 1638252373276561, "pid": 3, "tid": 7,
    "args": {
      "sort_index": 7
    }
  },
  {
    "name": "thread_name", "ph": "M", "ts": 1638252373276561, "pid": 2765, "tid": 2765,
    "args": {
      "name": "thread 2765 (python)"
    }
  },
  {
    "name": "thread_sort_index", "ph": "M", "ts": 1638252373276561, "pid": 2765, "tid": 2765,
    "args": {
      "sort_index": 2765
    }
  },
  {
    "ph": "X", "cat": "Trace", "ts": 1638252373276561, "dur": 135166,
    "pid": "Spans", "tid": "PyTorch Profiler",
    "name": "PyTorch Profiler (0)",
    "args": {
      "Op count": 0
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638252373276561,
    "pid": "Spans", "tid": 0,
    "args": {
      "sort_index": 536870912
    }
  },
  {
    "name": "Iteration Start: PyTorch Profiler", "ph": "i", "s": "g",
    "pid": "Traces", "tid": "Trace PyTorch Profiler", "ts": 1638252373276561
  },
  {
    "name": "Record Window End", "ph": "i", "s": "g",
    "pid": "", "tid": "", "ts": 1638252373426627
  }
]}