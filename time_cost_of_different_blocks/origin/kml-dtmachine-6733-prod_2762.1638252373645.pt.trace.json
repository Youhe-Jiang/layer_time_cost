
{
  "schemaVersion": 1,
  "distributedInfo": {"backend": "nccl", "rank": 0, "world_size": 4},
  "deviceProperties": [
    {
      "id": 0, "name": "GeForce RTX 2080 Ti", "totalGlobalMem": 11554717696,
      "computeMajor": 7, "computeMinor": 5,
      "maxThreadsPerBlock": 1024, "maxThreadsPerMultiprocessor": 1024,
      "regsPerBlock": 65536, "regsPerMultiprocessor": 65536, "warpSize": 32,
      "sharedMemPerBlock": 49152, "sharedMemPerMultiprocessor": 65536,
      "numSms": 68, "sharedMemPerBlockOptin": 65536
    },
    {
      "id": 1, "name": "GeForce RTX 2080 Ti", "totalGlobalMem": 11554717696,
      "computeMajor": 7, "computeMinor": 5,
      "maxThreadsPerBlock": 1024, "maxThreadsPerMultiprocessor": 1024,
      "regsPerBlock": 65536, "regsPerMultiprocessor": 65536, "warpSize": 32,
      "sharedMemPerBlock": 49152, "sharedMemPerMultiprocessor": 65536,
      "numSms": 68, "sharedMemPerBlockOptin": 65536
    },
    {
      "id": 2, "name": "GeForce RTX 2080 Ti", "totalGlobalMem": 11554717696,
      "computeMajor": 7, "computeMinor": 5,
      "maxThreadsPerBlock": 1024, "maxThreadsPerMultiprocessor": 1024,
      "regsPerBlock": 65536, "regsPerMultiprocessor": 65536, "warpSize": 32,
      "sharedMemPerBlock": 49152, "sharedMemPerMultiprocessor": 65536,
      "numSms": 68, "sharedMemPerBlockOptin": 65536
    },
    {
      "id": 3, "name": "GeForce RTX 2080 Ti", "totalGlobalMem": 11554717696,
      "computeMajor": 7, "computeMinor": 5,
      "maxThreadsPerBlock": 1024, "maxThreadsPerMultiprocessor": 1024,
      "regsPerBlock": 65536, "regsPerMultiprocessor": 65536, "warpSize": 32,
      "sharedMemPerBlock": 49152, "sharedMemPerMultiprocessor": 65536,
      "numSms": 68, "sharedMemPerBlockOptin": 65536
    }
  ],
  "traceEvents": [
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373278640,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005762092672, "Bytes": 4, "Total Allocated": 4, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373278634, "dur": 30,
    "args": {
       "External id": 2,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zero_", "pid": 2762, "tid": 2762,
    "ts": 1638252373278718, "dur": 1,
    "args": {
       "External id": 3,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zeros", "pid": 2762, "tid": 2762,
    "ts": 1638252373278551, "dur": 172,
    "args": {
       "External id": 1,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373278910,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94002641103360, "Bytes": 16, "Total Allocated": 20, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373278908, "dur": 9,
    "args": {
       "External id": 5,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(330): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373278919,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94002641103360, "Bytes": -16, "Total Allocated": 4, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373278943,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005762092672, "Bytes": -4, "Total Allocated": 0, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373279020,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005762087424, "Bytes": 4, "Total Allocated": 4, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373279019, "dur": 8,
    "args": {
       "External id": 7,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zero_", "pid": 2762, "tid": 2762,
    "ts": 1638252373279054, "dur": 1,
    "args": {
       "External id": 8,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zeros", "pid": 2762, "tid": 2762,
    "ts": 1638252373278992, "dur": 65,
    "args": {
       "External id": 6,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373279213,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005762123328, "Bytes": 16, "Total Allocated": 20, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373279211, "dur": 6,
    "args": {
       "External id": 10,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373279219,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005762123328, "Bytes": -16, "Total Allocated": 4, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373279227,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005762087424, "Bytes": -4, "Total Allocated": 0, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "enumerate(DataLoader)#_MultiProcessingDataLoaderIter.__next__", "pid": 2762, "tid": 2762,
    "ts": 1638252373279112, "dur": 313,
    "args": {
       "External id": 9,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;"
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373279472,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533041664, "Bytes": -24576, "Total Allocated": 143006720, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373279478,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533066240, "Bytes": -24576, "Total Allocated": 142982144, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373279767,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533041664, "Bytes": 24576, "Total Allocated": 143006720, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373279755, "dur": 19,
    "args": {
       "External id": 13,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373279801, "dur": 44,
    "args": {
       "External id": 14,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2762, "tid": 2762,
    "ts": 1638252373279730, "dur": 118,
    "args": {
       "External id": 12,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""], "Fwd thread id": 0, "Sequence number": 161
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373279703, "dur": 147,
    "args": {
       "External id": 11,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 161
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373279923,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533066240, "Bytes": 24576, "Total Allocated": 143031296, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373279915, "dur": 15,
    "args": {
       "External id": 17,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373279949, "dur": 33,
    "args": {
       "External id": 18,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2762, "tid": 2762,
    "ts": 1638252373279894, "dur": 90,
    "args": {
       "External id": 16,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""], "Fwd thread id": 0, "Sequence number": 161
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373279875, "dur": 110,
    "args": {
       "External id": 15,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 161
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373280402, "dur": 1,
    "args": {
       "External id": 19,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(479): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 161
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373280439, "dur": 0,
    "args": {
       "External id": 20,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(481): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 161
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2762, "tid": 2762,
    "ts": 1638252373280657, "dur": 1,
    "args": {
       "External id": 21,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[7093632], [28374528]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1570): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373280731, "dur": 2,
    "args": {
       "External id": 23,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373280699, "dur": 55,
    "args": {
       "External id": 22,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373280790, "dur": 5,
    "args": {
       "External id": 24,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2762, "tid": 2762,
    "ts": 1638252373280824, "dur": 1,
    "args": {
       "External id": 25,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [28374528]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373281026, "dur": 1,
    "args": {
       "External id": 29,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373280996, "dur": 36,
    "args": {
       "External id": 28,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373280964, "dur": 71,
    "args": {
       "External id": 27,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373281128, "dur": 1,
    "args": {
       "External id": 32,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373281097, "dur": 34,
    "args": {
       "External id": 31,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373281066, "dur": 66,
    "args": {
       "External id": 30,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373281223, "dur": 1,
    "args": {
       "External id": 35,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373281193, "dur": 33,
    "args": {
       "External id": 34,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373281162, "dur": 66,
    "args": {
       "External id": 33,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373281320, "dur": 1,
    "args": {
       "External id": 38,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373281288, "dur": 35,
    "args": {
       "External id": 37,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373281257, "dur": 67,
    "args": {
       "External id": 36,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373281415, "dur": 0,
    "args": {
       "External id": 41,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373281384, "dur": 33,
    "args": {
       "External id": 40,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373281356, "dur": 63,
    "args": {
       "External id": 39,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373281508, "dur": 1,
    "args": {
       "External id": 44,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373281478, "dur": 33,
    "args": {
       "External id": 43,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373281450, "dur": 63,
    "args": {
       "External id": 42,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373281615, "dur": 1,
    "args": {
       "External id": 47,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373281579, "dur": 38,
    "args": {
       "External id": 46,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373281549, "dur": 70,
    "args": {
       "External id": 45,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373281709, "dur": 3,
    "args": {
       "External id": 50,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373281680, "dur": 34,
    "args": {
       "External id": 49,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373281651, "dur": 64,
    "args": {
       "External id": 48,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373281805, "dur": 1,
    "args": {
       "External id": 53,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373281774, "dur": 33,
    "args": {
       "External id": 52,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373281745, "dur": 64,
    "args": {
       "External id": 51,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373281898, "dur": 1,
    "args": {
       "External id": 56,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373281868, "dur": 33,
    "args": {
       "External id": 55,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373281838, "dur": 91,
    "args": {
       "External id": 54,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373282021, "dur": 1,
    "args": {
       "External id": 59,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373281992, "dur": 32,
    "args": {
       "External id": 58,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373281962, "dur": 63,
    "args": {
       "External id": 57,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373282116, "dur": 0,
    "args": {
       "External id": 62,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373282087, "dur": 31,
    "args": {
       "External id": 61,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373282055, "dur": 65,
    "args": {
       "External id": 60,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373282210, "dur": 1,
    "args": {
       "External id": 65,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373282181, "dur": 32,
    "args": {
       "External id": 64,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373282151, "dur": 63,
    "args": {
       "External id": 63,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373282307, "dur": 1,
    "args": {
       "External id": 68,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373282276, "dur": 34,
    "args": {
       "External id": 67,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373282246, "dur": 65,
    "args": {
       "External id": 66,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373282402, "dur": 1,
    "args": {
       "External id": 71,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373282371, "dur": 34,
    "args": {
       "External id": 70,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373282341, "dur": 69,
    "args": {
       "External id": 69,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373282500, "dur": 1,
    "args": {
       "External id": 74,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373282469, "dur": 33,
    "args": {
       "External id": 73,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373282439, "dur": 65,
    "args": {
       "External id": 72,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373282595, "dur": 0,
    "args": {
       "External id": 77,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373282564, "dur": 33,
    "args": {
       "External id": 76,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373282536, "dur": 63,
    "args": {
       "External id": 75,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373282695, "dur": 1,
    "args": {
       "External id": 80,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373282667, "dur": 31,
    "args": {
       "External id": 79,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373282636, "dur": 64,
    "args": {
       "External id": 78,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373282793, "dur": 1,
    "args": {
       "External id": 83,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373282764, "dur": 32,
    "args": {
       "External id": 82,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373282731, "dur": 67,
    "args": {
       "External id": 81,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373282890, "dur": 1,
    "args": {
       "External id": 86,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373282859, "dur": 36,
    "args": {
       "External id": 85,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373282829, "dur": 67,
    "args": {
       "External id": 84,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373282988, "dur": 1,
    "args": {
       "External id": 89,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373282956, "dur": 35,
    "args": {
       "External id": 88,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373282926, "dur": 66,
    "args": {
       "External id": 87,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::split_with_sizes", "pid": 2762, "tid": 2762,
    "ts": 1638252373280925, "dur": 2085,
    "args": {
       "External id": 26,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Int"], "Fwd thread id": 0, "Sequence number": 161
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373283053, "dur": 7,
    "args": {
       "External id": 90,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9216], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 162
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373283104, "dur": 4,
    "args": {
       "External id": 91,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[15360], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 163
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373283142, "dur": 4,
    "args": {
       "External id": 92,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 164
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373283181, "dur": 4,
    "args": {
       "External id": 93,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 165
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373283219, "dur": 4,
    "args": {
       "External id": 94,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 166
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373283255, "dur": 4,
    "args": {
       "External id": 95,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 167
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373283293, "dur": 4,
    "args": {
       "External id": 96,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 168
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373283333, "dur": 4,
    "args": {
       "External id": 97,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 169
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373283372, "dur": 4,
    "args": {
       "External id": 98,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 170
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373283408, "dur": 6,
    "args": {
       "External id": 99,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 171
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373283445, "dur": 6,
    "args": {
       "External id": 100,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 172
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373283483, "dur": 3,
    "args": {
       "External id": 101,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 173
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373283519, "dur": 4,
    "args": {
       "External id": 102,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 174
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373283557, "dur": 3,
    "args": {
       "External id": 103,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 175
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373283595, "dur": 4,
    "args": {
       "External id": 104,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 176
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373283640, "dur": 3,
    "args": {
       "External id": 105,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 177
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373283675, "dur": 5,
    "args": {
       "External id": 106,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 178
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373283712, "dur": 3,
    "args": {
       "External id": 107,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 179
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373283749, "dur": 4,
    "args": {
       "External id": 108,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 180
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373283786, "dur": 4,
    "args": {
       "External id": 109,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 181
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373283824, "dur": 3,
    "args": {
       "External id": 110,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[15360], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 182
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373283920, "dur": 3,
    "args": {
       "External id": 111,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373283957, "dur": 1,
    "args": {
       "External id": 112,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 183
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "detach_", "pid": 2762, "tid": 2762,
    "ts": 1638252373284014, "dur": 1,
    "args": {
       "External id": 114,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::detach_", "pid": 2762, "tid": 2762,
    "ts": 1638252373283988, "dur": 28,
    "args": {
       "External id": 113,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"], "Fwd thread id": 0, "Sequence number": 183
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373284077,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005762467904, "Bytes": 5056, "Total Allocated": 5056, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373284105,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005762107456, "Bytes": 816, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373284224, "dur": 10,
    "args": {
       "External id": 118,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373284266, "dur": 30,
    "args": {
       "External id": 119,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2762, "tid": 2762,
    "ts": 1638252373284191, "dur": 147,
    "args": {
       "External id": 117,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373284161, "dur": 179,
    "args": {
       "External id": 116,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373284439, "dur": 6,
    "args": {
       "External id": 122,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373284479, "dur": 20,
    "args": {
       "External id": 123,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2762, "tid": 2762,
    "ts": 1638252373284409, "dur": 92,
    "args": {
       "External id": 121,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373284379, "dur": 124,
    "args": {
       "External id": 120,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 2762, "tid": 2762,
    "ts": 1638252373284676, "dur": 3,
    "args": {
       "External id": 126,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2762, "tid": 2762,
    "ts": 1638252373284639, "dur": 42,
    "args": {
       "External id": 125,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373284758, "dur": 6,
    "args": {
       "External id": 128,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373284819,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395333812224, "Bytes": 18874368, "Total Allocated": 161905664, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2762, "tid": 2762,
    "ts": 1638252373284812, "dur": 14,
    "args": {
       "External id": 129,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::index_select", "pid": 2762, "tid": 2762,
    "ts": 1638252373284718, "dur": 143,
    "args": {
       "External id": 127,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], [3072]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "long int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373284905, "dur": 3,
    "args": {
       "External id": 130,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::embedding", "pid": 2762, "tid": 2762,
    "ts": 1638252373284594, "dur": 318,
    "args": {
       "External id": 124,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [512, 6], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "Int", "Bool", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373284989, "dur": 1,
    "args": {
       "External id": 132,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373284955, "dur": 39,
    "args": {
       "External id": 131,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373285057, "dur": 1,
    "args": {
       "External id": 134,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373285025, "dur": 38,
    "args": {
       "External id": 133,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373285130,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": 18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 2762, "tid": 2762,
    "ts": 1638252373285119, "dur": 42,
    "args": {
       "External id": 135,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373285362,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395375755264, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373285348, "dur": 21,
    "args": {
       "External id": 139,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373285312, "dur": 60,
    "args": {
       "External id": 138,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373285450,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395394629632, "Bytes": 4718592, "Total Allocated": 204372992, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373285443, "dur": 13,
    "args": {
       "External id": 141,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373285407, "dur": 54,
    "args": {
       "External id": 140,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373285270, "dur": 218,
    "args": {
       "External id": 137,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373285491,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395394629632, "Bytes": -4718592, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373285227, "dur": 268,
    "args": {
       "External id": 136,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373285501,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373285695,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395394629632, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373285690, "dur": 13,
    "args": {
       "External id": 144,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373285752,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091840, "Bytes": 12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373285748, "dur": 9,
    "args": {
       "External id": 145,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373285805,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533104128, "Bytes": 12288, "Total Allocated": 199678976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373285802, "dur": 8,
    "args": {
       "External id": 146,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373285889, "dur": 3,
    "args": {
       "External id": 147,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373285936, "dur": 1,
    "args": {
       "External id": 148,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373285644, "dur": 298,
    "args": {
       "External id": 143,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373285946,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091840, "Bytes": -12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373285950,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533104128, "Bytes": -12288, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373285586, "dur": 368,
    "args": {
       "External id": 142,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373286172, "dur": 1,
    "args": {
       "External id": 152,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373286125, "dur": 51,
    "args": {
       "External id": 151,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373286075, "dur": 105,
    "args": {
       "External id": 150,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373286275, "dur": 3,
    "args": {
       "External id": 154,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373286339,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": 18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373286331, "dur": 74,
    "args": {
       "External id": 155,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373286508, "dur": 2,
    "args": {
       "External id": 157,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373286463, "dur": 49,
    "args": {
       "External id": 156,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373286229, "dur": 286,
    "args": {
       "External id": 153,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373286567, "dur": 29,
    "args": {
       "External id": 158,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373286028, "dur": 570,
    "args": {
       "External id": 149,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373286656, "dur": 4,
    "args": {
       "External id": 159,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373286753, "dur": 2,
    "args": {
       "External id": 161,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373286705, "dur": 53,
    "args": {
       "External id": 160,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373286956, "dur": 1,
    "args": {
       "External id": 165,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373286911, "dur": 48,
    "args": {
       "External id": 164,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373286866, "dur": 96,
    "args": {
       "External id": 163,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373287055, "dur": 2,
    "args": {
       "External id": 167,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373287114,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373287107, "dur": 68,
    "args": {
       "External id": 168,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373287273, "dur": 1,
    "args": {
       "External id": 170,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373287228, "dur": 49,
    "args": {
       "External id": 169,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373287009, "dur": 271,
    "args": {
       "External id": 166,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373287326, "dur": 26,
    "args": {
       "External id": 171,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373286818, "dur": 537,
    "args": {
       "External id": 162,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373287404, "dur": 3,
    "args": {
       "External id": 172,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373287491, "dur": 2,
    "args": {
       "External id": 174,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373287449, "dur": 49,
    "args": {
       "External id": 173,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373287697, "dur": 2,
    "args": {
       "External id": 178,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373287653, "dur": 50,
    "args": {
       "External id": 177,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373287610, "dur": 96,
    "args": {
       "External id": 176,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373287795, "dur": 3,
    "args": {
       "External id": 180,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373287854,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395432378368, "Bytes": 18874368, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373287847, "dur": 63,
    "args": {
       "External id": 181,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373288007, "dur": 2,
    "args": {
       "External id": 183,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373287962, "dur": 51,
    "args": {
       "External id": 182,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373287750, "dur": 266,
    "args": {
       "External id": 179,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373288060, "dur": 25,
    "args": {
       "External id": 184,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373287557, "dur": 530,
    "args": {
       "External id": 175,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373288136, "dur": 3,
    "args": {
       "External id": 185,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373288225, "dur": 2,
    "args": {
       "External id": 187,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373288184, "dur": 46,
    "args": {
       "External id": 186,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373288312, "dur": 2,
    "args": {
       "External id": 189,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373288274, "dur": 44,
    "args": {
       "External id": 188,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373288455, "dur": 1,
    "args": {
       "External id": 192,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373288409, "dur": 51,
    "args": {
       "External id": 191,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373288641,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": 18874368, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373288635, "dur": 14,
    "args": {
       "External id": 196,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373288588, "dur": 64,
    "args": {
       "External id": 195,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373288695, "dur": 30,
    "args": {
       "External id": 197,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2762, "tid": 2762,
    "ts": 1638252373288547, "dur": 181,
    "args": {
       "External id": 194,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373288817, "dur": 2,
    "args": {
       "External id": 199,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373288777, "dur": 44,
    "args": {
       "External id": 198,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2762, "tid": 2762,
    "ts": 1638252373288505, "dur": 318,
    "args": {
       "External id": 193,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373288903, "dur": 2,
    "args": {
       "External id": 201,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373288863, "dur": 45,
    "args": {
       "External id": 200,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373289072,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": 18874368, "Total Allocated": 294026240, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373289067, "dur": 12,
    "args": {
       "External id": 205,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373289028, "dur": 53,
    "args": {
       "External id": 204,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373289124, "dur": 23,
    "args": {
       "External id": 206,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2762, "tid": 2762,
    "ts": 1638252373288989, "dur": 160,
    "args": {
       "External id": 203,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373289236, "dur": 1,
    "args": {
       "External id": 208,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373289196, "dur": 43,
    "args": {
       "External id": 207,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2762, "tid": 2762,
    "ts": 1638252373288949, "dur": 292,
    "args": {
       "External id": 202,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373289330,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391848345600, "Bytes": 3538944, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373289326, "dur": 11,
    "args": {
       "External id": 210,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 2762, "tid": 2762,
    "ts": 1638252373289284, "dur": 79,
    "args": {
       "External id": 209,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], [24576, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373289446, "dur": 2,
    "args": {
       "External id": 212,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373289407, "dur": 43,
    "args": {
       "External id": 211,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373289453,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373289458,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": -18874368, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373288360, "dur": 1102,
    "args": {
       "External id": 190,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373289478,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005762866944, "Bytes": 8, "Total Allocated": 5880, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373289539,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391851884544, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mul", "pid": 2762, "tid": 2762,
    "ts": 1638252373289530, "dur": 37,
    "args": {
       "External id": 213,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373289572,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005762866944, "Bytes": -8, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373289579,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391848345600, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373289686, "dur": 2,
    "args": {
       "External id": 215,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373289644, "dur": 48,
    "args": {
       "External id": 214,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373289774, "dur": 0,
    "args": {
       "External id": 217,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373289733, "dur": 44,
    "args": {
       "External id": 216,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373289834,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005762889408, "Bytes": 8, "Total Allocated": 5880, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373289847,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533090816, "Bytes": 512, "Total Allocated": 259816960, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373289854,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005762889408, "Bytes": -8, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::eq", "pid": 2762, "tid": 2762,
    "ts": 1638252373289832, "dur": 46,
    "args": {
       "External id": 218,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373290015, "dur": 1,
    "args": {
       "External id": 221,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373289974, "dur": 128,
    "args": {
       "External id": 220,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373290184, "dur": 1,
    "args": {
       "External id": 223,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373290145, "dur": 43,
    "args": {
       "External id": 222,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373290311,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391855423488, "Bytes": 3538944, "Total Allocated": 263355904, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373290305, "dur": 13,
    "args": {
       "External id": 226,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373290267, "dur": 54,
    "args": {
       "External id": 225,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373290362, "dur": 32,
    "args": {
       "External id": 227,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2762, "tid": 2762,
    "ts": 1638252373290228, "dur": 169,
    "args": {
       "External id": 224,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373290526, "dur": 2,
    "args": {
       "External id": 230,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373290488, "dur": 42,
    "args": {
       "External id": 229,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill_", "pid": 2762, "tid": 2762,
    "ts": 1638252373290446, "dur": 111,
    "args": {
       "External id": 228,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill", "pid": 2762, "tid": 2762,
    "ts": 1638252373289933, "dur": 627,
    "args": {
       "External id": 219,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373290565,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533090816, "Bytes": -512, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373290571,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391851884544, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373290683,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391858962432, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_softmax", "pid": 2762, "tid": 2762,
    "ts": 1638252373290677, "dur": 34,
    "args": {
       "External id": 232,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::softmax", "pid": 2762, "tid": 2762,
    "ts": 1638252373290634, "dur": 80,
    "args": {
       "External id": 231,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373290718,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391855423488, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373290939,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391862501376, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373290929, "dur": 17,
    "args": {
       "External id": 236,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373290883, "dur": 66,
    "args": {
       "External id": 235,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373291049,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533398528, "Bytes": 884736, "Total Allocated": 264240128, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373291041, "dur": 16,
    "args": {
       "External id": 238,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373290996, "dur": 63,
    "args": {
       "External id": 237,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373290832, "dur": 255,
    "args": {
       "External id": 234,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373291090,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533398528, "Bytes": -884736, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373290789, "dur": 305,
    "args": {
       "External id": 233,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373291100,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391858962432, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373291233, "dur": 2,
    "args": {
       "External id": 241,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373291192, "dur": 46,
    "args": {
       "External id": 240,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 2762, "tid": 2762,
    "ts": 1638252373291324, "dur": 3,
    "args": {
       "External id": 243,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2762, "tid": 2762,
    "ts": 1638252373291282, "dur": 48,
    "args": {
       "External id": 242,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373291410, "dur": 1,
    "args": {
       "External id": 245,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373291370, "dur": 44,
    "args": {
       "External id": 244,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373291586,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391866040320, "Bytes": 18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373291581, "dur": 11,
    "args": {
       "External id": 249,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373291540, "dur": 56,
    "args": {
       "External id": 248,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373291648, "dur": 28,
    "args": {
       "External id": 250,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2762, "tid": 2762,
    "ts": 1638252373291500, "dur": 179,
    "args": {
       "External id": 247,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373291763, "dur": 2,
    "args": {
       "External id": 252,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373291722, "dur": 46,
    "args": {
       "External id": 251,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2762, "tid": 2762,
    "ts": 1638252373291456, "dur": 314,
    "args": {
       "External id": 246,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373291858,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373291854, "dur": 10,
    "args": {
       "External id": 254,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 2762, "tid": 2762,
    "ts": 1638252373291810, "dur": 79,
    "args": {
       "External id": 253,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], [24576, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373291975, "dur": 2,
    "args": {
       "External id": 256,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373291934, "dur": 45,
    "args": {
       "External id": 255,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373291982,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391866040320, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373291149, "dur": 838,
    "args": {
       "External id": 239,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373292076, "dur": 2,
    "args": {
       "External id": 258,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373292035, "dur": 48,
    "args": {
       "External id": 257,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373292256,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391866040320, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373292252, "dur": 10,
    "args": {
       "External id": 262,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373292213, "dur": 54,
    "args": {
       "External id": 261,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373292307, "dur": 25,
    "args": {
       "External id": 263,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2762, "tid": 2762,
    "ts": 1638252373292172, "dur": 163,
    "args": {
       "External id": 260,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::contiguous", "pid": 2762, "tid": 2762,
    "ts": 1638252373292135, "dur": 202,
    "args": {
       "External id": 259,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373292385, "dur": 4,
    "args": {
       "External id": 264,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373292393,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373292595, "dur": 1,
    "args": {
       "External id": 268,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373292550, "dur": 48,
    "args": {
       "External id": 267,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373292505, "dur": 103,
    "args": {
       "External id": 266,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373292703, "dur": 3,
    "args": {
       "External id": 270,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373292764,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373292757, "dur": 73,
    "args": {
       "External id": 271,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373292929, "dur": 2,
    "args": {
       "External id": 273,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373292884, "dur": 49,
    "args": {
       "External id": 272,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373292654, "dur": 282,
    "args": {
       "External id": 269,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373292982, "dur": 29,
    "args": {
       "External id": 274,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373292460, "dur": 553,
    "args": {
       "External id": 265,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373293234,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": 18874368, "Total Allocated": 316439552, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373293224, "dur": 18,
    "args": {
       "External id": 278,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373293179, "dur": 66,
    "args": {
       "External id": 277,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373293343,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391848345600, "Bytes": 4718592, "Total Allocated": 321158144, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373293335, "dur": 14,
    "args": {
       "External id": 280,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373293291, "dur": 60,
    "args": {
       "External id": 279,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373293125, "dur": 253,
    "args": {
       "External id": 276,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373293381,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391848345600, "Bytes": -4718592, "Total Allocated": 316439552, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373293080, "dur": 305,
    "args": {
       "External id": 275,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373293392,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": -18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373293398,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391866040320, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373293404,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": -18874368, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373293409,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": -18874368, "Total Allocated": 240942080, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373293416,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395432378368, "Bytes": -18874368, "Total Allocated": 222067712, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373293420,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391862501376, "Bytes": -3538944, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373293476,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 2762, "tid": 2762,
    "ts": 1638252373293468, "dur": 33,
    "args": {
       "External id": 281,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373293507,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": -18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373293759,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373293754, "dur": 11,
    "args": {
       "External id": 284,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373293816,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091840, "Bytes": 12288, "Total Allocated": 237415424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373293812, "dur": 9,
    "args": {
       "External id": 285,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373293915,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533104128, "Bytes": 12288, "Total Allocated": 237427712, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373293912, "dur": 11,
    "args": {
       "External id": 286,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373294005, "dur": 2,
    "args": {
       "External id": 287,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373294090, "dur": 1,
    "args": {
       "External id": 288,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373293707, "dur": 389,
    "args": {
       "External id": 283,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373294100,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091840, "Bytes": -12288, "Total Allocated": 237415424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373294104,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533104128, "Bytes": -12288, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373293582, "dur": 526,
    "args": {
       "External id": 282,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373294398, "dur": 2,
    "args": {
       "External id": 292,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373294352, "dur": 50,
    "args": {
       "External id": 291,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373294302, "dur": 104,
    "args": {
       "External id": 290,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373294535, "dur": 3,
    "args": {
       "External id": 294,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373294621,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140392213250048, "Bytes": 75497472, "Total Allocated": 312900608, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373294611, "dur": 57,
    "args": {
       "External id": 295,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373294855, "dur": 2,
    "args": {
       "External id": 297,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373294808, "dur": 53,
    "args": {
       "External id": 296,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373294453, "dur": 412,
    "args": {
       "External id": 293,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373294912, "dur": 30,
    "args": {
       "External id": 298,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373294212, "dur": 733,
    "args": {
       "External id": 289,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [6144, 1536], [6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373295020,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140396522897408, "Bytes": 75497472, "Total Allocated": 388398080, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::gelu", "pid": 2762, "tid": 2762,
    "ts": 1638252373295012, "dur": 36,
    "args": {
       "External id": 299,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1556): gelu;/miniconda/lib/python3.8/site-packages/torch/nn/modules/activation.py(652): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373295054,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140392213250048, "Bytes": -75497472, "Total Allocated": 312900608, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373295253, "dur": 2,
    "args": {
       "External id": 303,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373295203, "dur": 55,
    "args": {
       "External id": 302,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373295157, "dur": 104,
    "args": {
       "External id": 301,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373295358, "dur": 3,
    "args": {
       "External id": 305,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373295416,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": 18874368, "Total Allocated": 331774976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373295410, "dur": 62,
    "args": {
       "External id": 306,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373295570, "dur": 2,
    "args": {
       "External id": 308,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373295525, "dur": 53,
    "args": {
       "External id": 307,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373295307, "dur": 274,
    "args": {
       "External id": 304,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373295637, "dur": 26,
    "args": {
       "External id": 309,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373295113, "dur": 553,
    "args": {
       "External id": 300,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [1536, 6144], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373295673,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140396522897408, "Bytes": -75497472, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373295895,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395432378368, "Bytes": 18874368, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373295885, "dur": 17,
    "args": {
       "External id": 313,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373295840, "dur": 65,
    "args": {
       "External id": 312,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373296005,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": 4718592, "Total Allocated": 279870464, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373295997, "dur": 14,
    "args": {
       "External id": 315,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373295952, "dur": 62,
    "args": {
       "External id": 314,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373295790, "dur": 251,
    "args": {
       "External id": 311,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373296044,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": -4718592, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373295744, "dur": 304,
    "args": {
       "External id": 310,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373296052,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": -18874368, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373296061,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": -18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373296066,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395394629632, "Bytes": -18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373296070,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": -18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373296076,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395375755264, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373296222,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373296218, "dur": 10,
    "args": {
       "External id": 318,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373296270,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091840, "Bytes": 12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373296266, "dur": 9,
    "args": {
       "External id": 319,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373296316,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533104128, "Bytes": 12288, "Total Allocated": 199678976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373296313, "dur": 8,
    "args": {
       "External id": 320,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373296390, "dur": 2,
    "args": {
       "External id": 321,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373296430, "dur": 2,
    "args": {
       "External id": 322,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373296177, "dur": 259,
    "args": {
       "External id": 317,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373296439,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091840, "Bytes": -12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373296446,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533104128, "Bytes": -12288, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373296143, "dur": 306,
    "args": {
       "External id": 316,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373296454,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395432378368, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373296621, "dur": 1,
    "args": {
       "External id": 326,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373296576, "dur": 49,
    "args": {
       "External id": 325,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373296539, "dur": 89,
    "args": {
       "External id": 324,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373296700, "dur": 3,
    "args": {
       "External id": 328,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373296750,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533152768, "Bytes": 122880, "Total Allocated": 180902912, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373296743, "dur": 45,
    "args": {
       "External id": 329,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 10]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373296867, "dur": 2,
    "args": {
       "External id": 331,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373296831, "dur": 40,
    "args": {
       "External id": 330,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373296665, "dur": 209,
    "args": {
       "External id": 327,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 10]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373296506, "dur": 370,
    "args": {
       "External id": 323,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [10, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373296882,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": -18874368, "Total Allocated": 162028544, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373296923, "dur": 2,
    "args": {
       "External id": 332,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 10], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373296960, "dur": 2,
    "args": {
       "External id": 333,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373297080, "dur": 1,
    "args": {
       "External id": 336,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373297128,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533398528, "Bytes": 122880, "Total Allocated": 162151424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_log_softmax", "pid": 2762, "tid": 2762,
    "ts": 1638252373297122, "dur": 35,
    "args": {
       "External id": 337,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::log_softmax", "pid": 2762, "tid": 2762,
    "ts": 1638252373297047, "dur": 112,
    "args": {
       "External id": 335,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373297275,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533090816, "Bytes": 512, "Total Allocated": 162151936, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373297282,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091840, "Bytes": 512, "Total Allocated": 162152448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2762, "tid": 2762,
    "ts": 1638252373297321, "dur": 0,
    "args": {
       "External id": 341,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2762, "tid": 2762,
    "ts": 1638252373297358, "dur": 0,
    "args": {
       "External id": 342,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss_forward", "pid": 2762, "tid": 2762,
    "ts": 1638252373297270, "dur": 111,
    "args": {
       "External id": 340,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373297384,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091840, "Bytes": -512, "Total Allocated": 162151936, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss", "pid": 2762, "tid": 2762,
    "ts": 1638252373297237, "dur": 151,
    "args": {
       "External id": 339,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss_nd", "pid": 2762, "tid": 2762,
    "ts": 1638252373297202, "dur": 188,
    "args": {
       "External id": 338,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373297394,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533398528, "Bytes": -122880, "Total Allocated": 162029056, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::cross_entropy_loss", "pid": 2762, "tid": 2762,
    "ts": 1638252373297010, "dur": 388,
    "args": {
       "External id": 334,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373297404,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395333812224, "Bytes": -18874368, "Total Allocated": 143154688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "CheckpointFunction", "pid": 2762, "tid": 2762,
    "ts": 1638252373284046, "dur": 13466,
    "args": {
       "External id": 115,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Fwd thread id": 0, "Sequence number": 183
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2762, "tid": 2762,
    "ts": 1638252373297567, "dur": 1,
    "args": {
       "External id": 343,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [7093632]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1822): _use_fp32_param_shard;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1153): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373297643,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533275648, "Bytes": -122880, "Total Allocated": 143031808, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373297717,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091328, "Bytes": -512, "Total Allocated": 143031296, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "ProfilerStep#6", "pid": 2762, "tid": 2762,
    "ts": 1638252373278838, "dur": 27556,
    "args": {
       "External id": 4,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(330): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;"
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373306478,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94003813907776, "Bytes": 4, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373306476, "dur": 9,
    "args": {
       "External id": 345,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zero_", "pid": 2762, "tid": 2762,
    "ts": 1638252373306508, "dur": 1,
    "args": {
       "External id": 346,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zeros", "pid": 2762, "tid": 2762,
    "ts": 1638252373306452, "dur": 59,
    "args": {
       "External id": 344,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373306565,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005763460160, "Bytes": 16, "Total Allocated": 5892, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373306564, "dur": 6,
    "args": {
       "External id": 348,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(330): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373306574,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005763460160, "Bytes": -16, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373306581,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94003813907776, "Bytes": -4, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373306982,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005763466688, "Bytes": 4, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373306980, "dur": 7,
    "args": {
       "External id": 350,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zero_", "pid": 2762, "tid": 2762,
    "ts": 1638252373307012, "dur": 1,
    "args": {
       "External id": 351,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zeros", "pid": 2762, "tid": 2762,
    "ts": 1638252373306954, "dur": 61,
    "args": {
       "External id": 349,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373307072,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005763472640, "Bytes": 16, "Total Allocated": 5892, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373307071, "dur": 6,
    "args": {
       "External id": 353,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373307078,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005763472640, "Bytes": -16, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373307085,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005763466688, "Bytes": -4, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "enumerate(DataLoader)#_MultiProcessingDataLoaderIter.__next__", "pid": 2762, "tid": 2762,
    "ts": 1638252373307049, "dur": 225,
    "args": {
       "External id": 352,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;"
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373307364,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533041664, "Bytes": -24576, "Total Allocated": 143006720, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373307370,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533066240, "Bytes": -24576, "Total Allocated": 142982144, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373307474,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533041664, "Bytes": 24576, "Total Allocated": 143006720, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373307462, "dur": 18,
    "args": {
       "External id": 356,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373307505, "dur": 44,
    "args": {
       "External id": 357,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2762, "tid": 2762,
    "ts": 1638252373307441, "dur": 111,
    "args": {
       "External id": 355,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""], "Fwd thread id": 0, "Sequence number": 184
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373307417, "dur": 136,
    "args": {
       "External id": 354,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 184
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373307634,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533066240, "Bytes": 24576, "Total Allocated": 143031296, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373307625, "dur": 16,
    "args": {
       "External id": 360,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373307661, "dur": 33,
    "args": {
       "External id": 361,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2762, "tid": 2762,
    "ts": 1638252373307596, "dur": 100,
    "args": {
       "External id": 359,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""], "Fwd thread id": 0, "Sequence number": 184
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373307577, "dur": 120,
    "args": {
       "External id": 358,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 184
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373308268, "dur": 1,
    "args": {
       "External id": 362,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(479): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 184
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373308302, "dur": 1,
    "args": {
       "External id": 363,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(481): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 184
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2762, "tid": 2762,
    "ts": 1638252373308499, "dur": 1,
    "args": {
       "External id": 364,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[7093632], [28374528]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1570): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373308565, "dur": 2,
    "args": {
       "External id": 366,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373308538, "dur": 33,
    "args": {
       "External id": 365,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373308611, "dur": 5,
    "args": {
       "External id": 367,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2762, "tid": 2762,
    "ts": 1638252373308651, "dur": 0,
    "args": {
       "External id": 368,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [28374528]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373308831, "dur": 1,
    "args": {
       "External id": 372,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373308797, "dur": 37,
    "args": {
       "External id": 371,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373308766, "dur": 70,
    "args": {
       "External id": 370,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373308933, "dur": 1,
    "args": {
       "External id": 375,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373308898, "dur": 38,
    "args": {
       "External id": 374,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373308869, "dur": 68,
    "args": {
       "External id": 373,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373309028, "dur": 1,
    "args": {
       "External id": 378,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373308997, "dur": 33,
    "args": {
       "External id": 377,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373308969, "dur": 63,
    "args": {
       "External id": 376,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373309123, "dur": 1,
    "args": {
       "External id": 381,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373309092, "dur": 33,
    "args": {
       "External id": 380,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373309063, "dur": 64,
    "args": {
       "External id": 379,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373309218, "dur": 1,
    "args": {
       "External id": 384,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373309189, "dur": 34,
    "args": {
       "External id": 383,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373309158, "dur": 67,
    "args": {
       "External id": 382,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373309315, "dur": 3,
    "args": {
       "External id": 387,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373309286, "dur": 34,
    "args": {
       "External id": 386,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373309256, "dur": 65,
    "args": {
       "External id": 385,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373309412, "dur": 0,
    "args": {
       "External id": 390,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373309380, "dur": 34,
    "args": {
       "External id": 389,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373309350, "dur": 66,
    "args": {
       "External id": 388,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373309507, "dur": 1,
    "args": {
       "External id": 393,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373309476, "dur": 33,
    "args": {
       "External id": 392,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373309445, "dur": 66,
    "args": {
       "External id": 391,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373309608, "dur": 1,
    "args": {
       "External id": 396,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373309570, "dur": 41,
    "args": {
       "External id": 395,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373309542, "dur": 71,
    "args": {
       "External id": 394,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373309707, "dur": 1,
    "args": {
       "External id": 399,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373309672, "dur": 38,
    "args": {
       "External id": 398,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373309644, "dur": 67,
    "args": {
       "External id": 397,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373309802, "dur": 0,
    "args": {
       "External id": 402,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373309773, "dur": 31,
    "args": {
       "External id": 401,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373309743, "dur": 63,
    "args": {
       "External id": 400,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373309897, "dur": 1,
    "args": {
       "External id": 405,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373309867, "dur": 194,
    "args": {
       "External id": 404,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373309837, "dur": 226,
    "args": {
       "External id": 403,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373310157, "dur": 1,
    "args": {
       "External id": 408,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373310128, "dur": 32,
    "args": {
       "External id": 407,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373310098, "dur": 63,
    "args": {
       "External id": 406,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373310249, "dur": 1,
    "args": {
       "External id": 411,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373310220, "dur": 32,
    "args": {
       "External id": 410,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373310191, "dur": 62,
    "args": {
       "External id": 409,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373310341, "dur": 0,
    "args": {
       "External id": 414,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373310312, "dur": 31,
    "args": {
       "External id": 413,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373310283, "dur": 62,
    "args": {
       "External id": 412,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373310431, "dur": 1,
    "args": {
       "External id": 417,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373310403, "dur": 31,
    "args": {
       "External id": 416,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373310374, "dur": 64,
    "args": {
       "External id": 415,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373310525, "dur": 0,
    "args": {
       "External id": 420,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373310496, "dur": 31,
    "args": {
       "External id": 419,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373310467, "dur": 62,
    "args": {
       "External id": 418,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373310621, "dur": 1,
    "args": {
       "External id": 423,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373310587, "dur": 37,
    "args": {
       "External id": 422,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373310559, "dur": 66,
    "args": {
       "External id": 421,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373310713, "dur": 0,
    "args": {
       "External id": 426,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373310684, "dur": 31,
    "args": {
       "External id": 425,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373310655, "dur": 62,
    "args": {
       "External id": 424,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373310804, "dur": 0,
    "args": {
       "External id": 429,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373310775, "dur": 31,
    "args": {
       "External id": 428,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373310747, "dur": 61,
    "args": {
       "External id": 427,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373310895, "dur": 0,
    "args": {
       "External id": 432,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373310866, "dur": 38,
    "args": {
       "External id": 431,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373310837, "dur": 68,
    "args": {
       "External id": 430,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::split_with_sizes", "pid": 2762, "tid": 2762,
    "ts": 1638252373308729, "dur": 2191,
    "args": {
       "External id": 369,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Int"], "Fwd thread id": 0, "Sequence number": 184
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373310965, "dur": 6,
    "args": {
       "External id": 433,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9216], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 185
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373311009, "dur": 4,
    "args": {
       "External id": 434,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[15360], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 186
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373311046, "dur": 3,
    "args": {
       "External id": 435,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 187
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373311082, "dur": 4,
    "args": {
       "External id": 436,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 188
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373311118, "dur": 3,
    "args": {
       "External id": 437,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 189
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373311157, "dur": 4,
    "args": {
       "External id": 438,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 190
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373311196, "dur": 3,
    "args": {
       "External id": 439,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 191
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373311233, "dur": 3,
    "args": {
       "External id": 440,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 192
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373311270, "dur": 4,
    "args": {
       "External id": 441,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 193
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373311308, "dur": 3,
    "args": {
       "External id": 442,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 194
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373311345, "dur": 4,
    "args": {
       "External id": 443,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 195
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373311384, "dur": 5,
    "args": {
       "External id": 444,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 196
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373311421, "dur": 5,
    "args": {
       "External id": 445,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 197
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373311458, "dur": 3,
    "args": {
       "External id": 446,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 198
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373311495, "dur": 3,
    "args": {
       "External id": 447,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 199
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373311532, "dur": 3,
    "args": {
       "External id": 448,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 200
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373311569, "dur": 3,
    "args": {
       "External id": 449,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 201
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373311609, "dur": 5,
    "args": {
       "External id": 450,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 202
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373311646, "dur": 4,
    "args": {
       "External id": 451,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 203
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373311683, "dur": 3,
    "args": {
       "External id": 452,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 204
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373311720, "dur": 3,
    "args": {
       "External id": 453,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[15360], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 205
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373311816, "dur": 3,
    "args": {
       "External id": 454,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373311849, "dur": 1,
    "args": {
       "External id": 455,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 206
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "detach_", "pid": 2762, "tid": 2762,
    "ts": 1638252373311905, "dur": 1,
    "args": {
       "External id": 457,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::detach_", "pid": 2762, "tid": 2762,
    "ts": 1638252373311879, "dur": 28,
    "args": {
       "External id": 456,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"], "Fwd thread id": 0, "Sequence number": 206
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373311968,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005763959616, "Bytes": 5056, "Total Allocated": 10928, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373312001,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005762398976, "Bytes": 816, "Total Allocated": 11744, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373312121, "dur": 22,
    "args": {
       "External id": 461,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373312176, "dur": 28,
    "args": {
       "External id": 462,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2762, "tid": 2762,
    "ts": 1638252373312088, "dur": 118,
    "args": {
       "External id": 460,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373312057, "dur": 151,
    "args": {
       "External id": 459,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373312306, "dur": 6,
    "args": {
       "External id": 465,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373312345, "dur": 18,
    "args": {
       "External id": 466,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2762, "tid": 2762,
    "ts": 1638252373312276, "dur": 90,
    "args": {
       "External id": 464,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373312246, "dur": 121,
    "args": {
       "External id": 463,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 2762, "tid": 2762,
    "ts": 1638252373312530, "dur": 2,
    "args": {
       "External id": 469,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2762, "tid": 2762,
    "ts": 1638252373312493, "dur": 42,
    "args": {
       "External id": 468,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373312618, "dur": 7,
    "args": {
       "External id": 471,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373312672,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395333812224, "Bytes": 18874368, "Total Allocated": 161905664, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2762, "tid": 2762,
    "ts": 1638252373312665, "dur": 14,
    "args": {
       "External id": 472,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::index_select", "pid": 2762, "tid": 2762,
    "ts": 1638252373312572, "dur": 147,
    "args": {
       "External id": 470,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], [3072]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "long int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373312756, "dur": 2,
    "args": {
       "External id": 473,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::embedding", "pid": 2762, "tid": 2762,
    "ts": 1638252373312457, "dur": 305,
    "args": {
       "External id": 467,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [512, 6], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "Int", "Bool", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373312842, "dur": 1,
    "args": {
       "External id": 475,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373312808, "dur": 39,
    "args": {
       "External id": 474,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373312909, "dur": 1,
    "args": {
       "External id": 477,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373312878, "dur": 34,
    "args": {
       "External id": 476,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373312968,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": 18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 2762, "tid": 2762,
    "ts": 1638252373312958, "dur": 40,
    "args": {
       "External id": 478,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373313184,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395375755264, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373313174, "dur": 18,
    "args": {
       "External id": 482,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373313137, "dur": 57,
    "args": {
       "External id": 481,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373313277,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395394629632, "Bytes": 4718592, "Total Allocated": 204372992, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373313269, "dur": 14,
    "args": {
       "External id": 484,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373313232, "dur": 55,
    "args": {
       "External id": 483,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373313092, "dur": 222,
    "args": {
       "External id": 480,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373313317,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395394629632, "Bytes": -4718592, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373313057, "dur": 264,
    "args": {
       "External id": 479,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373313327,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373313503,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395394629632, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373313499, "dur": 13,
    "args": {
       "External id": 487,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373313561,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091328, "Bytes": 12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373313558, "dur": 9,
    "args": {
       "External id": 488,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373313622,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533103616, "Bytes": 12288, "Total Allocated": 199678976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373313618, "dur": 9,
    "args": {
       "External id": 489,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373313705, "dur": 3,
    "args": {
       "External id": 490,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373313752, "dur": 1,
    "args": {
       "External id": 491,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373313453, "dur": 305,
    "args": {
       "External id": 486,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373313763,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091328, "Bytes": -12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373313768,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533103616, "Bytes": -12288, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373313406, "dur": 365,
    "args": {
       "External id": 485,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373313981, "dur": 2,
    "args": {
       "External id": 495,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373313935, "dur": 50,
    "args": {
       "External id": 494,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373313887, "dur": 102,
    "args": {
       "External id": 493,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373314080, "dur": 3,
    "args": {
       "External id": 497,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373314137,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": 18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373314130, "dur": 74,
    "args": {
       "External id": 498,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373314303, "dur": 2,
    "args": {
       "External id": 500,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373314258, "dur": 49,
    "args": {
       "External id": 499,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373314035, "dur": 276,
    "args": {
       "External id": 496,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373314356, "dur": 29,
    "args": {
       "External id": 501,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373313842, "dur": 545,
    "args": {
       "External id": 492,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373314440, "dur": 4,
    "args": {
       "External id": 502,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373314531, "dur": 2,
    "args": {
       "External id": 504,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373314489, "dur": 47,
    "args": {
       "External id": 503,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373314738, "dur": 1,
    "args": {
       "External id": 508,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373314693, "dur": 48,
    "args": {
       "External id": 507,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373314648, "dur": 96,
    "args": {
       "External id": 506,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373314841, "dur": 3,
    "args": {
       "External id": 510,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373314899,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373314892, "dur": 65,
    "args": {
       "External id": 511,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373315055, "dur": 2,
    "args": {
       "External id": 513,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373315010, "dur": 49,
    "args": {
       "External id": 512,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373314796, "dur": 266,
    "args": {
       "External id": 509,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373315109, "dur": 27,
    "args": {
       "External id": 514,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373314595, "dur": 543,
    "args": {
       "External id": 505,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373315186, "dur": 3,
    "args": {
       "External id": 515,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373315277, "dur": 1,
    "args": {
       "External id": 517,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373315235, "dur": 46,
    "args": {
       "External id": 516,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373315477, "dur": 1,
    "args": {
       "External id": 521,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373315432, "dur": 48,
    "args": {
       "External id": 520,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373315384, "dur": 99,
    "args": {
       "External id": 519,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373315574, "dur": 3,
    "args": {
       "External id": 523,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373315640,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395432378368, "Bytes": 18874368, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373315633, "dur": 64,
    "args": {
       "External id": 524,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373315797, "dur": 2,
    "args": {
       "External id": 526,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373315749, "dur": 52,
    "args": {
       "External id": 525,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373315528, "dur": 276,
    "args": {
       "External id": 522,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373315849, "dur": 27,
    "args": {
       "External id": 527,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373315340, "dur": 538,
    "args": {
       "External id": 518,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373315928, "dur": 3,
    "args": {
       "External id": 528,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373316016, "dur": 2,
    "args": {
       "External id": 530,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373315975, "dur": 46,
    "args": {
       "External id": 529,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373316105, "dur": 2,
    "args": {
       "External id": 532,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373316065, "dur": 44,
    "args": {
       "External id": 531,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373316237, "dur": 1,
    "args": {
       "External id": 535,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373316196, "dur": 45,
    "args": {
       "External id": 534,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373316408,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": 18874368, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373316402, "dur": 14,
    "args": {
       "External id": 539,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373316362, "dur": 58,
    "args": {
       "External id": 538,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373316461, "dur": 29,
    "args": {
       "External id": 540,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2762, "tid": 2762,
    "ts": 1638252373316324, "dur": 169,
    "args": {
       "External id": 537,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373316580, "dur": 2,
    "args": {
       "External id": 542,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373316541, "dur": 43,
    "args": {
       "External id": 541,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2762, "tid": 2762,
    "ts": 1638252373316283, "dur": 304,
    "args": {
       "External id": 536,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373316676, "dur": 2,
    "args": {
       "External id": 544,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373316636, "dur": 45,
    "args": {
       "External id": 543,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373316844,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": 18874368, "Total Allocated": 294026240, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373316839, "dur": 12,
    "args": {
       "External id": 548,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373316800, "dur": 55,
    "args": {
       "External id": 547,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373316895, "dur": 24,
    "args": {
       "External id": 549,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2762, "tid": 2762,
    "ts": 1638252373316762, "dur": 159,
    "args": {
       "External id": 546,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373317004, "dur": 1,
    "args": {
       "External id": 551,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373316964, "dur": 43,
    "args": {
       "External id": 550,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2762, "tid": 2762,
    "ts": 1638252373316723, "dur": 286,
    "args": {
       "External id": 545,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373317099,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391848345600, "Bytes": 3538944, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373317095, "dur": 11,
    "args": {
       "External id": 553,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 2762, "tid": 2762,
    "ts": 1638252373317052, "dur": 79,
    "args": {
       "External id": 552,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], [24576, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373317214, "dur": 2,
    "args": {
       "External id": 555,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373317175, "dur": 45,
    "args": {
       "External id": 554,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373317224,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373317228,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": -18874368, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373316153, "dur": 1079,
    "args": {
       "External id": 533,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373317248,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005764306688, "Bytes": 8, "Total Allocated": 11752, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373317312,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391851884544, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mul", "pid": 2762, "tid": 2762,
    "ts": 1638252373317302, "dur": 37,
    "args": {
       "External id": 556,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373317344,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005764306688, "Bytes": -8, "Total Allocated": 11744, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373317351,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391848345600, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373317452, "dur": 2,
    "args": {
       "External id": 558,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373317410, "dur": 48,
    "args": {
       "External id": 557,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373317540, "dur": 1,
    "args": {
       "External id": 560,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373317500, "dur": 44,
    "args": {
       "External id": 559,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373317596,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005764329472, "Bytes": 8, "Total Allocated": 11752, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373317616,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091328, "Bytes": 512, "Total Allocated": 259816960, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373317625,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005764329472, "Bytes": -8, "Total Allocated": 11744, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::eq", "pid": 2762, "tid": 2762,
    "ts": 1638252373317591, "dur": 59,
    "args": {
       "External id": 561,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373317784, "dur": 5,
    "args": {
       "External id": 564,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373317745, "dur": 48,
    "args": {
       "External id": 563,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373317872, "dur": 1,
    "args": {
       "External id": 566,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373317832, "dur": 44,
    "args": {
       "External id": 565,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373318002,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391855423488, "Bytes": 3538944, "Total Allocated": 263355904, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373317998, "dur": 11,
    "args": {
       "External id": 569,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373317957, "dur": 55,
    "args": {
       "External id": 568,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373318054, "dur": 32,
    "args": {
       "External id": 570,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2762, "tid": 2762,
    "ts": 1638252373317917, "dur": 172,
    "args": {
       "External id": 567,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373318222, "dur": 1,
    "args": {
       "External id": 573,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373318182, "dur": 43,
    "args": {
       "External id": 572,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill_", "pid": 2762, "tid": 2762,
    "ts": 1638252373318138, "dur": 114,
    "args": {
       "External id": 571,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill", "pid": 2762, "tid": 2762,
    "ts": 1638252373317703, "dur": 553,
    "args": {
       "External id": 562,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373318261,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091328, "Bytes": -512, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373318267,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391851884544, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373318366,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391858962432, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_softmax", "pid": 2762, "tid": 2762,
    "ts": 1638252373318361, "dur": 35,
    "args": {
       "External id": 575,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::softmax", "pid": 2762, "tid": 2762,
    "ts": 1638252373318320, "dur": 79,
    "args": {
       "External id": 574,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373318403,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391855423488, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373318635,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391862501376, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373318625, "dur": 17,
    "args": {
       "External id": 579,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373318572, "dur": 73,
    "args": {
       "External id": 578,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373318745,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533275648, "Bytes": 884736, "Total Allocated": 264240128, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373318737, "dur": 14,
    "args": {
       "External id": 581,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373318693, "dur": 60,
    "args": {
       "External id": 580,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373318521, "dur": 260,
    "args": {
       "External id": 577,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373318786,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533275648, "Bytes": -884736, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373318475, "dur": 316,
    "args": {
       "External id": 576,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373318796,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391858962432, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373318925, "dur": 2,
    "args": {
       "External id": 584,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373318886, "dur": 47,
    "args": {
       "External id": 583,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 2762, "tid": 2762,
    "ts": 1638252373319014, "dur": 3,
    "args": {
       "External id": 586,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2762, "tid": 2762,
    "ts": 1638252373318973, "dur": 46,
    "args": {
       "External id": 585,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373319101, "dur": 1,
    "args": {
       "External id": 588,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373319061, "dur": 44,
    "args": {
       "External id": 587,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373319279,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391866040320, "Bytes": 18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373319274, "dur": 15,
    "args": {
       "External id": 592,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373319227, "dur": 64,
    "args": {
       "External id": 591,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373319331, "dur": 28,
    "args": {
       "External id": 593,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2762, "tid": 2762,
    "ts": 1638252373319188, "dur": 176,
    "args": {
       "External id": 590,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373319448, "dur": 2,
    "args": {
       "External id": 595,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373319407, "dur": 45,
    "args": {
       "External id": 594,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2762, "tid": 2762,
    "ts": 1638252373319148, "dur": 306,
    "args": {
       "External id": 589,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373319544,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373319540, "dur": 11,
    "args": {
       "External id": 597,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 2762, "tid": 2762,
    "ts": 1638252373319497, "dur": 78,
    "args": {
       "External id": 596,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], [24576, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373319666, "dur": 2,
    "args": {
       "External id": 599,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373319626, "dur": 45,
    "args": {
       "External id": 598,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373319674,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391866040320, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373318844, "dur": 835,
    "args": {
       "External id": 582,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373319764, "dur": 2,
    "args": {
       "External id": 601,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373319725, "dur": 44,
    "args": {
       "External id": 600,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373319946,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391866040320, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373319942, "dur": 10,
    "args": {
       "External id": 605,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373319901, "dur": 55,
    "args": {
       "External id": 604,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373320000, "dur": 26,
    "args": {
       "External id": 606,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2762, "tid": 2762,
    "ts": 1638252373319861, "dur": 168,
    "args": {
       "External id": 603,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::contiguous", "pid": 2762, "tid": 2762,
    "ts": 1638252373319822, "dur": 208,
    "args": {
       "External id": 602,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373320079, "dur": 3,
    "args": {
       "External id": 607,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373320087,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373320289, "dur": 1,
    "args": {
       "External id": 611,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373320244, "dur": 49,
    "args": {
       "External id": 610,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373320198, "dur": 98,
    "args": {
       "External id": 609,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373320387, "dur": 3,
    "args": {
       "External id": 613,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373320445,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373320438, "dur": 71,
    "args": {
       "External id": 614,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373320615, "dur": 2,
    "args": {
       "External id": 616,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373320563, "dur": 56,
    "args": {
       "External id": 615,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373320342, "dur": 280,
    "args": {
       "External id": 612,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373320671, "dur": 28,
    "args": {
       "External id": 617,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373320154, "dur": 548,
    "args": {
       "External id": 608,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373320919,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": 18874368, "Total Allocated": 316439552, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373320909, "dur": 18,
    "args": {
       "External id": 621,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373320861, "dur": 69,
    "args": {
       "External id": 620,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373321028,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391848345600, "Bytes": 4718592, "Total Allocated": 321158144, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373321020, "dur": 14,
    "args": {
       "External id": 623,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373320976, "dur": 60,
    "args": {
       "External id": 622,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373320810, "dur": 253,
    "args": {
       "External id": 619,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373321066,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391848345600, "Bytes": -4718592, "Total Allocated": 316439552, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373320766, "dur": 304,
    "args": {
       "External id": 618,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373321075,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": -18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373321081,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391866040320, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373321086,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": -18874368, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373321093,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": -18874368, "Total Allocated": 240942080, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373321098,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395432378368, "Bytes": -18874368, "Total Allocated": 222067712, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373321102,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391862501376, "Bytes": -3538944, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373321160,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 2762, "tid": 2762,
    "ts": 1638252373321152, "dur": 34,
    "args": {
       "External id": 624,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373321192,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": -18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373321358,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373321354, "dur": 10,
    "args": {
       "External id": 627,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373321415,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091328, "Bytes": 12288, "Total Allocated": 237415424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373321412, "dur": 9,
    "args": {
       "External id": 628,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373321572,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533103616, "Bytes": 12288, "Total Allocated": 237427712, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373321568, "dur": 10,
    "args": {
       "External id": 629,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373321670, "dur": 2,
    "args": {
       "External id": 630,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373321721, "dur": 1,
    "args": {
       "External id": 631,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373321308, "dur": 423,
    "args": {
       "External id": 626,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373321734,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091328, "Bytes": -12288, "Total Allocated": 237415424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373321739,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533103616, "Bytes": -12288, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373321260, "dur": 483,
    "args": {
       "External id": 625,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373322178, "dur": 1,
    "args": {
       "External id": 635,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373322025, "dur": 157,
    "args": {
       "External id": 634,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373321917, "dur": 269,
    "args": {
       "External id": 633,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373322292, "dur": 3,
    "args": {
       "External id": 637,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373322357,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140392213250048, "Bytes": 75497472, "Total Allocated": 312900608, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373322351, "dur": 50,
    "args": {
       "External id": 638,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373322537, "dur": 1,
    "args": {
       "External id": 640,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373322489, "dur": 52,
    "args": {
       "External id": 639,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373322245, "dur": 299,
    "args": {
       "External id": 636,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373322594, "dur": 42,
    "args": {
       "External id": 641,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373321852, "dur": 790,
    "args": {
       "External id": 632,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [6144, 1536], [6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373322747,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140396522897408, "Bytes": 75497472, "Total Allocated": 388398080, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::gelu", "pid": 2762, "tid": 2762,
    "ts": 1638252373322738, "dur": 37,
    "args": {
       "External id": 642,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1556): gelu;/miniconda/lib/python3.8/site-packages/torch/nn/modules/activation.py(652): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373322781,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140392213250048, "Bytes": -75497472, "Total Allocated": 312900608, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373322976, "dur": 2,
    "args": {
       "External id": 646,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373322931, "dur": 50,
    "args": {
       "External id": 645,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373322884, "dur": 100,
    "args": {
       "External id": 644,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373323076, "dur": 3,
    "args": {
       "External id": 648,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373323133,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": 18874368, "Total Allocated": 331774976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373323127, "dur": 62,
    "args": {
       "External id": 649,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373323288, "dur": 2,
    "args": {
       "External id": 651,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373323244, "dur": 48,
    "args": {
       "External id": 650,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373323030, "dur": 265,
    "args": {
       "External id": 647,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373323342, "dur": 26,
    "args": {
       "External id": 652,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373322839, "dur": 531,
    "args": {
       "External id": 643,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [1536, 6144], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373323379,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140396522897408, "Bytes": -75497472, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373323598,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395432378368, "Bytes": 18874368, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373323588, "dur": 28,
    "args": {
       "External id": 656,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373323542, "dur": 76,
    "args": {
       "External id": 655,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373323718,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": 4718592, "Total Allocated": 279870464, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373323710, "dur": 14,
    "args": {
       "External id": 658,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373323665, "dur": 68,
    "args": {
       "External id": 657,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373323493, "dur": 267,
    "args": {
       "External id": 654,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373323763,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": -4718592, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373323448, "dur": 319,
    "args": {
       "External id": 653,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373323772,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": -18874368, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373323778,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": -18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373323783,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395394629632, "Bytes": -18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373323787,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": -18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373323795,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395375755264, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373323944,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373323940, "dur": 10,
    "args": {
       "External id": 661,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373323992,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091328, "Bytes": 12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373323989, "dur": 9,
    "args": {
       "External id": 662,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373324039,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533103616, "Bytes": 12288, "Total Allocated": 199678976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373324036, "dur": 9,
    "args": {
       "External id": 663,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373324116, "dur": 2,
    "args": {
       "External id": 664,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373324153, "dur": 1,
    "args": {
       "External id": 665,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373323899, "dur": 259,
    "args": {
       "External id": 660,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373324161,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091328, "Bytes": -12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373324166,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533103616, "Bytes": -12288, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373323858, "dur": 313,
    "args": {
       "External id": 659,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373324176,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395432378368, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373324335, "dur": 1,
    "args": {
       "External id": 669,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373324301, "dur": 40,
    "args": {
       "External id": 668,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373324264, "dur": 80,
    "args": {
       "External id": 667,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373324415, "dur": 3,
    "args": {
       "External id": 671,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373324465,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533275648, "Bytes": 122880, "Total Allocated": 180902912, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373324459, "dur": 44,
    "args": {
       "External id": 672,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 10]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373324580, "dur": 2,
    "args": {
       "External id": 674,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373324546, "dur": 38,
    "args": {
       "External id": 673,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373324379, "dur": 208,
    "args": {
       "External id": 670,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 10]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373324229, "dur": 360,
    "args": {
       "External id": 666,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [10, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373324594,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": -18874368, "Total Allocated": 162028544, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373324643, "dur": 3,
    "args": {
       "External id": 675,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 10], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373324679, "dur": 2,
    "args": {
       "External id": 676,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373324792, "dur": 1,
    "args": {
       "External id": 679,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373324833,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533398528, "Bytes": 122880, "Total Allocated": 162151424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_log_softmax", "pid": 2762, "tid": 2762,
    "ts": 1638252373324827, "dur": 34,
    "args": {
       "External id": 680,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::log_softmax", "pid": 2762, "tid": 2762,
    "ts": 1638252373324758, "dur": 106,
    "args": {
       "External id": 678,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373324974,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091328, "Bytes": 512, "Total Allocated": 162151936, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373324981,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091840, "Bytes": 512, "Total Allocated": 162152448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2762, "tid": 2762,
    "ts": 1638252373325019, "dur": 1,
    "args": {
       "External id": 684,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2762, "tid": 2762,
    "ts": 1638252373325053, "dur": 1,
    "args": {
       "External id": 685,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss_forward", "pid": 2762, "tid": 2762,
    "ts": 1638252373324968, "dur": 108,
    "args": {
       "External id": 683,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373325079,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091840, "Bytes": -512, "Total Allocated": 162151936, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss", "pid": 2762, "tid": 2762,
    "ts": 1638252373324934, "dur": 149,
    "args": {
       "External id": 682,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss_nd", "pid": 2762, "tid": 2762,
    "ts": 1638252373324901, "dur": 184,
    "args": {
       "External id": 681,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373325087,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533398528, "Bytes": -122880, "Total Allocated": 162029056, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::cross_entropy_loss", "pid": 2762, "tid": 2762,
    "ts": 1638252373324725, "dur": 366,
    "args": {
       "External id": 677,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373325097,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395333812224, "Bytes": -18874368, "Total Allocated": 143154688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "CheckpointFunction", "pid": 2762, "tid": 2762,
    "ts": 1638252373311936, "dur": 13270,
    "args": {
       "External id": 458,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Fwd thread id": 0, "Sequence number": 206
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2762, "tid": 2762,
    "ts": 1638252373325261, "dur": 1,
    "args": {
       "External id": 686,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [7093632]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1822): _use_fp32_param_shard;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1153): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373325329,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533152768, "Bytes": -122880, "Total Allocated": 143031808, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373325362,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005762467904, "Bytes": -5056, "Total Allocated": 6688, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373325367,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005762107456, "Bytes": -816, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373325376,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533090816, "Bytes": -512, "Total Allocated": 143031296, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "ProfilerStep#7", "pid": 2762, "tid": 2762,
    "ts": 1638252373306544, "dur": 27565,
    "args": {
       "External id": 347,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(330): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;"
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373334190,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005762470976, "Bytes": 4, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373334188, "dur": 9,
    "args": {
       "External id": 688,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zero_", "pid": 2762, "tid": 2762,
    "ts": 1638252373334221, "dur": 1,
    "args": {
       "External id": 689,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zeros", "pid": 2762, "tid": 2762,
    "ts": 1638252373334165, "dur": 58,
    "args": {
       "External id": 687,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373334278,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005764802496, "Bytes": 16, "Total Allocated": 5892, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373334276, "dur": 6,
    "args": {
       "External id": 691,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(330): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373334284,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005764802496, "Bytes": -16, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373334290,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005762470976, "Bytes": -4, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373334354,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005764808320, "Bytes": 4, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373334353, "dur": 5,
    "args": {
       "External id": 693,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zero_", "pid": 2762, "tid": 2762,
    "ts": 1638252373334383, "dur": 1,
    "args": {
       "External id": 694,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zeros", "pid": 2762, "tid": 2762,
    "ts": 1638252373334331, "dur": 55,
    "args": {
       "External id": 692,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373334438,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005764814336, "Bytes": 16, "Total Allocated": 5892, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373334437, "dur": 5,
    "args": {
       "External id": 696,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373334443,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005764814336, "Bytes": -16, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373334448,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005764808320, "Bytes": -4, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "enumerate(DataLoader)#_MultiProcessingDataLoaderIter.__next__", "pid": 2762, "tid": 2762,
    "ts": 1638252373334413, "dur": 260,
    "args": {
       "External id": 695,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;"
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373334796,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533041664, "Bytes": -24576, "Total Allocated": 143006720, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373334803,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533066240, "Bytes": -24576, "Total Allocated": 142982144, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373334904,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533041664, "Bytes": 24576, "Total Allocated": 143006720, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373334893, "dur": 18,
    "args": {
       "External id": 699,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373334934, "dur": 42,
    "args": {
       "External id": 700,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2762, "tid": 2762,
    "ts": 1638252373334872, "dur": 109,
    "args": {
       "External id": 698,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""], "Fwd thread id": 0, "Sequence number": 207
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373334850, "dur": 132,
    "args": {
       "External id": 697,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 207
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373335055,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533066240, "Bytes": 24576, "Total Allocated": 143031296, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373335046, "dur": 16,
    "args": {
       "External id": 703,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373335083, "dur": 32,
    "args": {
       "External id": 704,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2762, "tid": 2762,
    "ts": 1638252373335027, "dur": 90,
    "args": {
       "External id": 702,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""], "Fwd thread id": 0, "Sequence number": 207
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373335006, "dur": 113,
    "args": {
       "External id": 701,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 207
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373335485, "dur": 0,
    "args": {
       "External id": 705,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(479): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 207
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373335517, "dur": 1,
    "args": {
       "External id": 706,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(481): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 207
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2762, "tid": 2762,
    "ts": 1638252373335721, "dur": 1,
    "args": {
       "External id": 707,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[7093632], [28374528]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1570): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373335791, "dur": 1,
    "args": {
       "External id": 709,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373335760, "dur": 37,
    "args": {
       "External id": 708,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373335831, "dur": 5,
    "args": {
       "External id": 710,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2762, "tid": 2762,
    "ts": 1638252373335865, "dur": 1,
    "args": {
       "External id": 711,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [28374528]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373336052, "dur": 1,
    "args": {
       "External id": 715,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373336022, "dur": 33,
    "args": {
       "External id": 714,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373335990, "dur": 67,
    "args": {
       "External id": 713,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373336151, "dur": 1,
    "args": {
       "External id": 718,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373336120, "dur": 34,
    "args": {
       "External id": 717,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373336089, "dur": 66,
    "args": {
       "External id": 716,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373336246, "dur": 1,
    "args": {
       "External id": 721,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373336215, "dur": 34,
    "args": {
       "External id": 720,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373336185, "dur": 65,
    "args": {
       "External id": 719,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373336341, "dur": 0,
    "args": {
       "External id": 724,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373336310, "dur": 33,
    "args": {
       "External id": 723,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373336280, "dur": 65,
    "args": {
       "External id": 722,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373336435, "dur": 1,
    "args": {
       "External id": 727,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373336404, "dur": 33,
    "args": {
       "External id": 726,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373336374, "dur": 67,
    "args": {
       "External id": 725,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373336535, "dur": 0,
    "args": {
       "External id": 730,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373336503, "dur": 34,
    "args": {
       "External id": 729,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373336475, "dur": 64,
    "args": {
       "External id": 728,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373336637, "dur": 1,
    "args": {
       "External id": 733,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373336607, "dur": 33,
    "args": {
       "External id": 732,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373336570, "dur": 71,
    "args": {
       "External id": 731,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373336731, "dur": 1,
    "args": {
       "External id": 736,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373336702, "dur": 33,
    "args": {
       "External id": 735,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373336672, "dur": 65,
    "args": {
       "External id": 734,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373336833, "dur": 0,
    "args": {
       "External id": 739,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373336797, "dur": 38,
    "args": {
       "External id": 738,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373336767, "dur": 70,
    "args": {
       "External id": 737,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373336926, "dur": 1,
    "args": {
       "External id": 742,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373336896, "dur": 33,
    "args": {
       "External id": 741,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373336866, "dur": 67,
    "args": {
       "External id": 740,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373337023, "dur": 0,
    "args": {
       "External id": 745,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373336992, "dur": 33,
    "args": {
       "External id": 744,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373336964, "dur": 63,
    "args": {
       "External id": 743,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373337118, "dur": 1,
    "args": {
       "External id": 748,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373337086, "dur": 35,
    "args": {
       "External id": 747,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373337058, "dur": 64,
    "args": {
       "External id": 746,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373337212, "dur": 1,
    "args": {
       "External id": 751,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373337183, "dur": 32,
    "args": {
       "External id": 750,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373337153, "dur": 63,
    "args": {
       "External id": 749,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373337306, "dur": 2,
    "args": {
       "External id": 754,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373337277, "dur": 33,
    "args": {
       "External id": 753,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373337247, "dur": 65,
    "args": {
       "External id": 752,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373337404, "dur": 1,
    "args": {
       "External id": 757,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373337371, "dur": 37,
    "args": {
       "External id": 756,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373337341, "dur": 69,
    "args": {
       "External id": 755,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373337500, "dur": 0,
    "args": {
       "External id": 760,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373337469, "dur": 33,
    "args": {
       "External id": 759,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373337439, "dur": 65,
    "args": {
       "External id": 758,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373337593, "dur": 1,
    "args": {
       "External id": 763,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373337563, "dur": 33,
    "args": {
       "External id": 762,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373337535, "dur": 62,
    "args": {
       "External id": 761,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373337693, "dur": 1,
    "args": {
       "External id": 766,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373337662, "dur": 33,
    "args": {
       "External id": 765,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373337634, "dur": 63,
    "args": {
       "External id": 764,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373337787, "dur": 1,
    "args": {
       "External id": 769,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373337758, "dur": 32,
    "args": {
       "External id": 768,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373337728, "dur": 63,
    "args": {
       "External id": 767,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373337883, "dur": 2,
    "args": {
       "External id": 772,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373337854, "dur": 33,
    "args": {
       "External id": 771,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373337825, "dur": 64,
    "args": {
       "External id": 770,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373337979, "dur": 1,
    "args": {
       "External id": 775,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373337948, "dur": 33,
    "args": {
       "External id": 774,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373337918, "dur": 65,
    "args": {
       "External id": 773,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::split_with_sizes", "pid": 2762, "tid": 2762,
    "ts": 1638252373335953, "dur": 2052,
    "args": {
       "External id": 712,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Int"], "Fwd thread id": 0, "Sequence number": 207
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373338049, "dur": 6,
    "args": {
       "External id": 776,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9216], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 208
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373338092, "dur": 6,
    "args": {
       "External id": 777,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[15360], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 209
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373338132, "dur": 3,
    "args": {
       "External id": 778,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 210
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373338171, "dur": 4,
    "args": {
       "External id": 779,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 211
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373338209, "dur": 3,
    "args": {
       "External id": 780,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 212
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373338244, "dur": 4,
    "args": {
       "External id": 781,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 213
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373338282, "dur": 4,
    "args": {
       "External id": 782,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 214
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373338323, "dur": 4,
    "args": {
       "External id": 783,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 215
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373338360, "dur": 4,
    "args": {
       "External id": 784,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 216
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373338395, "dur": 6,
    "args": {
       "External id": 785,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 217
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373338433, "dur": 5,
    "args": {
       "External id": 786,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 218
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373338470, "dur": 3,
    "args": {
       "External id": 787,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 219
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373338507, "dur": 3,
    "args": {
       "External id": 788,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 220
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373338544, "dur": 3,
    "args": {
       "External id": 789,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 221
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373338581, "dur": 3,
    "args": {
       "External id": 790,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 222
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373338622, "dur": 4,
    "args": {
       "External id": 791,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 223
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373338658, "dur": 5,
    "args": {
       "External id": 792,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 224
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373338695, "dur": 3,
    "args": {
       "External id": 793,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 225
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373338731, "dur": 4,
    "args": {
       "External id": 794,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 226
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373338769, "dur": 3,
    "args": {
       "External id": 795,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 227
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373338806, "dur": 3,
    "args": {
       "External id": 796,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[15360], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 228
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373338903, "dur": 3,
    "args": {
       "External id": 797,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373338936, "dur": 1,
    "args": {
       "External id": 798,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 229
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "detach_", "pid": 2762, "tid": 2762,
    "ts": 1638252373338991, "dur": 0,
    "args": {
       "External id": 800,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::detach_", "pid": 2762, "tid": 2762,
    "ts": 1638252373338965, "dur": 28,
    "args": {
       "External id": 799,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"], "Fwd thread id": 0, "Sequence number": 229
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373339050,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005765113728, "Bytes": 5056, "Total Allocated": 10928, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373339081,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005762511808, "Bytes": 816, "Total Allocated": 11744, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373339200, "dur": 9,
    "args": {
       "External id": 804,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373339241, "dur": 29,
    "args": {
       "External id": 805,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2762, "tid": 2762,
    "ts": 1638252373339167, "dur": 106,
    "args": {
       "External id": 803,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373339136, "dur": 139,
    "args": {
       "External id": 802,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373339375, "dur": 5,
    "args": {
       "External id": 808,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373339413, "dur": 19,
    "args": {
       "External id": 809,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2762, "tid": 2762,
    "ts": 1638252373339343, "dur": 91,
    "args": {
       "External id": 807,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373339313, "dur": 123,
    "args": {
       "External id": 806,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 2762, "tid": 2762,
    "ts": 1638252373339593, "dur": 1,
    "args": {
       "External id": 812,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2762, "tid": 2762,
    "ts": 1638252373339556, "dur": 41,
    "args": {
       "External id": 811,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373340015, "dur": 7,
    "args": {
       "External id": 814,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373340070,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395333812224, "Bytes": 18874368, "Total Allocated": 161905664, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2762, "tid": 2762,
    "ts": 1638252373340063, "dur": 15,
    "args": {
       "External id": 815,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::index_select", "pid": 2762, "tid": 2762,
    "ts": 1638252373339974, "dur": 141,
    "args": {
       "External id": 813,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], [3072]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "long int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373340153, "dur": 3,
    "args": {
       "External id": 816,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::embedding", "pid": 2762, "tid": 2762,
    "ts": 1638252373339520, "dur": 643,
    "args": {
       "External id": 810,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [512, 6], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "Int", "Bool", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373340241, "dur": 1,
    "args": {
       "External id": 818,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373340210, "dur": 36,
    "args": {
       "External id": 817,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373340308, "dur": 1,
    "args": {
       "External id": 820,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373340278, "dur": 33,
    "args": {
       "External id": 819,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373340367,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": 18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 2762, "tid": 2762,
    "ts": 1638252373340356, "dur": 45,
    "args": {
       "External id": 821,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373340578,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395375755264, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373340568, "dur": 17,
    "args": {
       "External id": 825,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373340533, "dur": 55,
    "args": {
       "External id": 824,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373340675,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395394629632, "Bytes": 4718592, "Total Allocated": 204372992, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373340668, "dur": 14,
    "args": {
       "External id": 827,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373340634, "dur": 50,
    "args": {
       "External id": 826,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373340494, "dur": 217,
    "args": {
       "External id": 823,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373340717,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395394629632, "Bytes": -4718592, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373340460, "dur": 262,
    "args": {
       "External id": 822,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373340727,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373340894,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395394629632, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373340889, "dur": 11,
    "args": {
       "External id": 830,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373340946,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091840, "Bytes": 12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373340943, "dur": 9,
    "args": {
       "External id": 831,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373340997,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533104128, "Bytes": 12288, "Total Allocated": 199678976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373340994, "dur": 8,
    "args": {
       "External id": 832,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373341078, "dur": 2,
    "args": {
       "External id": 833,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373341122, "dur": 1,
    "args": {
       "External id": 834,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373340844, "dur": 284,
    "args": {
       "External id": 829,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373341131,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091840, "Bytes": -12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373341136,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533104128, "Bytes": -12288, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373340804, "dur": 338,
    "args": {
       "External id": 828,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373341340, "dur": 1,
    "args": {
       "External id": 838,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373341297, "dur": 47,
    "args": {
       "External id": 837,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373341253, "dur": 94,
    "args": {
       "External id": 836,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373341436, "dur": 2,
    "args": {
       "External id": 840,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373341493,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": 18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373341486, "dur": 72,
    "args": {
       "External id": 841,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373341664, "dur": 1,
    "args": {
       "External id": 843,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373341620, "dur": 48,
    "args": {
       "External id": 842,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373341392, "dur": 279,
    "args": {
       "External id": 839,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373341716, "dur": 29,
    "args": {
       "External id": 844,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373341210, "dur": 538,
    "args": {
       "External id": 835,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373341798, "dur": 4,
    "args": {
       "External id": 845,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373341886, "dur": 1,
    "args": {
       "External id": 847,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373341845, "dur": 49,
    "args": {
       "External id": 846,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373342081, "dur": 1,
    "args": {
       "External id": 851,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373342038, "dur": 46,
    "args": {
       "External id": 850,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373341995, "dur": 92,
    "args": {
       "External id": 849,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373342174, "dur": 2,
    "args": {
       "External id": 853,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373342230,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373342223, "dur": 65,
    "args": {
       "External id": 854,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373342382, "dur": 2,
    "args": {
       "External id": 856,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373342339, "dur": 47,
    "args": {
       "External id": 855,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373342130, "dur": 259,
    "args": {
       "External id": 852,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373342434, "dur": 25,
    "args": {
       "External id": 857,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373341952, "dur": 510,
    "args": {
       "External id": 848,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373342509, "dur": 3,
    "args": {
       "External id": 858,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373342594, "dur": 1,
    "args": {
       "External id": 860,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373342554, "dur": 57,
    "args": {
       "External id": 859,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373342797, "dur": 1,
    "args": {
       "External id": 864,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373342754, "dur": 46,
    "args": {
       "External id": 863,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373342711, "dur": 92,
    "args": {
       "External id": 862,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373342893, "dur": 3,
    "args": {
       "External id": 866,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373342951,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395432378368, "Bytes": 18874368, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373342944, "dur": 66,
    "args": {
       "External id": 867,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373343108, "dur": 2,
    "args": {
       "External id": 869,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373343063, "dur": 50,
    "args": {
       "External id": 868,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373342847, "dur": 269,
    "args": {
       "External id": 865,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373343160, "dur": 25,
    "args": {
       "External id": 870,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373342669, "dur": 518,
    "args": {
       "External id": 861,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373343237, "dur": 4,
    "args": {
       "External id": 871,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373343327, "dur": 2,
    "args": {
       "External id": 873,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373343285, "dur": 47,
    "args": {
       "External id": 872,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373343416, "dur": 3,
    "args": {
       "External id": 875,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373343378, "dur": 44,
    "args": {
       "External id": 874,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373343548, "dur": 1,
    "args": {
       "External id": 878,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373343507, "dur": 45,
    "args": {
       "External id": 877,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373343728,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": 18874368, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373343722, "dur": 14,
    "args": {
       "External id": 882,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373343682, "dur": 57,
    "args": {
       "External id": 881,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373343782, "dur": 29,
    "args": {
       "External id": 883,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2762, "tid": 2762,
    "ts": 1638252373343641, "dur": 173,
    "args": {
       "External id": 880,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373343897, "dur": 2,
    "args": {
       "External id": 885,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373343858, "dur": 44,
    "args": {
       "External id": 884,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2762, "tid": 2762,
    "ts": 1638252373343595, "dur": 309,
    "args": {
       "External id": 879,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373343983, "dur": 2,
    "args": {
       "External id": 887,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373343943, "dur": 45,
    "args": {
       "External id": 886,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373344160,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": 18874368, "Total Allocated": 294026240, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373344155, "dur": 12,
    "args": {
       "External id": 891,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373344116, "dur": 53,
    "args": {
       "External id": 890,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373344211, "dur": 23,
    "args": {
       "External id": 892,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2762, "tid": 2762,
    "ts": 1638252373344076, "dur": 161,
    "args": {
       "External id": 889,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373344321, "dur": 1,
    "args": {
       "External id": 894,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373344281, "dur": 43,
    "args": {
       "External id": 893,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2762, "tid": 2762,
    "ts": 1638252373344036, "dur": 290,
    "args": {
       "External id": 888,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373344413,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391848345600, "Bytes": 3538944, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373344409, "dur": 11,
    "args": {
       "External id": 896,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 2762, "tid": 2762,
    "ts": 1638252373344366, "dur": 79,
    "args": {
       "External id": 895,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], [24576, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373344528, "dur": 2,
    "args": {
       "External id": 898,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373344488, "dur": 44,
    "args": {
       "External id": 897,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373344535,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373344541,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": -18874368, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373343464, "dur": 1081,
    "args": {
       "External id": 876,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373344560,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005765852608, "Bytes": 8, "Total Allocated": 11752, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373344626,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391851884544, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mul", "pid": 2762, "tid": 2762,
    "ts": 1638252373344616, "dur": 38,
    "args": {
       "External id": 899,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373344659,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005765852608, "Bytes": -8, "Total Allocated": 11744, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373344665,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391848345600, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373344770, "dur": 2,
    "args": {
       "External id": 901,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373344724, "dur": 51,
    "args": {
       "External id": 900,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373344857, "dur": 1,
    "args": {
       "External id": 903,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373344817, "dur": 44,
    "args": {
       "External id": 902,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373344912,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005765875008, "Bytes": 8, "Total Allocated": 11752, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373344925,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533090816, "Bytes": 512, "Total Allocated": 259816960, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373344932,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005765875008, "Bytes": -8, "Total Allocated": 11744, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::eq", "pid": 2762, "tid": 2762,
    "ts": 1638252373344909, "dur": 50,
    "args": {
       "External id": 904,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373345093, "dur": 2,
    "args": {
       "External id": 907,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373345053, "dur": 45,
    "args": {
       "External id": 906,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373345180, "dur": 1,
    "args": {
       "External id": 909,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373345140, "dur": 44,
    "args": {
       "External id": 908,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373345308,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391855423488, "Bytes": 3538944, "Total Allocated": 263355904, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373345303, "dur": 12,
    "args": {
       "External id": 912,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373345263, "dur": 56,
    "args": {
       "External id": 911,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373345360, "dur": 32,
    "args": {
       "External id": 913,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2762, "tid": 2762,
    "ts": 1638252373345223, "dur": 171,
    "args": {
       "External id": 910,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373345523, "dur": 2,
    "args": {
       "External id": 916,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373345481, "dur": 46,
    "args": {
       "External id": 915,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill_", "pid": 2762, "tid": 2762,
    "ts": 1638252373345438, "dur": 116,
    "args": {
       "External id": 914,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill", "pid": 2762, "tid": 2762,
    "ts": 1638252373345010, "dur": 546,
    "args": {
       "External id": 905,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373345561,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533090816, "Bytes": -512, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373345569,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391851884544, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373345682,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391858962432, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_softmax", "pid": 2762, "tid": 2762,
    "ts": 1638252373345677, "dur": 33,
    "args": {
       "External id": 918,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::softmax", "pid": 2762, "tid": 2762,
    "ts": 1638252373345634, "dur": 79,
    "args": {
       "External id": 917,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373345718,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391855423488, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373345940,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391862501376, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373345930, "dur": 17,
    "args": {
       "External id": 922,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373345885, "dur": 65,
    "args": {
       "External id": 921,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373346048,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533398528, "Bytes": 884736, "Total Allocated": 264240128, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373346040, "dur": 14,
    "args": {
       "External id": 924,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373345996, "dur": 60,
    "args": {
       "External id": 923,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373345835, "dur": 248,
    "args": {
       "External id": 920,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373346086,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533398528, "Bytes": -884736, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373345789, "dur": 301,
    "args": {
       "External id": 919,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373346098,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391858962432, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373346229, "dur": 2,
    "args": {
       "External id": 927,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373346188, "dur": 46,
    "args": {
       "External id": 926,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 2762, "tid": 2762,
    "ts": 1638252373346317, "dur": 4,
    "args": {
       "External id": 929,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2762, "tid": 2762,
    "ts": 1638252373346276, "dur": 47,
    "args": {
       "External id": 928,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373346403, "dur": 1,
    "args": {
       "External id": 931,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373346363, "dur": 44,
    "args": {
       "External id": 930,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373346575,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391866040320, "Bytes": 18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373346570, "dur": 11,
    "args": {
       "External id": 935,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373346529, "dur": 54,
    "args": {
       "External id": 934,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373346640, "dur": 28,
    "args": {
       "External id": 936,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2762, "tid": 2762,
    "ts": 1638252373346488, "dur": 182,
    "args": {
       "External id": 933,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373346754, "dur": 3,
    "args": {
       "External id": 938,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373346714, "dur": 45,
    "args": {
       "External id": 937,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2762, "tid": 2762,
    "ts": 1638252373346448, "dur": 315,
    "args": {
       "External id": 932,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373346851,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373346847, "dur": 11,
    "args": {
       "External id": 940,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 2762, "tid": 2762,
    "ts": 1638252373346804, "dur": 79,
    "args": {
       "External id": 939,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], [24576, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373346967, "dur": 2,
    "args": {
       "External id": 942,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373346928, "dur": 43,
    "args": {
       "External id": 941,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373346974,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391866040320, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373346146, "dur": 833,
    "args": {
       "External id": 925,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373347067, "dur": 1,
    "args": {
       "External id": 944,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373347026, "dur": 46,
    "args": {
       "External id": 943,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373347239,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391866040320, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373347235, "dur": 10,
    "args": {
       "External id": 948,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373347195, "dur": 53,
    "args": {
       "External id": 947,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373347296, "dur": 25,
    "args": {
       "External id": 949,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2762, "tid": 2762,
    "ts": 1638252373347155, "dur": 171,
    "args": {
       "External id": 946,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::contiguous", "pid": 2762, "tid": 2762,
    "ts": 1638252373347118, "dur": 210,
    "args": {
       "External id": 945,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373347376, "dur": 4,
    "args": {
       "External id": 950,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373347385,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373347585, "dur": 1,
    "args": {
       "External id": 954,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373347540, "dur": 48,
    "args": {
       "External id": 953,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373347495, "dur": 97,
    "args": {
       "External id": 952,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373347688, "dur": 3,
    "args": {
       "External id": 956,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373347746,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373347740, "dur": 71,
    "args": {
       "External id": 957,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373347910, "dur": 1,
    "args": {
       "External id": 959,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373347865, "dur": 49,
    "args": {
       "External id": 958,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373347643, "dur": 274,
    "args": {
       "External id": 955,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373347963, "dur": 28,
    "args": {
       "External id": 960,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373347451, "dur": 544,
    "args": {
       "External id": 951,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373348212,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": 18874368, "Total Allocated": 316439552, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373348201, "dur": 18,
    "args": {
       "External id": 964,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373348156, "dur": 66,
    "args": {
       "External id": 963,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373348321,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391848345600, "Bytes": 4718592, "Total Allocated": 321158144, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373348313, "dur": 14,
    "args": {
       "External id": 966,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373348269, "dur": 60,
    "args": {
       "External id": 965,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373348107, "dur": 248,
    "args": {
       "External id": 962,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373348359,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391848345600, "Bytes": -4718592, "Total Allocated": 316439552, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373348062, "dur": 301,
    "args": {
       "External id": 961,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373348368,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": -18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373348374,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391866040320, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373348379,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": -18874368, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373348386,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": -18874368, "Total Allocated": 240942080, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373348391,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395432378368, "Bytes": -18874368, "Total Allocated": 222067712, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373348398,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391862501376, "Bytes": -3538944, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373348453,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 2762, "tid": 2762,
    "ts": 1638252373348446, "dur": 32,
    "args": {
       "External id": 967,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373348485,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": -18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373348655,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373348651, "dur": 10,
    "args": {
       "External id": 970,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373348714,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091840, "Bytes": 12288, "Total Allocated": 237415424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373348711, "dur": 9,
    "args": {
       "External id": 971,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373348768,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533104128, "Bytes": 12288, "Total Allocated": 237427712, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373348764, "dur": 9,
    "args": {
       "External id": 972,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373348850, "dur": 2,
    "args": {
       "External id": 973,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373348898, "dur": 1,
    "args": {
       "External id": 974,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373348595, "dur": 309,
    "args": {
       "External id": 969,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373348907,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091840, "Bytes": -12288, "Total Allocated": 237415424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373348914,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533104128, "Bytes": -12288, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373348552, "dur": 365,
    "args": {
       "External id": 968,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373349237, "dur": 1,
    "args": {
       "External id": 978,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373349191, "dur": 50,
    "args": {
       "External id": 977,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373349144, "dur": 101,
    "args": {
       "External id": 976,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373349370, "dur": 4,
    "args": {
       "External id": 980,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373349479,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140392213250048, "Bytes": 75497472, "Total Allocated": 312900608, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373349472, "dur": 51,
    "args": {
       "External id": 981,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373349714, "dur": 2,
    "args": {
       "External id": 983,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373349638, "dur": 81,
    "args": {
       "External id": 982,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373349306, "dur": 416,
    "args": {
       "External id": 979,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373349773, "dur": 29,
    "args": {
       "External id": 984,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373349037, "dur": 768,
    "args": {
       "External id": 975,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [6144, 1536], [6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373349884,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140396522897408, "Bytes": 75497472, "Total Allocated": 388398080, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::gelu", "pid": 2762, "tid": 2762,
    "ts": 1638252373349876, "dur": 38,
    "args": {
       "External id": 985,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1556): gelu;/miniconda/lib/python3.8/site-packages/torch/nn/modules/activation.py(652): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373349939,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140392213250048, "Bytes": -75497472, "Total Allocated": 312900608, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373350228, "dur": 2,
    "args": {
       "External id": 989,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373350182, "dur": 51,
    "args": {
       "External id": 988,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373350135, "dur": 102,
    "args": {
       "External id": 987,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373350330, "dur": 3,
    "args": {
       "External id": 991,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373350390,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": 18874368, "Total Allocated": 331774976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373350381, "dur": 67,
    "args": {
       "External id": 992,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373350547, "dur": 1,
    "args": {
       "External id": 994,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373350502, "dur": 49,
    "args": {
       "External id": 993,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373350284, "dur": 270,
    "args": {
       "External id": 990,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373350610, "dur": 27,
    "args": {
       "External id": 995,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373350004, "dur": 635,
    "args": {
       "External id": 986,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [1536, 6144], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373350649,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140396522897408, "Bytes": -75497472, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373350876,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395432378368, "Bytes": 18874368, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373350865, "dur": 17,
    "args": {
       "External id": 999,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373350816, "dur": 69,
    "args": {
       "External id": 998,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373350984,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": 4718592, "Total Allocated": 279870464, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373350976, "dur": 14,
    "args": {
       "External id": 1001,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373350932, "dur": 60,
    "args": {
       "External id": 1000,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373350767, "dur": 252,
    "args": {
       "External id": 997,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373351022,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": -4718592, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373350724, "dur": 302,
    "args": {
       "External id": 996,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373351031,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": -18874368, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373351037,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": -18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373351042,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395394629632, "Bytes": -18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373351046,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": -18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373351052,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395375755264, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373351195,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373351191, "dur": 13,
    "args": {
       "External id": 1004,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373351256,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091840, "Bytes": 12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373351252, "dur": 9,
    "args": {
       "External id": 1005,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373351304,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533104128, "Bytes": 12288, "Total Allocated": 199678976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373351301, "dur": 8,
    "args": {
       "External id": 1006,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373351379, "dur": 2,
    "args": {
       "External id": 1007,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373351419, "dur": 1,
    "args": {
       "External id": 1008,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373351151, "dur": 274,
    "args": {
       "External id": 1003,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373351428,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091840, "Bytes": -12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373351433,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533104128, "Bytes": -12288, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373351116, "dur": 320,
    "args": {
       "External id": 1002,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373351441,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395432378368, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373351599, "dur": 9,
    "args": {
       "External id": 1012,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373351563, "dur": 47,
    "args": {
       "External id": 1011,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373351526, "dur": 90,
    "args": {
       "External id": 1010,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373351689, "dur": 3,
    "args": {
       "External id": 1014,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373351739,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533152768, "Bytes": 122880, "Total Allocated": 180902912, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373351732, "dur": 45,
    "args": {
       "External id": 1015,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 10]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373351856, "dur": 1,
    "args": {
       "External id": 1017,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373351819, "dur": 40,
    "args": {
       "External id": 1016,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373351651, "dur": 211,
    "args": {
       "External id": 1013,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 10]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373351491, "dur": 373,
    "args": {
       "External id": 1009,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [10, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373351870,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": -18874368, "Total Allocated": 162028544, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373351909, "dur": 2,
    "args": {
       "External id": 1018,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 10], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373351946, "dur": 2,
    "args": {
       "External id": 1019,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373352056, "dur": 1,
    "args": {
       "External id": 1022,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373352097,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533398528, "Bytes": 122880, "Total Allocated": 162151424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_log_softmax", "pid": 2762, "tid": 2762,
    "ts": 1638252373352091, "dur": 33,
    "args": {
       "External id": 1023,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::log_softmax", "pid": 2762, "tid": 2762,
    "ts": 1638252373352023, "dur": 105,
    "args": {
       "External id": 1021,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373352234,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533090816, "Bytes": 512, "Total Allocated": 162151936, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373352241,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091840, "Bytes": 512, "Total Allocated": 162152448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2762, "tid": 2762,
    "ts": 1638252373352280, "dur": 0,
    "args": {
       "External id": 1027,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2762, "tid": 2762,
    "ts": 1638252373352314, "dur": 0,
    "args": {
       "External id": 1028,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss_forward", "pid": 2762, "tid": 2762,
    "ts": 1638252373352229, "dur": 106,
    "args": {
       "External id": 1026,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373352338,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091840, "Bytes": -512, "Total Allocated": 162151936, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss", "pid": 2762, "tid": 2762,
    "ts": 1638252373352196, "dur": 147,
    "args": {
       "External id": 1025,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss_nd", "pid": 2762, "tid": 2762,
    "ts": 1638252373352165, "dur": 180,
    "args": {
       "External id": 1024,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373352347,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533398528, "Bytes": -122880, "Total Allocated": 162029056, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::cross_entropy_loss", "pid": 2762, "tid": 2762,
    "ts": 1638252373351992, "dur": 358,
    "args": {
       "External id": 1020,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373352357,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395333812224, "Bytes": -18874368, "Total Allocated": 143154688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "CheckpointFunction", "pid": 2762, "tid": 2762,
    "ts": 1638252373339022, "dur": 13444,
    "args": {
       "External id": 801,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Fwd thread id": 0, "Sequence number": 229
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2762, "tid": 2762,
    "ts": 1638252373352521, "dur": 1,
    "args": {
       "External id": 1029,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [7093632]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1822): _use_fp32_param_shard;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1153): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373352592,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533275648, "Bytes": -122880, "Total Allocated": 143031808, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373352634,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005763959616, "Bytes": -5056, "Total Allocated": 6688, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373352639,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005762398976, "Bytes": -816, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373352648,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091328, "Bytes": -512, "Total Allocated": 143031296, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "ProfilerStep#8", "pid": 2762, "tid": 2762,
    "ts": 1638252373334255, "dur": 27108,
    "args": {
       "External id": 690,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(330): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;"
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373361444,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005763962240, "Bytes": 4, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373361441, "dur": 10,
    "args": {
       "External id": 1031,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zero_", "pid": 2762, "tid": 2762,
    "ts": 1638252373361474, "dur": 1,
    "args": {
       "External id": 1032,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zeros", "pid": 2762, "tid": 2762,
    "ts": 1638252373361418, "dur": 59,
    "args": {
       "External id": 1030,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373361531,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005766347072, "Bytes": 16, "Total Allocated": 5892, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373361530, "dur": 5,
    "args": {
       "External id": 1034,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(330): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373361537,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005766347072, "Bytes": -16, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373361543,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005763962240, "Bytes": -4, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373361610,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005766352896, "Bytes": 4, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373361607, "dur": 9,
    "args": {
       "External id": 1036,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zero_", "pid": 2762, "tid": 2762,
    "ts": 1638252373361640, "dur": 0,
    "args": {
       "External id": 1037,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zeros", "pid": 2762, "tid": 2762,
    "ts": 1638252373361579, "dur": 63,
    "args": {
       "External id": 1035,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373361695,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005766358912, "Bytes": 16, "Total Allocated": 5892, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373361694, "dur": 5,
    "args": {
       "External id": 1039,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373361701,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005766358912, "Bytes": -16, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373361706,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005766352896, "Bytes": -4, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "enumerate(DataLoader)#_MultiProcessingDataLoaderIter.__next__", "pid": 2762, "tid": 2762,
    "ts": 1638252373361670, "dur": 293,
    "args": {
       "External id": 1038,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;"
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373362043,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533041664, "Bytes": -24576, "Total Allocated": 143006720, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373362050,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533066240, "Bytes": -24576, "Total Allocated": 142982144, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373362154,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533041664, "Bytes": 24576, "Total Allocated": 143006720, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373362142, "dur": 19,
    "args": {
       "External id": 1042,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373362181, "dur": 42,
    "args": {
       "External id": 1043,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2762, "tid": 2762,
    "ts": 1638252373362121, "dur": 105,
    "args": {
       "External id": 1041,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""], "Fwd thread id": 0, "Sequence number": 230
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373362096, "dur": 132,
    "args": {
       "External id": 1040,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 230
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373362302,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533066240, "Bytes": 24576, "Total Allocated": 143031296, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373362294, "dur": 15,
    "args": {
       "External id": 1046,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373362328, "dur": 32,
    "args": {
       "External id": 1047,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2762, "tid": 2762,
    "ts": 1638252373362274, "dur": 88,
    "args": {
       "External id": 1045,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""], "Fwd thread id": 0, "Sequence number": 230
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373362255, "dur": 109,
    "args": {
       "External id": 1044,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 230
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373362745, "dur": 1,
    "args": {
       "External id": 1048,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(479): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 230
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373362778, "dur": 0,
    "args": {
       "External id": 1049,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(481): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 230
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2762, "tid": 2762,
    "ts": 1638252373362971, "dur": 1,
    "args": {
       "External id": 1050,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[7093632], [28374528]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1570): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373363038, "dur": 2,
    "args": {
       "External id": 1052,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373363010, "dur": 34,
    "args": {
       "External id": 1051,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373363076, "dur": 5,
    "args": {
       "External id": 1053,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2762, "tid": 2762,
    "ts": 1638252373363110, "dur": 1,
    "args": {
       "External id": 1054,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [28374528]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373363285, "dur": 1,
    "args": {
       "External id": 1058,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373363254, "dur": 34,
    "args": {
       "External id": 1057,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373363223, "dur": 71,
    "args": {
       "External id": 1056,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373363386, "dur": 1,
    "args": {
       "External id": 1061,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373363356, "dur": 33,
    "args": {
       "External id": 1060,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373363326, "dur": 64,
    "args": {
       "External id": 1059,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373363479, "dur": 1,
    "args": {
       "External id": 1064,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373363449, "dur": 33,
    "args": {
       "External id": 1063,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373363421, "dur": 62,
    "args": {
       "External id": 1062,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373363571, "dur": 1,
    "args": {
       "External id": 1067,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373363543, "dur": 31,
    "args": {
       "External id": 1066,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373363514, "dur": 61,
    "args": {
       "External id": 1065,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373363676, "dur": 1,
    "args": {
       "External id": 1070,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373363646, "dur": 33,
    "args": {
       "External id": 1069,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373363614, "dur": 66,
    "args": {
       "External id": 1068,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373363776, "dur": 1,
    "args": {
       "External id": 1073,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373363747, "dur": 34,
    "args": {
       "External id": 1072,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373363712, "dur": 71,
    "args": {
       "External id": 1071,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373363877, "dur": 1,
    "args": {
       "External id": 1076,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373363846, "dur": 33,
    "args": {
       "External id": 1075,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373363816, "dur": 65,
    "args": {
       "External id": 1074,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373363973, "dur": 0,
    "args": {
       "External id": 1079,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373363942, "dur": 33,
    "args": {
       "External id": 1078,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373363911, "dur": 66,
    "args": {
       "External id": 1077,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373364066, "dur": 1,
    "args": {
       "External id": 1082,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373364036, "dur": 33,
    "args": {
       "External id": 1081,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373364006, "dur": 64,
    "args": {
       "External id": 1080,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373364165, "dur": 1,
    "args": {
       "External id": 1085,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373364135, "dur": 33,
    "args": {
       "External id": 1084,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373364106, "dur": 63,
    "args": {
       "External id": 1083,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373364262, "dur": 0,
    "args": {
       "External id": 1088,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373364233, "dur": 31,
    "args": {
       "External id": 1087,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373364203, "dur": 63,
    "args": {
       "External id": 1086,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373364356, "dur": 1,
    "args": {
       "External id": 1091,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373364327, "dur": 33,
    "args": {
       "External id": 1090,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373364297, "dur": 65,
    "args": {
       "External id": 1089,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373364451, "dur": 1,
    "args": {
       "External id": 1094,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373364421, "dur": 33,
    "args": {
       "External id": 1093,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373364391, "dur": 65,
    "args": {
       "External id": 1092,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373364547, "dur": 1,
    "args": {
       "External id": 1097,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373364517, "dur": 32,
    "args": {
       "External id": 1096,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373364485, "dur": 66,
    "args": {
       "External id": 1095,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373364646, "dur": 1,
    "args": {
       "External id": 1100,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373364615, "dur": 34,
    "args": {
       "External id": 1099,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373364582, "dur": 68,
    "args": {
       "External id": 1098,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373364742, "dur": 1,
    "args": {
       "External id": 1103,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373364712, "dur": 33,
    "args": {
       "External id": 1102,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373364684, "dur": 63,
    "args": {
       "External id": 1101,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373364836, "dur": 1,
    "args": {
       "External id": 1106,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373364808, "dur": 31,
    "args": {
       "External id": 1105,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373364778, "dur": 62,
    "args": {
       "External id": 1104,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373364931, "dur": 2,
    "args": {
       "External id": 1109,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373364902, "dur": 33,
    "args": {
       "External id": 1108,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373364871, "dur": 65,
    "args": {
       "External id": 1107,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373365031, "dur": 0,
    "args": {
       "External id": 1112,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373365000, "dur": 33,
    "args": {
       "External id": 1111,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373364966, "dur": 69,
    "args": {
       "External id": 1110,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373365125, "dur": 1,
    "args": {
       "External id": 1115,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373365095, "dur": 33,
    "args": {
       "External id": 1114,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373365064, "dur": 68,
    "args": {
       "External id": 1113,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373365222, "dur": 1,
    "args": {
       "External id": 1118,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373365191, "dur": 34,
    "args": {
       "External id": 1117,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373365163, "dur": 63,
    "args": {
       "External id": 1116,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::split_with_sizes", "pid": 2762, "tid": 2762,
    "ts": 1638252373363188, "dur": 2056,
    "args": {
       "External id": 1055,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Int"], "Fwd thread id": 0, "Sequence number": 230
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373365288, "dur": 6,
    "args": {
       "External id": 1119,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9216], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 231
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373365333, "dur": 4,
    "args": {
       "External id": 1120,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[15360], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 232
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373365371, "dur": 6,
    "args": {
       "External id": 1121,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 233
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373365410, "dur": 3,
    "args": {
       "External id": 1122,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 234
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373365447, "dur": 3,
    "args": {
       "External id": 1123,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 235
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373365485, "dur": 3,
    "args": {
       "External id": 1124,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 236
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373365521, "dur": 3,
    "args": {
       "External id": 1125,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 237
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373365558, "dur": 4,
    "args": {
       "External id": 1126,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 238
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373365599, "dur": 8,
    "args": {
       "External id": 1127,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 239
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373365647, "dur": 3,
    "args": {
       "External id": 1128,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 240
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373365684, "dur": 4,
    "args": {
       "External id": 1129,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 241
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373365720, "dur": 6,
    "args": {
       "External id": 1130,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 242
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373365757, "dur": 6,
    "args": {
       "External id": 1131,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 243
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373365795, "dur": 3,
    "args": {
       "External id": 1132,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 244
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373365831, "dur": 4,
    "args": {
       "External id": 1133,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 245
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373365868, "dur": 3,
    "args": {
       "External id": 1134,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 246
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373365905, "dur": 4,
    "args": {
       "External id": 1135,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 247
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373365943, "dur": 3,
    "args": {
       "External id": 1136,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 248
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373365977, "dur": 6,
    "args": {
       "External id": 1137,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 249
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373366014, "dur": 3,
    "args": {
       "External id": 1138,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 250
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373366050, "dur": 4,
    "args": {
       "External id": 1139,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[15360], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 251
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373366147, "dur": 2,
    "args": {
       "External id": 1140,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373366180, "dur": 0,
    "args": {
       "External id": 1141,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 252
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "detach_", "pid": 2762, "tid": 2762,
    "ts": 1638252373366237, "dur": 1,
    "args": {
       "External id": 1143,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::detach_", "pid": 2762, "tid": 2762,
    "ts": 1638252373366211, "dur": 28,
    "args": {
       "External id": 1142,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"], "Fwd thread id": 0, "Sequence number": 252
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373366297,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005766581376, "Bytes": 5056, "Total Allocated": 10928, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373366328,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005765044800, "Bytes": 816, "Total Allocated": 11744, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373366446, "dur": 23,
    "args": {
       "External id": 1147,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373366501, "dur": 28,
    "args": {
       "External id": 1148,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2762, "tid": 2762,
    "ts": 1638252373366414, "dur": 117,
    "args": {
       "External id": 1146,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373366382, "dur": 151,
    "args": {
       "External id": 1145,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373366641, "dur": 5,
    "args": {
       "External id": 1151,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373366681, "dur": 20,
    "args": {
       "External id": 1152,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2762, "tid": 2762,
    "ts": 1638252373366610, "dur": 93,
    "args": {
       "External id": 1150,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373366571, "dur": 134,
    "args": {
       "External id": 1149,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 2762, "tid": 2762,
    "ts": 1638252373366866, "dur": 2,
    "args": {
       "External id": 1155,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2762, "tid": 2762,
    "ts": 1638252373366831, "dur": 39,
    "args": {
       "External id": 1154,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373366949, "dur": 6,
    "args": {
       "External id": 1157,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373367004,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395333812224, "Bytes": 18874368, "Total Allocated": 161905664, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2762, "tid": 2762,
    "ts": 1638252373366997, "dur": 14,
    "args": {
       "External id": 1158,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::index_select", "pid": 2762, "tid": 2762,
    "ts": 1638252373366909, "dur": 135,
    "args": {
       "External id": 1156,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], [3072]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "long int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373367084, "dur": 2,
    "args": {
       "External id": 1159,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::embedding", "pid": 2762, "tid": 2762,
    "ts": 1638252373366793, "dur": 297,
    "args": {
       "External id": 1153,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [512, 6], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "Int", "Bool", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373367165, "dur": 2,
    "args": {
       "External id": 1161,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373367132, "dur": 39,
    "args": {
       "External id": 1160,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373367233, "dur": 1,
    "args": {
       "External id": 1163,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373367201, "dur": 36,
    "args": {
       "External id": 1162,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373367292,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": 18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 2762, "tid": 2762,
    "ts": 1638252373367281, "dur": 41,
    "args": {
       "External id": 1164,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373367501,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395375755264, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373367491, "dur": 17,
    "args": {
       "External id": 1168,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373367455, "dur": 56,
    "args": {
       "External id": 1167,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373367595,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395394629632, "Bytes": 4718592, "Total Allocated": 204372992, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373367587, "dur": 21,
    "args": {
       "External id": 1170,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373367551, "dur": 60,
    "args": {
       "External id": 1169,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373367417, "dur": 221,
    "args": {
       "External id": 1166,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373367642,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395394629632, "Bytes": -4718592, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373367380, "dur": 266,
    "args": {
       "External id": 1165,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373367651,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373367823,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395394629632, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373367819, "dur": 13,
    "args": {
       "External id": 1173,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373367880,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091328, "Bytes": 12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373367876, "dur": 10,
    "args": {
       "External id": 1174,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373367942,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533103616, "Bytes": 12288, "Total Allocated": 199678976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373367938, "dur": 9,
    "args": {
       "External id": 1175,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373368025, "dur": 2,
    "args": {
       "External id": 1176,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373368074, "dur": 1,
    "args": {
       "External id": 1177,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373367772, "dur": 308,
    "args": {
       "External id": 1172,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373368083,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091328, "Bytes": -12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373368088,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533103616, "Bytes": -12288, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373367731, "dur": 360,
    "args": {
       "External id": 1171,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373368298, "dur": 2,
    "args": {
       "External id": 1181,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373368253, "dur": 49,
    "args": {
       "External id": 1180,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373368205, "dur": 100,
    "args": {
       "External id": 1179,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373368397, "dur": 3,
    "args": {
       "External id": 1183,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373368453,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": 18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373368447, "dur": 78,
    "args": {
       "External id": 1184,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373368634, "dur": 1,
    "args": {
       "External id": 1186,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373368579, "dur": 59,
    "args": {
       "External id": 1185,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373368352, "dur": 289,
    "args": {
       "External id": 1182,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373368688, "dur": 29,
    "args": {
       "External id": 1187,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373368160, "dur": 560,
    "args": {
       "External id": 1178,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373368771, "dur": 4,
    "args": {
       "External id": 1188,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373368863, "dur": 2,
    "args": {
       "External id": 1190,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373368821, "dur": 48,
    "args": {
       "External id": 1189,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373369063, "dur": 2,
    "args": {
       "External id": 1194,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373369017, "dur": 50,
    "args": {
       "External id": 1193,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373368973, "dur": 97,
    "args": {
       "External id": 1192,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373369160, "dur": 2,
    "args": {
       "External id": 1196,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373369217,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373369210, "dur": 65,
    "args": {
       "External id": 1197,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373369373, "dur": 1,
    "args": {
       "External id": 1199,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373369328, "dur": 49,
    "args": {
       "External id": 1198,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373369115, "dur": 265,
    "args": {
       "External id": 1195,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373369429, "dur": 25,
    "args": {
       "External id": 1200,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373368928, "dur": 529,
    "args": {
       "External id": 1191,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373369504, "dur": 3,
    "args": {
       "External id": 1201,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373369593, "dur": 1,
    "args": {
       "External id": 1203,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373369551, "dur": 46,
    "args": {
       "External id": 1202,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373369796, "dur": 1,
    "args": {
       "External id": 1207,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373369752, "dur": 47,
    "args": {
       "External id": 1206,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373369707, "dur": 95,
    "args": {
       "External id": 1205,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373369897, "dur": 3,
    "args": {
       "External id": 1209,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373369954,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395432378368, "Bytes": 18874368, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373369948, "dur": 64,
    "args": {
       "External id": 1210,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373370109, "dur": 1,
    "args": {
       "External id": 1212,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373370064, "dur": 48,
    "args": {
       "External id": 1211,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373369849, "dur": 266,
    "args": {
       "External id": 1208,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373370161, "dur": 26,
    "args": {
       "External id": 1213,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373369664, "dur": 528,
    "args": {
       "External id": 1204,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373370246, "dur": 3,
    "args": {
       "External id": 1214,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373370332, "dur": 2,
    "args": {
       "External id": 1216,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373370291, "dur": 46,
    "args": {
       "External id": 1215,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373370421, "dur": 1,
    "args": {
       "External id": 1218,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373370381, "dur": 44,
    "args": {
       "External id": 1217,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373370554, "dur": 1,
    "args": {
       "External id": 1221,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373370511, "dur": 47,
    "args": {
       "External id": 1220,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373370732,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": 18874368, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373370726, "dur": 14,
    "args": {
       "External id": 1225,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373370687, "dur": 58,
    "args": {
       "External id": 1224,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373370786, "dur": 28,
    "args": {
       "External id": 1226,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2762, "tid": 2762,
    "ts": 1638252373370648, "dur": 169,
    "args": {
       "External id": 1223,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373371019, "dur": 2,
    "args": {
       "External id": 1228,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373370978, "dur": 47,
    "args": {
       "External id": 1227,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2762, "tid": 2762,
    "ts": 1638252373370607, "dur": 420,
    "args": {
       "External id": 1222,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373371158, "dur": 1,
    "args": {
       "External id": 1230,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373371069, "dur": 94,
    "args": {
       "External id": 1229,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373371492,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": 18874368, "Total Allocated": 294026240, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373371488, "dur": 12,
    "args": {
       "External id": 1234,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373371401, "dur": 104,
    "args": {
       "External id": 1233,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373371551, "dur": 26,
    "args": {
       "External id": 1235,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2762, "tid": 2762,
    "ts": 1638252373371320, "dur": 259,
    "args": {
       "External id": 1232,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373371695, "dur": 2,
    "args": {
       "External id": 1237,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373371636, "dur": 63,
    "args": {
       "External id": 1236,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2762, "tid": 2762,
    "ts": 1638252373371224, "dur": 477,
    "args": {
       "External id": 1231,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373371859,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391848345600, "Bytes": 3538944, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373371852, "dur": 15,
    "args": {
       "External id": 1239,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 2762, "tid": 2762,
    "ts": 1638252373371798, "dur": 100,
    "args": {
       "External id": 1238,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], [24576, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373371985, "dur": 2,
    "args": {
       "External id": 1241,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373371945, "dur": 44,
    "args": {
       "External id": 1240,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373371992,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373371997,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": -18874368, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373370469, "dur": 1532,
    "args": {
       "External id": 1219,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373372020,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005766928000, "Bytes": 8, "Total Allocated": 11752, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373372080,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391851884544, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mul", "pid": 2762, "tid": 2762,
    "ts": 1638252373372071, "dur": 37,
    "args": {
       "External id": 1242,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373372114,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005766928000, "Bytes": -8, "Total Allocated": 11744, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373372120,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391848345600, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373372224, "dur": 2,
    "args": {
       "External id": 1244,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373372183, "dur": 47,
    "args": {
       "External id": 1243,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373372315, "dur": 8,
    "args": {
       "External id": 1246,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373372276, "dur": 52,
    "args": {
       "External id": 1245,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373372377,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005766950336, "Bytes": 8, "Total Allocated": 11752, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373372389,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091328, "Bytes": 512, "Total Allocated": 259816960, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373372398,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005766950336, "Bytes": -8, "Total Allocated": 11744, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::eq", "pid": 2762, "tid": 2762,
    "ts": 1638252373372375, "dur": 48,
    "args": {
       "External id": 1247,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373372557, "dur": 2,
    "args": {
       "External id": 1250,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373372514, "dur": 48,
    "args": {
       "External id": 1249,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373372653, "dur": 1,
    "args": {
       "External id": 1252,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373372612, "dur": 45,
    "args": {
       "External id": 1251,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373372785,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391855423488, "Bytes": 3538944, "Total Allocated": 263355904, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373372780, "dur": 12,
    "args": {
       "External id": 1255,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373372740, "dur": 55,
    "args": {
       "External id": 1254,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373372837, "dur": 32,
    "args": {
       "External id": 1256,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2762, "tid": 2762,
    "ts": 1638252373372699, "dur": 173,
    "args": {
       "External id": 1253,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373373001, "dur": 2,
    "args": {
       "External id": 1259,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373372962, "dur": 43,
    "args": {
       "External id": 1258,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill_", "pid": 2762, "tid": 2762,
    "ts": 1638252373372918, "dur": 114,
    "args": {
       "External id": 1257,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill", "pid": 2762, "tid": 2762,
    "ts": 1638252373372475, "dur": 560,
    "args": {
       "External id": 1248,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373373040,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091328, "Bytes": -512, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373373045,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391851884544, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373373145,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391858962432, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_softmax", "pid": 2762, "tid": 2762,
    "ts": 1638252373373139, "dur": 32,
    "args": {
       "External id": 1261,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::softmax", "pid": 2762, "tid": 2762,
    "ts": 1638252373373099, "dur": 75,
    "args": {
       "External id": 1260,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373373178,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391855423488, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373373407,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391862501376, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373373398, "dur": 16,
    "args": {
       "External id": 1265,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373373352, "dur": 65,
    "args": {
       "External id": 1264,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373373515,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533275648, "Bytes": 884736, "Total Allocated": 264240128, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373373508, "dur": 13,
    "args": {
       "External id": 1267,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373373464, "dur": 62,
    "args": {
       "External id": 1266,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373373303, "dur": 249,
    "args": {
       "External id": 1263,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373373555,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533275648, "Bytes": -884736, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373373256, "dur": 303,
    "args": {
       "External id": 1262,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373373565,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391858962432, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373373703, "dur": 1,
    "args": {
       "External id": 1270,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373373661, "dur": 47,
    "args": {
       "External id": 1269,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 2762, "tid": 2762,
    "ts": 1638252373373791, "dur": 3,
    "args": {
       "External id": 1272,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2762, "tid": 2762,
    "ts": 1638252373373750, "dur": 47,
    "args": {
       "External id": 1271,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373373879, "dur": 1,
    "args": {
       "External id": 1274,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373373838, "dur": 45,
    "args": {
       "External id": 1273,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373374054,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391866040320, "Bytes": 18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373374049, "dur": 11,
    "args": {
       "External id": 1278,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373374007, "dur": 58,
    "args": {
       "External id": 1277,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373374107, "dur": 28,
    "args": {
       "External id": 1279,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2762, "tid": 2762,
    "ts": 1638252373373962, "dur": 176,
    "args": {
       "External id": 1276,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373374226, "dur": 2,
    "args": {
       "External id": 1281,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373374181, "dur": 49,
    "args": {
       "External id": 1280,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2762, "tid": 2762,
    "ts": 1638252373373924, "dur": 308,
    "args": {
       "External id": 1275,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373374322,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373374318, "dur": 11,
    "args": {
       "External id": 1283,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 2762, "tid": 2762,
    "ts": 1638252373374274, "dur": 79,
    "args": {
       "External id": 1282,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], [24576, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373374439, "dur": 2,
    "args": {
       "External id": 1285,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373374398, "dur": 45,
    "args": {
       "External id": 1284,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373374446,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391866040320, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373373620, "dur": 831,
    "args": {
       "External id": 1268,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373374536, "dur": 1,
    "args": {
       "External id": 1287,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373374495, "dur": 45,
    "args": {
       "External id": 1286,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373374721,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391866040320, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373374716, "dur": 11,
    "args": {
       "External id": 1291,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373374675, "dur": 54,
    "args": {
       "External id": 1290,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373374771, "dur": 26,
    "args": {
       "External id": 1292,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2762, "tid": 2762,
    "ts": 1638252373374634, "dur": 165,
    "args": {
       "External id": 1289,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::contiguous", "pid": 2762, "tid": 2762,
    "ts": 1638252373374589, "dur": 212,
    "args": {
       "External id": 1288,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373374850, "dur": 3,
    "args": {
       "External id": 1293,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373374858,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373375061, "dur": 1,
    "args": {
       "External id": 1297,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373375015, "dur": 49,
    "args": {
       "External id": 1296,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373374970, "dur": 98,
    "args": {
       "External id": 1295,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373375156, "dur": 3,
    "args": {
       "External id": 1299,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373375214,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373375207, "dur": 73,
    "args": {
       "External id": 1300,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373375382, "dur": 2,
    "args": {
       "External id": 1302,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373375337, "dur": 49,
    "args": {
       "External id": 1301,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373375114, "dur": 275,
    "args": {
       "External id": 1298,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373375434, "dur": 28,
    "args": {
       "External id": 1303,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373374925, "dur": 541,
    "args": {
       "External id": 1294,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373375696,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": 18874368, "Total Allocated": 316439552, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373375685, "dur": 20,
    "args": {
       "External id": 1307,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373375635, "dur": 73,
    "args": {
       "External id": 1306,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373375807,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391848345600, "Bytes": 4718592, "Total Allocated": 321158144, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373375799, "dur": 14,
    "args": {
       "External id": 1309,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373375753, "dur": 62,
    "args": {
       "External id": 1308,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373375578, "dur": 265,
    "args": {
       "External id": 1305,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373375846,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391848345600, "Bytes": -4718592, "Total Allocated": 316439552, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373375531, "dur": 319,
    "args": {
       "External id": 1304,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373375855,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": -18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373375863,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391866040320, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373375869,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": -18874368, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373375874,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": -18874368, "Total Allocated": 240942080, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373375878,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395432378368, "Bytes": -18874368, "Total Allocated": 222067712, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373375883,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391862501376, "Bytes": -3538944, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373375941,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 2762, "tid": 2762,
    "ts": 1638252373375933, "dur": 33,
    "args": {
       "External id": 1310,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373375972,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": -18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373376134,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373376129, "dur": 11,
    "args": {
       "External id": 1313,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373376189,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091328, "Bytes": 12288, "Total Allocated": 237415424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373376185, "dur": 10,
    "args": {
       "External id": 1314,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373376244,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533103616, "Bytes": 12288, "Total Allocated": 237427712, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373376240, "dur": 11,
    "args": {
       "External id": 1315,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373376337, "dur": 3,
    "args": {
       "External id": 1316,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373376383, "dur": 1,
    "args": {
       "External id": 1317,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373376083, "dur": 306,
    "args": {
       "External id": 1312,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373376392,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091328, "Bytes": -12288, "Total Allocated": 237415424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373376396,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533103616, "Bytes": -12288, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373376043, "dur": 357,
    "args": {
       "External id": 1311,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373376608, "dur": 1,
    "args": {
       "External id": 1321,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373376556, "dur": 58,
    "args": {
       "External id": 1320,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373376510, "dur": 107,
    "args": {
       "External id": 1319,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373376708, "dur": 3,
    "args": {
       "External id": 1323,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373376765,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140392213250048, "Bytes": 75497472, "Total Allocated": 312900608, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373376759, "dur": 49,
    "args": {
       "External id": 1324,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373376905, "dur": 1,
    "args": {
       "External id": 1326,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373376860, "dur": 48,
    "args": {
       "External id": 1325,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373376662, "dur": 252,
    "args": {
       "External id": 1322,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373376960, "dur": 27,
    "args": {
       "External id": 1327,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373376468, "dur": 521,
    "args": {
       "External id": 1318,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [6144, 1536], [6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373377055,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140396522897408, "Bytes": 75497472, "Total Allocated": 388398080, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::gelu", "pid": 2762, "tid": 2762,
    "ts": 1638252373377048, "dur": 34,
    "args": {
       "External id": 1328,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1556): gelu;/miniconda/lib/python3.8/site-packages/torch/nn/modules/activation.py(652): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373377087,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140392213250048, "Bytes": -75497472, "Total Allocated": 312900608, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373377280, "dur": 1,
    "args": {
       "External id": 1332,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373377235, "dur": 49,
    "args": {
       "External id": 1331,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373377190, "dur": 97,
    "args": {
       "External id": 1330,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373377378, "dur": 3,
    "args": {
       "External id": 1334,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373377440,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": 18874368, "Total Allocated": 331774976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373377434, "dur": 59,
    "args": {
       "External id": 1335,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373377591, "dur": 2,
    "args": {
       "External id": 1337,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373377546, "dur": 49,
    "args": {
       "External id": 1336,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373377333, "dur": 275,
    "args": {
       "External id": 1333,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373377655, "dur": 26,
    "args": {
       "External id": 1338,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373377144, "dur": 539,
    "args": {
       "External id": 1329,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [1536, 6144], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373377690,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140396522897408, "Bytes": -75497472, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373377906,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395432378368, "Bytes": 18874368, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373377896, "dur": 16,
    "args": {
       "External id": 1342,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373377851, "dur": 64,
    "args": {
       "External id": 1341,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373378015,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": 4718592, "Total Allocated": 279870464, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373378008, "dur": 13,
    "args": {
       "External id": 1344,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373377962, "dur": 62,
    "args": {
       "External id": 1343,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373377801, "dur": 250,
    "args": {
       "External id": 1340,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373378054,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": -4718592, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373377756, "dur": 302,
    "args": {
       "External id": 1339,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373378063,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": -18874368, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373378071,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": -18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373378077,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395394629632, "Bytes": -18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373378082,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": -18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373378088,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395375755264, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373378227,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373378223, "dur": 10,
    "args": {
       "External id": 1347,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373378276,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091328, "Bytes": 12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373378272, "dur": 9,
    "args": {
       "External id": 1348,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373378327,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533103616, "Bytes": 12288, "Total Allocated": 199678976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373378323, "dur": 9,
    "args": {
       "External id": 1349,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373378402, "dur": 3,
    "args": {
       "External id": 1350,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373378440, "dur": 1,
    "args": {
       "External id": 1351,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373378183, "dur": 263,
    "args": {
       "External id": 1346,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373378449,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091328, "Bytes": -12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373378453,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533103616, "Bytes": -12288, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373378147, "dur": 312,
    "args": {
       "External id": 1345,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373378465,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395432378368, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373378631, "dur": 2,
    "args": {
       "External id": 1355,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373378588, "dur": 47,
    "args": {
       "External id": 1354,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373378551, "dur": 87,
    "args": {
       "External id": 1353,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373378713, "dur": 3,
    "args": {
       "External id": 1357,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373378763,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533275648, "Bytes": 122880, "Total Allocated": 180902912, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373378756, "dur": 44,
    "args": {
       "External id": 1358,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 10]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373378877, "dur": 1,
    "args": {
       "External id": 1360,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373378840, "dur": 41,
    "args": {
       "External id": 1359,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373378675, "dur": 209,
    "args": {
       "External id": 1356,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 10]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373378516, "dur": 370,
    "args": {
       "External id": 1352,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [10, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373378892,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": -18874368, "Total Allocated": 162028544, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373378934, "dur": 2,
    "args": {
       "External id": 1361,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 10], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373378971, "dur": 2,
    "args": {
       "External id": 1362,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373379083, "dur": 1,
    "args": {
       "External id": 1365,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373379122,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533398528, "Bytes": 122880, "Total Allocated": 162151424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_log_softmax", "pid": 2762, "tid": 2762,
    "ts": 1638252373379116, "dur": 33,
    "args": {
       "External id": 1366,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::log_softmax", "pid": 2762, "tid": 2762,
    "ts": 1638252373379049, "dur": 102,
    "args": {
       "External id": 1364,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373379264,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091328, "Bytes": 512, "Total Allocated": 162151936, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373379271,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091840, "Bytes": 512, "Total Allocated": 162152448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2762, "tid": 2762,
    "ts": 1638252373379309, "dur": 1,
    "args": {
       "External id": 1370,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2762, "tid": 2762,
    "ts": 1638252373379343, "dur": 1,
    "args": {
       "External id": 1371,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss_forward", "pid": 2762, "tid": 2762,
    "ts": 1638252373379259, "dur": 106,
    "args": {
       "External id": 1369,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373379368,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091840, "Bytes": -512, "Total Allocated": 162151936, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss", "pid": 2762, "tid": 2762,
    "ts": 1638252373379226, "dur": 146,
    "args": {
       "External id": 1368,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss_nd", "pid": 2762, "tid": 2762,
    "ts": 1638252373379193, "dur": 181,
    "args": {
       "External id": 1367,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373379376,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533398528, "Bytes": -122880, "Total Allocated": 162029056, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::cross_entropy_loss", "pid": 2762, "tid": 2762,
    "ts": 1638252373379016, "dur": 366,
    "args": {
       "External id": 1363,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373379388,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395333812224, "Bytes": -18874368, "Total Allocated": 143154688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "CheckpointFunction", "pid": 2762, "tid": 2762,
    "ts": 1638252373366269, "dur": 13222,
    "args": {
       "External id": 1144,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Fwd thread id": 0, "Sequence number": 252
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2762, "tid": 2762,
    "ts": 1638252373379546, "dur": 1,
    "args": {
       "External id": 1372,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [7093632]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1822): _use_fp32_param_shard;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1153): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373379621,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533152768, "Bytes": -122880, "Total Allocated": 143031808, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373379656,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005765113728, "Bytes": -5056, "Total Allocated": 6688, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373379661,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005762511808, "Bytes": -816, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373379670,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533090816, "Bytes": -512, "Total Allocated": 143031296, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "ProfilerStep#9", "pid": 2762, "tid": 2762,
    "ts": 1638252373361509, "dur": 27342,
    "args": {
       "External id": 1033,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(330): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;"
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373388932,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005765116800, "Bytes": 4, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373388930, "dur": 9,
    "args": {
       "External id": 1374,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zero_", "pid": 2762, "tid": 2762,
    "ts": 1638252373388962, "dur": 1,
    "args": {
       "External id": 1375,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zeros", "pid": 2762, "tid": 2762,
    "ts": 1638252373388907, "dur": 58,
    "args": {
       "External id": 1373,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373389019,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005767423424, "Bytes": 16, "Total Allocated": 5892, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373389018, "dur": 8,
    "args": {
       "External id": 1377,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(330): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373389028,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005767423424, "Bytes": -16, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373389034,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005765116800, "Bytes": -4, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373389095,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005767429120, "Bytes": 4, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373389094, "dur": 5,
    "args": {
       "External id": 1379,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zero_", "pid": 2762, "tid": 2762,
    "ts": 1638252373389124, "dur": 0,
    "args": {
       "External id": 1380,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zeros", "pid": 2762, "tid": 2762,
    "ts": 1638252373389072, "dur": 54,
    "args": {
       "External id": 1378,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373389179,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005767435136, "Bytes": 16, "Total Allocated": 5892, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373389178, "dur": 4,
    "args": {
       "External id": 1382,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373389184,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005767435136, "Bytes": -16, "Total Allocated": 5876, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373389189,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005767429120, "Bytes": -4, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "enumerate(DataLoader)#_MultiProcessingDataLoaderIter.__next__", "pid": 2762, "tid": 2762,
    "ts": 1638252373389154, "dur": 89,
    "args": {
       "External id": 1381,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(171): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;"
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373389281,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533041664, "Bytes": -24576, "Total Allocated": 143006720, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373389288,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533066240, "Bytes": -24576, "Total Allocated": 142982144, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373389368,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533041664, "Bytes": 24576, "Total Allocated": 143006720, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373389357, "dur": 21,
    "args": {
       "External id": 1385,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373389401, "dur": 42,
    "args": {
       "External id": 1386,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2762, "tid": 2762,
    "ts": 1638252373389336, "dur": 109,
    "args": {
       "External id": 1384,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""], "Fwd thread id": 0, "Sequence number": 253
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373389316, "dur": 131,
    "args": {
       "External id": 1383,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 253
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373389518,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533066240, "Bytes": 24576, "Total Allocated": 143031296, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373389510, "dur": 15,
    "args": {
       "External id": 1389,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373389546, "dur": 33,
    "args": {
       "External id": 1390,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2762, "tid": 2762,
    "ts": 1638252373389491, "dur": 90,
    "args": {
       "External id": 1388,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""], "Fwd thread id": 0, "Sequence number": 253
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373389470, "dur": 113,
    "args": {
       "External id": 1387,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(173): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 253
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373389966, "dur": 1,
    "args": {
       "External id": 1391,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(479): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 253
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373389999, "dur": 0,
    "args": {
       "External id": 1392,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(481): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 253
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2762, "tid": 2762,
    "ts": 1638252373390193, "dur": 0,
    "args": {
       "External id": 1393,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[7093632], [28374528]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1570): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373390261, "dur": 2,
    "args": {
       "External id": 1395,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373390231, "dur": 36,
    "args": {
       "External id": 1394,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373390303, "dur": 5,
    "args": {
       "External id": 1396,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2762, "tid": 2762,
    "ts": 1638252373390337, "dur": 1,
    "args": {
       "External id": 1397,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [28374528]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373390516, "dur": 1,
    "args": {
       "External id": 1401,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373390486, "dur": 34,
    "args": {
       "External id": 1400,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373390454, "dur": 67,
    "args": {
       "External id": 1399,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373390630, "dur": 1,
    "args": {
       "External id": 1404,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373390589, "dur": 44,
    "args": {
       "External id": 1403,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373390554, "dur": 80,
    "args": {
       "External id": 1402,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373390726, "dur": 1,
    "args": {
       "External id": 1407,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373390695, "dur": 34,
    "args": {
       "External id": 1406,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373390665, "dur": 66,
    "args": {
       "External id": 1405,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373390822, "dur": 0,
    "args": {
       "External id": 1410,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373390791, "dur": 33,
    "args": {
       "External id": 1409,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373390760, "dur": 66,
    "args": {
       "External id": 1408,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373390923, "dur": 1,
    "args": {
       "External id": 1413,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373390892, "dur": 34,
    "args": {
       "External id": 1412,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373390858, "dur": 69,
    "args": {
       "External id": 1411,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373391019, "dur": 1,
    "args": {
       "External id": 1416,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373390987, "dur": 35,
    "args": {
       "External id": 1415,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373390959, "dur": 64,
    "args": {
       "External id": 1414,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373391114, "dur": 0,
    "args": {
       "External id": 1419,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373391085, "dur": 31,
    "args": {
       "External id": 1418,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373391054, "dur": 64,
    "args": {
       "External id": 1417,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373391208, "dur": 2,
    "args": {
       "External id": 1422,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373391179, "dur": 33,
    "args": {
       "External id": 1421,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373391149, "dur": 65,
    "args": {
       "External id": 1420,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373391305, "dur": 0,
    "args": {
       "External id": 1425,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373391274, "dur": 33,
    "args": {
       "External id": 1424,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373391244, "dur": 67,
    "args": {
       "External id": 1423,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373391401, "dur": 1,
    "args": {
       "External id": 1428,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373391371, "dur": 33,
    "args": {
       "External id": 1427,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373391340, "dur": 65,
    "args": {
       "External id": 1426,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373391495, "dur": 1,
    "args": {
       "External id": 1431,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373391464, "dur": 33,
    "args": {
       "External id": 1430,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373391436, "dur": 63,
    "args": {
       "External id": 1429,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373391590, "dur": 1,
    "args": {
       "External id": 1434,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373391558, "dur": 35,
    "args": {
       "External id": 1433,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373391530, "dur": 64,
    "args": {
       "External id": 1432,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373391691, "dur": 1,
    "args": {
       "External id": 1437,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373391662, "dur": 32,
    "args": {
       "External id": 1436,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373391632, "dur": 63,
    "args": {
       "External id": 1435,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373391784, "dur": 3,
    "args": {
       "External id": 1440,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373391756, "dur": 35,
    "args": {
       "External id": 1439,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373391726, "dur": 66,
    "args": {
       "External id": 1438,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373391882, "dur": 1,
    "args": {
       "External id": 1443,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373391851, "dur": 33,
    "args": {
       "External id": 1442,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373391822, "dur": 64,
    "args": {
       "External id": 1441,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373391975, "dur": 1,
    "args": {
       "External id": 1446,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373391945, "dur": 33,
    "args": {
       "External id": 1445,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373391915, "dur": 64,
    "args": {
       "External id": 1444,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373392071, "dur": 0,
    "args": {
       "External id": 1449,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373392038, "dur": 35,
    "args": {
       "External id": 1448,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373392010, "dur": 65,
    "args": {
       "External id": 1447,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373392171, "dur": 1,
    "args": {
       "External id": 1452,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373392135, "dur": 39,
    "args": {
       "External id": 1451,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373392107, "dur": 68,
    "args": {
       "External id": 1450,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373392265, "dur": 1,
    "args": {
       "External id": 1455,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373392237, "dur": 33,
    "args": {
       "External id": 1454,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373392206, "dur": 65,
    "args": {
       "External id": 1453,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373392363, "dur": 1,
    "args": {
       "External id": 1458,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373392332, "dur": 34,
    "args": {
       "External id": 1457,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373392302, "dur": 65,
    "args": {
       "External id": 1456,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373392457, "dur": 1,
    "args": {
       "External id": 1461,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373392427, "dur": 33,
    "args": {
       "External id": 1460,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 2762, "tid": 2762,
    "ts": 1638252373392397, "dur": 65,
    "args": {
       "External id": 1459,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::split_with_sizes", "pid": 2762, "tid": 2762,
    "ts": 1638252373390418, "dur": 2061,
    "args": {
       "External id": 1398,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Int"], "Fwd thread id": 0, "Sequence number": 253
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373392523, "dur": 6,
    "args": {
       "External id": 1462,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9216], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 254
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373392566, "dur": 6,
    "args": {
       "External id": 1463,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[15360], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 255
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373392611, "dur": 4,
    "args": {
       "External id": 1464,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 256
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373392650, "dur": 4,
    "args": {
       "External id": 1465,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 257
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373392689, "dur": 3,
    "args": {
       "External id": 1466,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 258
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373392727, "dur": 3,
    "args": {
       "External id": 1467,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 259
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373392764, "dur": 4,
    "args": {
       "External id": 1468,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 260
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373392802, "dur": 4,
    "args": {
       "External id": 1469,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 261
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373392840, "dur": 4,
    "args": {
       "External id": 1470,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 262
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373392876, "dur": 5,
    "args": {
       "External id": 1471,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 263
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373392913, "dur": 5,
    "args": {
       "External id": 1472,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 264
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373392950, "dur": 4,
    "args": {
       "External id": 1473,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 265
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373392987, "dur": 3,
    "args": {
       "External id": 1474,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 266
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373393024, "dur": 4,
    "args": {
       "External id": 1475,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 267
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373393061, "dur": 3,
    "args": {
       "External id": 1476,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 268
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373393098, "dur": 4,
    "args": {
       "External id": 1477,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 269
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373393133, "dur": 6,
    "args": {
       "External id": 1478,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 270
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373393170, "dur": 4,
    "args": {
       "External id": 1479,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 271
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373393207, "dur": 3,
    "args": {
       "External id": 1480,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 272
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373393246, "dur": 3,
    "args": {
       "External id": 1481,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 273
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373393284, "dur": 4,
    "args": {
       "External id": 1482,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[15360], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 274
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373393380, "dur": 3,
    "args": {
       "External id": 1483,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373393413, "dur": 0,
    "args": {
       "External id": 1484,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 275
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "detach_", "pid": 2762, "tid": 2762,
    "ts": 1638252373393467, "dur": 1,
    "args": {
       "External id": 1486,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::detach_", "pid": 2762, "tid": 2762,
    "ts": 1638252373393442, "dur": 28,
    "args": {
       "External id": 1485,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"], "Fwd thread id": 0, "Sequence number": 275
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373393526,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005767731136, "Bytes": 5056, "Total Allocated": 10928, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373393554,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005766512448, "Bytes": 816, "Total Allocated": 11744, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373393682, "dur": 9,
    "args": {
       "External id": 1490,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373393724, "dur": 29,
    "args": {
       "External id": 1491,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2762, "tid": 2762,
    "ts": 1638252373393649, "dur": 106,
    "args": {
       "External id": 1489,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373393617, "dur": 140,
    "args": {
       "External id": 1488,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373393862, "dur": 6,
    "args": {
       "External id": 1494,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373393901, "dur": 19,
    "args": {
       "External id": 1495,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 2762, "tid": 2762,
    "ts": 1638252373393824, "dur": 100,
    "args": {
       "External id": 1493,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373393795, "dur": 131,
    "args": {
       "External id": 1492,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 2762, "tid": 2762,
    "ts": 1638252373394083, "dur": 2,
    "args": {
       "External id": 1498,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2762, "tid": 2762,
    "ts": 1638252373394043, "dur": 45,
    "args": {
       "External id": 1497,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373394163, "dur": 6,
    "args": {
       "External id": 1500,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373394216,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395333812224, "Bytes": 18874368, "Total Allocated": 161905664, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2762, "tid": 2762,
    "ts": 1638252373394209, "dur": 14,
    "args": {
       "External id": 1501,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::index_select", "pid": 2762, "tid": 2762,
    "ts": 1638252373394125, "dur": 132,
    "args": {
       "External id": 1499,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], [3072]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "long int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373394296, "dur": 2,
    "args": {
       "External id": 1502,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::embedding", "pid": 2762, "tid": 2762,
    "ts": 1638252373394005, "dur": 297,
    "args": {
       "External id": 1496,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [512, 6], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "Int", "Bool", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373394381, "dur": 1,
    "args": {
       "External id": 1504,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373394347, "dur": 39,
    "args": {
       "External id": 1503,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373394449, "dur": 0,
    "args": {
       "External id": 1506,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373394417, "dur": 35,
    "args": {
       "External id": 1505,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373394509,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": 18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 2762, "tid": 2762,
    "ts": 1638252373394499, "dur": 43,
    "args": {
       "External id": 1507,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373394731,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395375755264, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373394721, "dur": 17,
    "args": {
       "External id": 1511,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373394684, "dur": 57,
    "args": {
       "External id": 1510,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373394822,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395394629632, "Bytes": 4718592, "Total Allocated": 204372992, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373394814, "dur": 14,
    "args": {
       "External id": 1513,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373394779, "dur": 51,
    "args": {
       "External id": 1512,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373394643, "dur": 214,
    "args": {
       "External id": 1509,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373394860,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395394629632, "Bytes": -4718592, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373394608, "dur": 257,
    "args": {
       "External id": 1508,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373394870,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373395041,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395394629632, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373395037, "dur": 13,
    "args": {
       "External id": 1516,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373395098,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091840, "Bytes": 12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373395094, "dur": 12,
    "args": {
       "External id": 1517,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373395153,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533104128, "Bytes": 12288, "Total Allocated": 199678976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373395150, "dur": 9,
    "args": {
       "External id": 1518,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373395237, "dur": 2,
    "args": {
       "External id": 1519,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373395283, "dur": 1,
    "args": {
       "External id": 1520,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373394991, "dur": 298,
    "args": {
       "External id": 1515,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373395292,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091840, "Bytes": -12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373395297,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533104128, "Bytes": -12288, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373394948, "dur": 352,
    "args": {
       "External id": 1514,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373395504, "dur": 2,
    "args": {
       "External id": 1524,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373395459, "dur": 50,
    "args": {
       "External id": 1523,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373395413, "dur": 99,
    "args": {
       "External id": 1522,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373395609, "dur": 3,
    "args": {
       "External id": 1526,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373395667,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": 18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373395661, "dur": 77,
    "args": {
       "External id": 1527,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373395837, "dur": 2,
    "args": {
       "External id": 1529,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373395792, "dur": 49,
    "args": {
       "External id": 1528,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373395559, "dur": 286,
    "args": {
       "External id": 1525,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373395890, "dur": 29,
    "args": {
       "External id": 1530,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373395369, "dur": 552,
    "args": {
       "External id": 1521,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373395978, "dur": 4,
    "args": {
       "External id": 1531,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373396071, "dur": 2,
    "args": {
       "External id": 1533,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373396027, "dur": 49,
    "args": {
       "External id": 1532,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373396276, "dur": 1,
    "args": {
       "External id": 1537,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373396231, "dur": 48,
    "args": {
       "External id": 1536,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373396186, "dur": 96,
    "args": {
       "External id": 1535,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373396373, "dur": 2,
    "args": {
       "External id": 1539,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373396433,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373396426, "dur": 67,
    "args": {
       "External id": 1540,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373396591, "dur": 2,
    "args": {
       "External id": 1542,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373396546, "dur": 49,
    "args": {
       "External id": 1541,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373396328, "dur": 270,
    "args": {
       "External id": 1538,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373396652, "dur": 26,
    "args": {
       "External id": 1543,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373396141, "dur": 540,
    "args": {
       "External id": 1534,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373396730, "dur": 3,
    "args": {
       "External id": 1544,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373396820, "dur": 1,
    "args": {
       "External id": 1546,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373396777, "dur": 47,
    "args": {
       "External id": 1545,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373397018, "dur": 1,
    "args": {
       "External id": 1550,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373396973, "dur": 48,
    "args": {
       "External id": 1549,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373396929, "dur": 95,
    "args": {
       "External id": 1548,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373397114, "dur": 2,
    "args": {
       "External id": 1552,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373397171,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395432378368, "Bytes": 18874368, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373397164, "dur": 64,
    "args": {
       "External id": 1553,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373397324, "dur": 2,
    "args": {
       "External id": 1555,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373397280, "dur": 48,
    "args": {
       "External id": 1554,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373397069, "dur": 262,
    "args": {
       "External id": 1551,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373397377, "dur": 25,
    "args": {
       "External id": 1556,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373396885, "dur": 520,
    "args": {
       "External id": 1547,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373397454, "dur": 3,
    "args": {
       "External id": 1557,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373397540, "dur": 2,
    "args": {
       "External id": 1559,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373397499, "dur": 46,
    "args": {
       "External id": 1558,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373397639, "dur": 1,
    "args": {
       "External id": 1561,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373397589, "dur": 55,
    "args": {
       "External id": 1560,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373397777, "dur": 2,
    "args": {
       "External id": 1564,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373397736, "dur": 46,
    "args": {
       "External id": 1563,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373397948,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": 18874368, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373397942, "dur": 14,
    "args": {
       "External id": 1568,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373397902, "dur": 61,
    "args": {
       "External id": 1567,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373398004, "dur": 29,
    "args": {
       "External id": 1569,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2762, "tid": 2762,
    "ts": 1638252373397863, "dur": 173,
    "args": {
       "External id": 1566,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373398123, "dur": 1,
    "args": {
       "External id": 1571,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373398083, "dur": 44,
    "args": {
       "External id": 1570,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2762, "tid": 2762,
    "ts": 1638252373397823, "dur": 306,
    "args": {
       "External id": 1565,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373398213, "dur": 1,
    "args": {
       "External id": 1573,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373398172, "dur": 45,
    "args": {
       "External id": 1572,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373398382,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": 18874368, "Total Allocated": 294026240, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373398377, "dur": 12,
    "args": {
       "External id": 1577,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373398338, "dur": 55,
    "args": {
       "External id": 1576,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373398433, "dur": 23,
    "args": {
       "External id": 1578,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2762, "tid": 2762,
    "ts": 1638252373398300, "dur": 159,
    "args": {
       "External id": 1575,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373398540, "dur": 2,
    "args": {
       "External id": 1580,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373398501, "dur": 46,
    "args": {
       "External id": 1579,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2762, "tid": 2762,
    "ts": 1638252373398259, "dur": 290,
    "args": {
       "External id": 1574,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373398645,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391848345600, "Bytes": 3538944, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373398641, "dur": 11,
    "args": {
       "External id": 1582,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 2762, "tid": 2762,
    "ts": 1638252373398590, "dur": 88,
    "args": {
       "External id": 1581,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], [24576, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373398762, "dur": 2,
    "args": {
       "External id": 1584,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373398722, "dur": 44,
    "args": {
       "External id": 1583,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373398770,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373398774,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": -18874368, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373397693, "dur": 1085,
    "args": {
       "External id": 1562,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373398794,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005768078976, "Bytes": 8, "Total Allocated": 11752, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373398852,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391851884544, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mul", "pid": 2762, "tid": 2762,
    "ts": 1638252373398843, "dur": 36,
    "args": {
       "External id": 1585,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373398885,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005768078976, "Bytes": -8, "Total Allocated": 11744, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373398893,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391848345600, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373398993, "dur": 1,
    "args": {
       "External id": 1587,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373398951, "dur": 47,
    "args": {
       "External id": 1586,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373399080, "dur": 3,
    "args": {
       "External id": 1589,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 2762, "tid": 2762,
    "ts": 1638252373399042, "dur": 44,
    "args": {
       "External id": 1588,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373399135,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005768101376, "Bytes": 8, "Total Allocated": 11752, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373399147,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533090816, "Bytes": 512, "Total Allocated": 259816960, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373399157,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005768101376, "Bytes": -8, "Total Allocated": 11744, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::eq", "pid": 2762, "tid": 2762,
    "ts": 1638252373399132, "dur": 49,
    "args": {
       "External id": 1590,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373399317, "dur": 1,
    "args": {
       "External id": 1593,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373399272, "dur": 50,
    "args": {
       "External id": 1592,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373399403, "dur": 1,
    "args": {
       "External id": 1595,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373399363, "dur": 44,
    "args": {
       "External id": 1594,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373399533,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391855423488, "Bytes": 3538944, "Total Allocated": 263355904, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373399528, "dur": 11,
    "args": {
       "External id": 1598,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373399488, "dur": 54,
    "args": {
       "External id": 1597,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373399585, "dur": 41,
    "args": {
       "External id": 1599,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2762, "tid": 2762,
    "ts": 1638252373399448, "dur": 180,
    "args": {
       "External id": 1596,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373399757, "dur": 2,
    "args": {
       "External id": 1602,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373399717, "dur": 44,
    "args": {
       "External id": 1601,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill_", "pid": 2762, "tid": 2762,
    "ts": 1638252373399673, "dur": 114,
    "args": {
       "External id": 1600,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill", "pid": 2762, "tid": 2762,
    "ts": 1638252373399232, "dur": 558,
    "args": {
       "External id": 1591,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373399795,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533090816, "Bytes": -512, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373399801,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391851884544, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373400760,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391858962432, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_softmax", "pid": 2762, "tid": 2762,
    "ts": 1638252373400750, "dur": 48,
    "args": {
       "External id": 1604,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::softmax", "pid": 2762, "tid": 2762,
    "ts": 1638252373400708, "dur": 93,
    "args": {
       "External id": 1603,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373400807,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391855423488, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373401027,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391862501376, "Bytes": 3538944, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373401017, "dur": 17,
    "args": {
       "External id": 1608,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373400972, "dur": 69,
    "args": {
       "External id": 1607,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373401138,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533398528, "Bytes": 884736, "Total Allocated": 264240128, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373401130, "dur": 14,
    "args": {
       "External id": 1610,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373401087, "dur": 59,
    "args": {
       "External id": 1609,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373400924, "dur": 251,
    "args": {
       "External id": 1606,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373401178,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533398528, "Bytes": -884736, "Total Allocated": 263355392, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373400880, "dur": 303,
    "args": {
       "External id": 1605,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373401188,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391858962432, "Bytes": -3538944, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373401319, "dur": 2,
    "args": {
       "External id": 1613,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373401278, "dur": 46,
    "args": {
       "External id": 1612,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 2762, "tid": 2762,
    "ts": 1638252373401404, "dur": 4,
    "args": {
       "External id": 1615,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2762, "tid": 2762,
    "ts": 1638252373401365, "dur": 45,
    "args": {
       "External id": 1614,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373401490, "dur": 1,
    "args": {
       "External id": 1617,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 2762, "tid": 2762,
    "ts": 1638252373401450, "dur": 44,
    "args": {
       "External id": 1616,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373401667,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391866040320, "Bytes": 18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373401662, "dur": 12,
    "args": {
       "External id": 1621,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373401623, "dur": 53,
    "args": {
       "External id": 1620,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373401717, "dur": 30,
    "args": {
       "External id": 1622,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2762, "tid": 2762,
    "ts": 1638252373401576, "dur": 174,
    "args": {
       "External id": 1619,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373401831, "dur": 1,
    "args": {
       "External id": 1624,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373401792, "dur": 43,
    "args": {
       "External id": 1623,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 2762, "tid": 2762,
    "ts": 1638252373401538, "dur": 299,
    "args": {
       "External id": 1618,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373401923,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373401919, "dur": 10,
    "args": {
       "External id": 1626,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 2762, "tid": 2762,
    "ts": 1638252373401877, "dur": 78,
    "args": {
       "External id": 1625,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], [24576, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373402037, "dur": 2,
    "args": {
       "External id": 1628,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373401998, "dur": 43,
    "args": {
       "External id": 1627,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373402044,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391866040320, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373401237, "dur": 812,
    "args": {
       "External id": 1611,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373402136, "dur": 2,
    "args": {
       "External id": 1630,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373402097, "dur": 44,
    "args": {
       "External id": 1629,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373402306,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391866040320, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373402302, "dur": 10,
    "args": {
       "External id": 1634,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373402264, "dur": 51,
    "args": {
       "External id": 1633,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 2762, "tid": 2762,
    "ts": 1638252373402355, "dur": 24,
    "args": {
       "External id": 1635,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 2762, "tid": 2762,
    "ts": 1638252373402225, "dur": 156,
    "args": {
       "External id": 1632,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::contiguous", "pid": 2762, "tid": 2762,
    "ts": 1638252373402188, "dur": 195,
    "args": {
       "External id": 1631,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373402429, "dur": 4,
    "args": {
       "External id": 1636,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373402437,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373402642, "dur": 2,
    "args": {
       "External id": 1640,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373402589, "dur": 57,
    "args": {
       "External id": 1639,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373402545, "dur": 104,
    "args": {
       "External id": 1638,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373402737, "dur": 2,
    "args": {
       "External id": 1642,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373402797,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": 18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373402790, "dur": 72,
    "args": {
       "External id": 1643,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373402956, "dur": 2,
    "args": {
       "External id": 1645,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373402913, "dur": 47,
    "args": {
       "External id": 1644,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373402694, "dur": 269,
    "args": {
       "External id": 1641,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373403008, "dur": 27,
    "args": {
       "External id": 1646,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373402501, "dur": 537,
    "args": {
       "External id": 1637,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373403247,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": 18874368, "Total Allocated": 316439552, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373403236, "dur": 18,
    "args": {
       "External id": 1650,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373403193, "dur": 63,
    "args": {
       "External id": 1649,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373403352,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391848345600, "Bytes": 4718592, "Total Allocated": 321158144, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373403344, "dur": 13,
    "args": {
       "External id": 1652,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373403302, "dur": 58,
    "args": {
       "External id": 1651,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373403146, "dur": 239,
    "args": {
       "External id": 1648,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373403391,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391848345600, "Bytes": -4718592, "Total Allocated": 316439552, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373403103, "dur": 292,
    "args": {
       "External id": 1647,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373403401,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": -18874368, "Total Allocated": 297565184, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373403406,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391866040320, "Bytes": -18874368, "Total Allocated": 278690816, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373403412,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": -18874368, "Total Allocated": 259816448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373403416,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": -18874368, "Total Allocated": 240942080, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373403421,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395432378368, "Bytes": -18874368, "Total Allocated": 222067712, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373403426,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391862501376, "Bytes": -3538944, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373403483,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 2762, "tid": 2762,
    "ts": 1638252373403476, "dur": 33,
    "args": {
       "External id": 1653,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373403515,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": -18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373403680,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": 18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373403676, "dur": 10,
    "args": {
       "External id": 1656,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373403733,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091840, "Bytes": 12288, "Total Allocated": 237415424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373403730, "dur": 12,
    "args": {
       "External id": 1657,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373403788,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533104128, "Bytes": 12288, "Total Allocated": 237427712, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373403785, "dur": 16,
    "args": {
       "External id": 1658,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373403876, "dur": 3,
    "args": {
       "External id": 1659,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373403920, "dur": 1,
    "args": {
       "External id": 1660,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373403631, "dur": 295,
    "args": {
       "External id": 1655,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373403930,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091840, "Bytes": -12288, "Total Allocated": 237415424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373403934,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533104128, "Bytes": -12288, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373403581, "dur": 356,
    "args": {
       "External id": 1654,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373404130, "dur": 1,
    "args": {
       "External id": 1664,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373404087, "dur": 47,
    "args": {
       "External id": 1663,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373404044, "dur": 93,
    "args": {
       "External id": 1662,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373404225, "dur": 3,
    "args": {
       "External id": 1666,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373404281,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140392213250048, "Bytes": 75497472, "Total Allocated": 312900608, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373404275, "dur": 47,
    "args": {
       "External id": 1667,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373404417, "dur": 2,
    "args": {
       "External id": 1669,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373404374, "dur": 47,
    "args": {
       "External id": 1668,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373404182, "dur": 242,
    "args": {
       "External id": 1665,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373404469, "dur": 27,
    "args": {
       "External id": 1670,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373404001, "dur": 497,
    "args": {
       "External id": 1661,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [6144, 1536], [6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373404562,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140396522897408, "Bytes": 75497472, "Total Allocated": 388398080, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::gelu", "pid": 2762, "tid": 2762,
    "ts": 1638252373404555, "dur": 33,
    "args": {
       "External id": 1671,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1556): gelu;/miniconda/lib/python3.8/site-packages/torch/nn/modules/activation.py(652): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373404593,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140392213250048, "Bytes": -75497472, "Total Allocated": 312900608, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373404786, "dur": 1,
    "args": {
       "External id": 1675,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373404743, "dur": 47,
    "args": {
       "External id": 1674,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373404700, "dur": 93,
    "args": {
       "External id": 1673,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373404880, "dur": 3,
    "args": {
       "External id": 1677,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373404936,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": 18874368, "Total Allocated": 331774976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373404930, "dur": 59,
    "args": {
       "External id": 1678,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373405085, "dur": 2,
    "args": {
       "External id": 1680,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373405043, "dur": 46,
    "args": {
       "External id": 1679,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373404837, "dur": 255,
    "args": {
       "External id": 1676,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 2762, "tid": 2762,
    "ts": 1638252373405137, "dur": 25,
    "args": {
       "External id": 1681,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373404657, "dur": 507,
    "args": {
       "External id": 1672,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [1536, 6144], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373405171,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140396522897408, "Bytes": -75497472, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373405379,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395432378368, "Bytes": 18874368, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373405369, "dur": 17,
    "args": {
       "External id": 1685,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373405326, "dur": 62,
    "args": {
       "External id": 1684,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373405482,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": 4718592, "Total Allocated": 279870464, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373405475, "dur": 13,
    "args": {
       "External id": 1687,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 2762, "tid": 2762,
    "ts": 1638252373405433, "dur": 57,
    "args": {
       "External id": 1686,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373405278, "dur": 238,
    "args": {
       "External id": 1683,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373405519,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391829471232, "Bytes": -4718592, "Total Allocated": 275151872, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 2762, "tid": 2762,
    "ts": 1638252373405235, "dur": 293,
    "args": {
       "External id": 1682,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(134): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373405533,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": -18874368, "Total Allocated": 256277504, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373405540,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140391810596864, "Bytes": -18874368, "Total Allocated": 237403136, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373405545,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395394629632, "Bytes": -18874368, "Total Allocated": 218528768, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373405549,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395354783744, "Bytes": -18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373405554,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395375755264, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373405701,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": 18874368, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373405697, "dur": 10,
    "args": {
       "External id": 1690,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373405748,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091840, "Bytes": 12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373405744, "dur": 9,
    "args": {
       "External id": 1691,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373405792,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533104128, "Bytes": 12288, "Total Allocated": 199678976, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 2762, "tid": 2762,
    "ts": 1638252373405789, "dur": 8,
    "args": {
       "External id": 1692,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373405865, "dur": 3,
    "args": {
       "External id": 1693,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373405903, "dur": 1,
    "args": {
       "External id": 1694,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373405658, "dur": 253,
    "args": {
       "External id": 1689,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373405914,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091840, "Bytes": -12288, "Total Allocated": 199666688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373405919,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533104128, "Bytes": -12288, "Total Allocated": 199654400, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 2762, "tid": 2762,
    "ts": 1638252373405623, "dur": 299,
    "args": {
       "External id": 1688,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(135): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373405927,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395432378368, "Bytes": -18874368, "Total Allocated": 180780032, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 2762, "tid": 2762,
    "ts": 1638252373406079, "dur": 1,
    "args": {
       "External id": 1698,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 2762, "tid": 2762,
    "ts": 1638252373406045, "dur": 37,
    "args": {
       "External id": 1697,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 2762, "tid": 2762,
    "ts": 1638252373406010, "dur": 76,
    "args": {
       "External id": 1696,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373406154, "dur": 3,
    "args": {
       "External id": 1700,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373406201,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533152768, "Bytes": 122880, "Total Allocated": 180902912, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 2762, "tid": 2762,
    "ts": 1638252373406195, "dur": 43,
    "args": {
       "External id": 1701,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 10]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373406312, "dur": 2,
    "args": {
       "External id": 1703,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 2762, "tid": 2762,
    "ts": 1638252373406278, "dur": 38,
    "args": {
       "External id": 1702,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 2762, "tid": 2762,
    "ts": 1638252373406120, "dur": 198,
    "args": {
       "External id": 1699,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 10]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 2762, "tid": 2762,
    "ts": 1638252373405977, "dur": 346,
    "args": {
       "External id": 1695,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [10, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(136): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373406328,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395413504000, "Bytes": -18874368, "Total Allocated": 162028544, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373406367, "dur": 3,
    "args": {
       "External id": 1704,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 10], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 2762, "tid": 2762,
    "ts": 1638252373406403, "dur": 2,
    "args": {
       "External id": 1705,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 2762, "tid": 2762,
    "ts": 1638252373406510, "dur": 0,
    "args": {
       "External id": 1708,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373406548,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533398528, "Bytes": 122880, "Total Allocated": 162151424, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_log_softmax", "pid": 2762, "tid": 2762,
    "ts": 1638252373406543, "dur": 33,
    "args": {
       "External id": 1709,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::log_softmax", "pid": 2762, "tid": 2762,
    "ts": 1638252373406478, "dur": 100,
    "args": {
       "External id": 1707,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373406690,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533090816, "Bytes": 512, "Total Allocated": 162151936, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373406696,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091840, "Bytes": 512, "Total Allocated": 162152448, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2762, "tid": 2762,
    "ts": 1638252373406733, "dur": 1,
    "args": {
       "External id": 1713,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 2762, "tid": 2762,
    "ts": 1638252373406765, "dur": 1,
    "args": {
       "External id": 1714,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss_forward", "pid": 2762, "tid": 2762,
    "ts": 1638252373406684, "dur": 103,
    "args": {
       "External id": 1712,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373406790,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091840, "Bytes": -512, "Total Allocated": 162151936, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss", "pid": 2762, "tid": 2762,
    "ts": 1638252373406653, "dur": 141,
    "args": {
       "External id": 1711,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss_nd", "pid": 2762, "tid": 2762,
    "ts": 1638252373406621, "dur": 177,
    "args": {
       "External id": 1710,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373406801,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533398528, "Bytes": -122880, "Total Allocated": 162029056, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::cross_entropy_loss", "pid": 2762, "tid": 2762,
    "ts": 1638252373406446, "dur": 360,
    "args": {
       "External id": 1706,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(137): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373406812,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395333812224, "Bytes": -18874368, "Total Allocated": 143154688, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "CheckpointFunction", "pid": 2762, "tid": 2762,
    "ts": 1638252373393498, "dur": 13414,
    "args": {
       "External id": 1487,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Fwd thread id": 0, "Sequence number": 275
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 2762, "tid": 2762,
    "ts": 1638252373406965, "dur": 1,
    "args": {
       "External id": 1715,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28374528], [7093632]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1822): _use_fp32_param_shard;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1153): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373407026,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533275648, "Bytes": -122880, "Total Allocated": 143031808, "Total Reserved": 530579456
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373407059,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005766581376, "Bytes": -5056, "Total Allocated": 6688, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373407064,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94005765044800, "Bytes": -816, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 2762, "tid": 2762,
    "ts": 1638252373407074,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140395533091328, "Bytes": -512, "Total Allocated": 143031296, "Total Reserved": 530579456
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "ProfilerStep#10", "pid": 2762, "tid": 2762,
    "ts": 1638252373388997, "dur": 26782,
    "args": {
       "External id": 1376,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(330): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(182): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;"
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 2762, "tid": -1254713600,
    "ts": 1638252373279195, "dur": 5,
    "args": {
      "cbid": 151, "correlation": 2426,
      "external id": 0, "external ts": 1638252373407074
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": -1254713600,
    "ts": 1638252373279206, "dur": 13,
    "args": {
      "cbid": 138, "correlation": 2429,
      "external id": 0, "external ts": 1638252373407074
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2762, "tid": -1254713600,
    "ts": 1638252373279219, "dur": 4,
    "args": {
      "cbid": 136, "correlation": 2430,
      "external id": 0, "external ts": 1638252373407074
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": -1254713600,
    "ts": 1638252373279226, "dur": 1,
    "args": {
      "cbid": 138, "correlation": 2431,
      "external id": 0, "external ts": 1638252373407074
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2762, "tid": -1254713600,
    "ts": 1638252373279227, "dur": 1,
    "args": {
      "cbid": 136, "correlation": 2432,
      "external id": 0, "external ts": 1638252373407074
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 2762, "tid": -1254713600,
    "ts": 1638252373279442, "dur": 1,
    "args": {
      "cbid": 151, "correlation": 2436,
      "external id": 0, "external ts": 1638252373407074
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy HtoD (Pinned -> Device)", "pid": 0, "tid": 7,
    "ts": 1638252373279836, "dur": 2,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 2457, "external id": 14,
      "bytes": 24576, "memory bandwidth (GB/s)": 10.24
    }
  },
  {
    "ph": "f", "id": 2457, "pid": 0, "tid": 7, "ts": 1638252373279836,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373279810, "dur": 22,
    "args": {
      "cbid": 41, "correlation": 2457,
      "external id": 14, "external ts": 1638252373279801
    }
  },
  {
    "ph": "s", "id": 2457, "pid": 2762, "tid": 2762, "ts": 1638252373279810,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamSynchronize", "pid": 2762, "tid": 2762,
    "ts": 1638252373279833, "dur": 9,
    "args": {
      "cbid": 131, "correlation": 2458,
      "external id": 14, "external ts": 1638252373279801
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy HtoD (Pinned -> Device)", "pid": 0, "tid": 7,
    "ts": 1638252373279975, "dur": 2,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 2470, "external id": 18,
      "bytes": 24576, "memory bandwidth (GB/s)": 10.105263157894736
    }
  },
  {
    "ph": "f", "id": 2470, "pid": 0, "tid": 7, "ts": 1638252373279975,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373279954, "dur": 16,
    "args": {
      "cbid": 41, "correlation": 2470,
      "external id": 18, "external ts": 1638252373279949
    }
  },
  {
    "ph": "s", "id": 2470, "pid": 2762, "tid": 2762, "ts": 1638252373279954,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamSynchronize", "pid": 2762, "tid": 2762,
    "ts": 1638252373279971, "dur": 8,
    "args": {
      "cbid": 131, "correlation": 2471,
      "external id": 18, "external ts": 1638252373279949
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 2762, "tid": 2762,
    "ts": 1638252373280271, "dur": 5,
    "args": {
      "cbid": 165, "correlation": 2475,
      "external id": 4, "external ts": 1638252373278838
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373280569, "dur": 2,
    "args": {
      "cbid": 134, "correlation": 2481,
      "external id": 4, "external ts": 1638252373278838
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373280574, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 2484,
      "external id": 4, "external ts": 1638252373278838
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamWaitEvent", "pid": 2762, "tid": 2762,
    "ts": 1638252373280580, "dur": 1,
    "args": {
      "cbid": 147, "correlation": 2487,
      "external id": 4, "external ts": 1638252373278838
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2762, "tid": 2762,
    "ts": 1638252373280585, "dur": 1,
    "args": {
      "cbid": 136, "correlation": 2490,
      "external id": 4, "external ts": 1638252373278838
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoH (Device -> Pinned)", "pid": 0, "tid": 7,
    "ts": 1638252373284294, "dur": 3,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 2499, "external id": 119,
      "bytes": 24576, "memory bandwidth (GB/s)": 7.68
    }
  },
  {
    "ph": "f", "id": 2499, "pid": 0, "tid": 7, "ts": 1638252373284294,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373284275, "dur": 17,
    "args": {
      "cbid": 41, "correlation": 2499,
      "external id": 119, "external ts": 1638252373284266
    }
  },
  {
    "ph": "s", "id": 2499, "pid": 2762, "tid": 2762, "ts": 1638252373284275,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoH (Device -> Pinned)", "pid": 0, "tid": 7,
    "ts": 1638252373284498, "dur": 3,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 2505, "external id": 123,
      "bytes": 24576, "memory bandwidth (GB/s)": 7.603960396039604
    }
  },
  {
    "ph": "f", "id": 2505, "pid": 0, "tid": 7, "ts": 1638252373284498,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373284485, "dur": 11,
    "args": {
      "cbid": 41, "correlation": 2505,
      "external id": 123, "external ts": 1638252373284479
    }
  },
  {
    "ph": "s", "id": 2505, "pid": 2762, "tid": 2762, "ts": 1638252373284485,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::indexSelectLargeIndex<float, long, unsigned int, 2, 2, -2, true>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<long, unsigned int>, int, int, unsigned int, unsigned int, long)", "pid": 0, "tid": 7,
    "ts": 1638252373284858, "dur": 75,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2518, "external id": 127,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 8.0,
      "warps per SM": 32.0,
      "grid": [544, 1, 1],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2518, "pid": 0, "tid": 7, "ts": 1638252373284858,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373284834, "dur": 23,
    "args": {
      "cbid": 211, "correlation": 2518,
      "external id": 127, "external ts": 1638252373284718
    }
  },
  {
    "ph": "s", "id": 2518, "pid": 2762, "tid": 2762, "ts": 1638252373284834,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373285159, "dur": 73,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2526, "external id": 135,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2526, "pid": 0, "tid": 7, "ts": 1638252373285159,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373285141, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 2526,
      "external id": 135, "external ts": 1638252373285119
    }
  },
  {
    "ph": "s", "id": 2526, "pid": 2762, "tid": 2762, "ts": 1638252373285141,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 0, "tid": 7,
    "ts": 1638252373285485, "dur": 88,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2548, "external id": 137,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2548, "pid": 0, "tid": 7, "ts": 1638252373285485,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373285469, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 2548,
      "external id": 137, "external ts": 1638252373285270
    }
  },
  {
    "ph": "s", "id": 2548, "pid": 2762, "tid": 2762, "ts": 1638252373285469,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373285831, "dur": 134,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2562, "external id": 143,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2562, "pid": 0, "tid": 7, "ts": 1638252373285831,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373285815, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 2562,
      "external id": 143, "external ts": 1638252373285644
    }
  },
  {
    "ph": "s", "id": 2562, "pid": 2762, "tid": 2762, "ts": 1638252373285815,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373285968, "dur": 69,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2564, "external id": 143,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2564, "pid": 0, "tid": 7, "ts": 1638252373285968,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373285832, "dur": 10,
    "args": {
      "cbid": 211, "correlation": 2564,
      "external id": 143, "external ts": 1638252373285644
    }
  },
  {
    "ph": "s", "id": 2564, "pid": 2762, "tid": 2762, "ts": 1638252373285832,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373286354, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 2571,
      "external id": 155, "external ts": 1638252373286331
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373286359, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 2572,
      "external id": 155, "external ts": 1638252373286331
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638252373286380, "dur": 1,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 2573, "external id": 155,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.1612903225806452
    }
  },
  {
    "ph": "f", "id": 2573, "pid": 0, "tid": 7, "ts": 1638252373286380,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373286366, "dur": 11,
    "args": {
      "cbid": 51, "correlation": 2573,
      "external id": 155, "external ts": 1638252373286331
    }
  },
  {
    "ph": "s", "id": 2573, "pid": 2762, "tid": 2762, "ts": 1638252373286366,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373286377, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 2574,
      "external id": 155, "external ts": 1638252373286331
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 0, "tid": 7,
    "ts": 1638252373286399, "dur": 1391,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2575, "external id": 155,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 2575, "pid": 0, "tid": 7, "ts": 1638252373286399,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373286384, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 2575,
      "external id": 155, "external ts": 1638252373286331
    }
  },
  {
    "ph": "s", "id": 2575, "pid": 2762, "tid": 2762, "ts": 1638252373286384,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373286401, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 2577,
      "external id": 155, "external ts": 1638252373286331
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373287793, "dur": 75,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2581, "external id": 158,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2581, "pid": 0, "tid": 7, "ts": 1638252373287793,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373286579, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 2581,
      "external id": 158, "external ts": 1638252373286567
    }
  },
  {
    "ph": "s", "id": 2581, "pid": 2762, "tid": 2762, "ts": 1638252373286579,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373287129, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 2588,
      "external id": 168, "external ts": 1638252373287107
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373287133, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 2589,
      "external id": 168, "external ts": 1638252373287107
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638252373287871, "dur": 1,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 2590, "external id": 168,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.7560975609756098
    }
  },
  {
    "ph": "f", "id": 2590, "pid": 0, "tid": 7, "ts": 1638252373287871,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373287138, "dur": 9,
    "args": {
      "cbid": 51, "correlation": 2590,
      "external id": 168, "external ts": 1638252373287107
    }
  },
  {
    "ph": "s", "id": 2590, "pid": 2762, "tid": 2762, "ts": 1638252373287138,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373287148, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 2591,
      "external id": 168, "external ts": 1638252373287107
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 0, "tid": 7,
    "ts": 1638252373287873, "dur": 1385,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2592, "external id": 168,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 2592, "pid": 0, "tid": 7, "ts": 1638252373287873,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373287154, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 2592,
      "external id": 168, "external ts": 1638252373287107
    }
  },
  {
    "ph": "s", "id": 2592, "pid": 2762, "tid": 2762, "ts": 1638252373287154,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373287171, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 2594,
      "external id": 168, "external ts": 1638252373287107
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373289261, "dur": 74,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2598, "external id": 171,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2598, "pid": 0, "tid": 7, "ts": 1638252373289261,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373287336, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 2598,
      "external id": 171, "external ts": 1638252373287326
    }
  },
  {
    "ph": "s", "id": 2598, "pid": 2762, "tid": 2762, "ts": 1638252373287336,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373287867, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 2605,
      "external id": 181, "external ts": 1638252373287847
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373287871, "dur": 2,
    "args": {
      "cbid": 138, "correlation": 2606,
      "external id": 181, "external ts": 1638252373287847
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638252373289337, "dur": 1,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 2607, "external id": 181,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.309090909090909
    }
  },
  {
    "ph": "f", "id": 2607, "pid": 0, "tid": 7, "ts": 1638252373289337,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373287876, "dur": 8,
    "args": {
      "cbid": 51, "correlation": 2607,
      "external id": 181, "external ts": 1638252373287847
    }
  },
  {
    "ph": "s", "id": 2607, "pid": 2762, "tid": 2762, "ts": 1638252373287876,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373287885, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 2608,
      "external id": 181, "external ts": 1638252373287847
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 0, "tid": 7,
    "ts": 1638252373289340, "dur": 1385,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2609, "external id": 181,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 2609, "pid": 0, "tid": 7, "ts": 1638252373289340,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373287891, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 2609,
      "external id": 181, "external ts": 1638252373287847
    }
  },
  {
    "ph": "s", "id": 2609, "pid": 2762, "tid": 2762, "ts": 1638252373287891,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373287906, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 2611,
      "external id": 181, "external ts": 1638252373287847
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373290728, "dur": 75,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2615, "external id": 184,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2615, "pid": 0, "tid": 7, "ts": 1638252373290728,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373288069, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 2615,
      "external id": 184, "external ts": 1638252373288060
    }
  },
  {
    "ph": "s", "id": 2615, "pid": 2762, "tid": 2762, "ts": 1638252373288069,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373290804, "dur": 75,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2623, "external id": 197,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2623, "pid": 0, "tid": 7, "ts": 1638252373290804,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373288705, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 2623,
      "external id": 197, "external ts": 1638252373288695
    }
  },
  {
    "ph": "s", "id": 2623, "pid": 2762, "tid": 2762, "ts": 1638252373288705,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373290881, "dur": 71,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2632, "external id": 206,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2632, "pid": 0, "tid": 7, "ts": 1638252373290881,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373289131, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 2632,
      "external id": 206, "external ts": 1638252373289124
    }
  },
  {
    "ph": "s", "id": 2632, "pid": 2762, "tid": 2762, "ts": 1638252373289131,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 0, "tid": 7,
    "ts": 1638252373290955, "dur": 282,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2642, "external id": 209,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2642, "pid": 0, "tid": 7, "ts": 1638252373290955,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373289347, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 2642,
      "external id": 209, "external ts": 1638252373289284
    }
  },
  {
    "ph": "s", "id": 2642, "pid": 2762, "tid": 2762, "ts": 1638252373289347,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 0, "tid": 7,
    "ts": 1638252373291241, "dur": 9,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2648, "external id": 213,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2648, "pid": 0, "tid": 7, "ts": 1638252373291241,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373289549, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 2648,
      "external id": 213, "external ts": 1638252373289530
    }
  },
  {
    "ph": "s", "id": 2648, "pid": 2762, "tid": 2762, "ts": 1638252373289549,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 0, "tid": 7,
    "ts": 1638252373291252, "dur": 1,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2656, "external id": 218,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.029411765,
      "grid": [1, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 2656, "pid": 0, "tid": 7, "ts": 1638252373291252,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373289860, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 2656,
      "external id": 218, "external ts": 1638252373289832
    }
  },
  {
    "ph": "s", "id": 2656, "pid": 2762, "tid": 2762, "ts": 1638252373289860,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoD (Device -> Device)", "pid": 0, "tid": 7,
    "ts": 1638252373291256, "dur": 9,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 2663, "external id": 227,
      "bytes": 3538944, "memory bandwidth (GB/s)": 354.46153846153845
    }
  },
  {
    "ph": "f", "id": 2663, "pid": 0, "tid": 7, "ts": 1638252373291256,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373290367, "dur": 24,
    "args": {
      "cbid": 41, "correlation": 2663,
      "external id": 227, "external ts": 1638252373290362
    }
  },
  {
    "ph": "s", "id": 2663, "pid": 2762, "tid": 2762, "ts": 1638252373290367,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast>(int, at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373291268, "dur": 12,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2668, "external id": 228,
      "registers per thread": 24,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2668, "pid": 0, "tid": 7, "ts": 1638252373291268,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373290539, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 2668,
      "external id": 228, "external ts": 1638252373290446
    }
  },
  {
    "ph": "s", "id": 2668, "pid": 2762, "tid": 2762, "ts": 1638252373290539,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 3, false>(float*, float const*, int, int, int)", "pid": 0, "tid": 7,
    "ts": 1638252373291283, "dur": 20,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2675, "external id": 232,
      "registers per thread": 19,
      "shared memory": 0,
      "blocks per SM": 67.76471,
      "warps per SM": 271.05884,
      "grid": [4608, 1, 1],
      "block": [8, 16, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2675, "pid": 0, "tid": 7, "ts": 1638252373291283,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373290693, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 2675,
      "external id": 232, "external ts": 1638252373290677
    }
  },
  {
    "ph": "s", "id": 2675, "pid": 2762, "tid": 2762, "ts": 1638252373290693,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 0, "tid": 7,
    "ts": 1638252373291305, "dur": 14,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2697, "external id": 234,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2697, "pid": 0, "tid": 7, "ts": 1638252373291305,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373291069, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 2697,
      "external id": 234, "external ts": 1638252373290832
    }
  },
  {
    "ph": "s", "id": 2697, "pid": 2762, "tid": 2762, "ts": 1638252373291069,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373291674, "dur": 75,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2705, "external id": 250,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2705, "pid": 0, "tid": 7, "ts": 1638252373291674,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373291658, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 2705,
      "external id": 250, "external ts": 1638252373291648
    }
  },
  {
    "ph": "s", "id": 2705, "pid": 2762, "tid": 2762, "ts": 1638252373291658,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 0, "tid": 7,
    "ts": 1638252373291887, "dur": 272,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2715, "external id": 253,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2715, "pid": 0, "tid": 7, "ts": 1638252373291887,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373291874, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 2715,
      "external id": 253, "external ts": 1638252373291810
    }
  },
  {
    "ph": "s", "id": 2715, "pid": 2762, "tid": 2762, "ts": 1638252373291874,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373292329, "dur": 72,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2724, "external id": 263,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2724, "pid": 0, "tid": 7, "ts": 1638252373292329,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373292315, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 2724,
      "external id": 263, "external ts": 1638252373292307
    }
  },
  {
    "ph": "s", "id": 2724, "pid": 2762, "tid": 2762, "ts": 1638252373292315,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373292781, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 2733,
      "external id": 271, "external ts": 1638252373292757
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373292786, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 2734,
      "external id": 271, "external ts": 1638252373292757
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638252373292806, "dur": 1,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 2735, "external id": 271,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.8461538461538463
    }
  },
  {
    "ph": "f", "id": 2735, "pid": 0, "tid": 7, "ts": 1638252373292806,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373292792, "dur": 10,
    "args": {
      "cbid": 51, "correlation": 2735,
      "external id": 271, "external ts": 1638252373292757
    }
  },
  {
    "ph": "s", "id": 2735, "pid": 2762, "tid": 2762, "ts": 1638252373292792,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373292803, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 2736,
      "external id": 271, "external ts": 1638252373292757
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 0, "tid": 7,
    "ts": 1638252373292824, "dur": 1390,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2737, "external id": 271,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 2737, "pid": 0, "tid": 7, "ts": 1638252373292824,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373292809, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 2737,
      "external id": 271, "external ts": 1638252373292757
    }
  },
  {
    "ph": "s", "id": 2737, "pid": 2762, "tid": 2762, "ts": 1638252373292809,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373292826, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 2739,
      "external id": 271, "external ts": 1638252373292757
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373294217, "dur": 73,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2743, "external id": 274,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2743, "pid": 0, "tid": 7, "ts": 1638252373294217,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373292994, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 2743,
      "external id": 274, "external ts": 1638252373292982
    }
  },
  {
    "ph": "s", "id": 2743, "pid": 2762, "tid": 2762, "ts": 1638252373292994,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 0, "tid": 7,
    "ts": 1638252373294293, "dur": 89,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2765, "external id": 276,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2765, "pid": 0, "tid": 7, "ts": 1638252373294293,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373293361, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 2765,
      "external id": 276, "external ts": 1638252373293125
    }
  },
  {
    "ph": "s", "id": 2765, "pid": 2762, "tid": 2762, "ts": 1638252373293361,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3> >(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>)", "pid": 0, "tid": 7,
    "ts": 1638252373294384, "dur": 103,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2771, "external id": 281,
      "registers per thread": 20,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2771, "pid": 0, "tid": 7, "ts": 1638252373294384,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373293485, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 2771,
      "external id": 281, "external ts": 1638252373293468
    }
  },
  {
    "ph": "s", "id": 2771, "pid": 2762, "tid": 2762, "ts": 1638252373293485,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373294490, "dur": 124,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2785, "external id": 283,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2785, "pid": 0, "tid": 7, "ts": 1638252373294490,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373293928, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 2785,
      "external id": 283, "external ts": 1638252373293707
    }
  },
  {
    "ph": "s", "id": 2785, "pid": 2762, "tid": 2762, "ts": 1638252373293928,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373294617, "dur": 69,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2787, "external id": 283,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2787, "pid": 0, "tid": 7, "ts": 1638252373294617,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373293945, "dur": 9,
    "args": {
      "cbid": 211, "correlation": 2787,
      "external id": 283, "external ts": 1638252373293707
    }
  },
  {
    "ph": "s", "id": 2787, "pid": 2762, "tid": 2762, "ts": 1638252373293945,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 2762, "tid": -1254713600,
    "ts": 1638252373294618, "dur": 5,
    "args": {
      "cbid": 151, "correlation": 2795,
      "external id": 0, "external ts": 1638252373407074
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373294636, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 2800,
      "external id": 295, "external ts": 1638252373294611
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373294640, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 2801,
      "external id": 295, "external ts": 1638252373294611
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 2762, "tid": -1254713600,
    "ts": 1638252373294658, "dur": 1,
    "args": {
      "cbid": 151, "correlation": 2806,
      "external id": 0, "external ts": 1638252373407074
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 0, "tid": 7,
    "ts": 1638252373294688, "dur": 5142,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2802, "external id": 295,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [48, 24, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 2802, "pid": 0, "tid": 7, "ts": 1638252373294688,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373294646, "dur": 18,
    "args": {
      "cbid": 211, "correlation": 2802,
      "external id": 295, "external ts": 1638252373294611
    }
  },
  {
    "ph": "s", "id": 2802, "pid": 2762, "tid": 2762, "ts": 1638252373294646,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373299834, "dur": 281,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2813, "external id": 298,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2813, "pid": 0, "tid": 7, "ts": 1638252373299834,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373294924, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 2813,
      "external id": 298, "external ts": 1638252373294912
    }
  },
  {
    "ph": "s", "id": 2813, "pid": 2762, "tid": 2762, "ts": 1638252373294924,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2> >(int, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>)", "pid": 0, "tid": 7,
    "ts": 1638252373300118, "dur": 280,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2819, "external id": 299,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2819, "pid": 0, "tid": 7, "ts": 1638252373300118,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373295030, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 2819,
      "external id": 299, "external ts": 1638252373295012
    }
  },
  {
    "ph": "s", "id": 2819, "pid": 2762, "tid": 2762, "ts": 1638252373295030,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373295430, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 2826,
      "external id": 306, "external ts": 1638252373295410
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373295434, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 2827,
      "external id": 306, "external ts": 1638252373295410
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638252373300402, "dur": 0,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 2828, "external id": 306,
      "bytes": 1152, "memory bandwidth (GB/s)": 1.7142857142857142
    }
  },
  {
    "ph": "f", "id": 2828, "pid": 0, "tid": 7, "ts": 1638252373300402,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373295440, "dur": 10,
    "args": {
      "cbid": 51, "correlation": 2828,
      "external id": 306, "external ts": 1638252373295410
    }
  },
  {
    "ph": "s", "id": 2828, "pid": 2762, "tid": 2762, "ts": 1638252373295440,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 0, "tid": 7,
    "ts": 1638252373300404, "dur": 5175,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2829, "external id": 306,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [12, 24, 4],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 2829, "pid": 0, "tid": 7, "ts": 1638252373300404,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373295452, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 2829,
      "external id": 306, "external ts": 1638252373295410
    }
  },
  {
    "ph": "s", "id": 2829, "pid": 2762, "tid": 2762, "ts": 1638252373295452,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373295468, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 2831,
      "external id": 306, "external ts": 1638252373295410
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373305582, "dur": 73,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2835, "external id": 309,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2835, "pid": 0, "tid": 7, "ts": 1638252373305582,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373295647, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 2835,
      "external id": 309, "external ts": 1638252373295637
    }
  },
  {
    "ph": "s", "id": 2835, "pid": 2762, "tid": 2762, "ts": 1638252373295647,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 0, "tid": 7,
    "ts": 1638252373305658, "dur": 85,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2857, "external id": 311,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2857, "pid": 0, "tid": 7, "ts": 1638252373305658,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373296023, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 2857,
      "external id": 311, "external ts": 1638252373295790
    }
  },
  {
    "ph": "s", "id": 2857, "pid": 2762, "tid": 2762, "ts": 1638252373296023,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373305745, "dur": 133,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2871, "external id": 317,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2871, "pid": 0, "tid": 7, "ts": 1638252373305745,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373296326, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 2871,
      "external id": 317, "external ts": 1638252373296177
    }
  },
  {
    "ph": "s", "id": 2871, "pid": 2762, "tid": 2762, "ts": 1638252373296326,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373305881, "dur": 68,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2873, "external id": 317,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2873, "pid": 0, "tid": 7, "ts": 1638252373305881,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373296341, "dur": 9,
    "args": {
      "cbid": 211, "correlation": 2873,
      "external id": 317, "external ts": 1638252373296177
    }
  },
  {
    "ph": "s", "id": 2873, "pid": 2762, "tid": 2762, "ts": 1638252373296341,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373296764, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 2880,
      "external id": 329, "external ts": 1638252373296743
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_32x32_sliced1x4_tn", "pid": 0, "tid": 7,
    "ts": 1638252373305952, "dur": 79,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2881, "external id": 329,
      "registers per thread": 86,
      "shared memory": 32768,
      "blocks per SM": 1.4117647,
      "warps per SM": 5.647059,
      "grid": [1, 96, 1],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 18
    }
  },
  {
    "ph": "f", "id": 2881, "pid": 0, "tid": 7, "ts": 1638252373305952,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373296769, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 2881,
      "external id": 329, "external ts": 1638252373296743
    }
  },
  {
    "ph": "s", "id": 2881, "pid": 2762, "tid": 2762, "ts": 1638252373296769,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 4, true>(float*, float const*, int, int, int)", "pid": 0, "tid": 7,
    "ts": 1638252373306034, "dur": 2,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2888, "external id": 337,
      "registers per thread": 18,
      "shared memory": 0,
      "blocks per SM": 2.8235295,
      "warps per SM": 11.294118,
      "grid": [192, 1, 1],
      "block": [16, 8, 1],
      "est. achieved occupancy %": 35
    }
  },
  {
    "ph": "f", "id": 2888, "pid": 0, "tid": 7, "ts": 1638252373306034,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373297138, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 2888,
      "external id": 337, "external ts": 1638252373297122
    }
  },
  {
    "ph": "s", "id": 2888, "pid": 2762, "tid": 2762, "ts": 1638252373297138,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::nll_loss_forward_reduce_cuda_kernel_2d<float, float, long>(float*, float*, float*, long*, float*, bool, int, int, int, long)", "pid": 0, "tid": 7,
    "ts": 1638252373306039, "dur": 58,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2895, "external id": 340,
      "registers per thread": 38,
      "shared memory": 256,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.014705882,
      "grid": [1, 1, 1],
      "block": [32, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 2895, "pid": 0, "tid": 7, "ts": 1638252373306039,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373297363, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 2895,
      "external id": 340, "external ts": 1638252373297270
    }
  },
  {
    "ph": "s", "id": 2895, "pid": 2762, "tid": 2762, "ts": 1638252373297363,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373297655, "dur": 2,
    "args": {
      "cbid": 134, "correlation": 2900,
      "external id": 4, "external ts": 1638252373278838
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373297658, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 2901,
      "external id": 4, "external ts": 1638252373278838
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373297663, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 2903,
      "external id": 4, "external ts": 1638252373278838
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373297670, "dur": 0,
    "args": {
      "cbid": 134, "correlation": 2907,
      "external id": 4, "external ts": 1638252373278838
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373297672, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 2908,
      "external id": 4, "external ts": 1638252373278838
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 2762, "tid": 2762,
    "ts": 1638252373297746, "dur": 8354,
    "args": {
      "cbid": 165, "correlation": 2912,
      "external id": 4, "external ts": 1638252373278838
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy HtoD (Pinned -> Device)", "pid": 0, "tid": 7,
    "ts": 1638252373307540, "dur": 3,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 2923, "external id": 357,
      "bytes": 24576, "memory bandwidth (GB/s)": 7.384615384615385
    }
  },
  {
    "ph": "f", "id": 2923, "pid": 0, "tid": 7, "ts": 1638252373307540,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373307515, "dur": 22,
    "args": {
      "cbid": 41, "correlation": 2923,
      "external id": 357, "external ts": 1638252373307505
    }
  },
  {
    "ph": "s", "id": 2923, "pid": 2762, "tid": 2762, "ts": 1638252373307515,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamSynchronize", "pid": 2762, "tid": 2762,
    "ts": 1638252373307538, "dur": 9,
    "args": {
      "cbid": 131, "correlation": 2924,
      "external id": 357, "external ts": 1638252373307505
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy HtoD (Pinned -> Device)", "pid": 0, "tid": 7,
    "ts": 1638252373307687, "dur": 2,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 2936, "external id": 361,
      "bytes": 24576, "memory bandwidth (GB/s)": 11.130434782608695
    }
  },
  {
    "ph": "f", "id": 2936, "pid": 0, "tid": 7, "ts": 1638252373307687,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373307666, "dur": 16,
    "args": {
      "cbid": 41, "correlation": 2936,
      "external id": 361, "external ts": 1638252373307661
    }
  },
  {
    "ph": "s", "id": 2936, "pid": 2762, "tid": 2762, "ts": 1638252373307666,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamSynchronize", "pid": 2762, "tid": 2762,
    "ts": 1638252373307683, "dur": 8,
    "args": {
      "cbid": 131, "correlation": 2937,
      "external id": 361, "external ts": 1638252373307661
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 2762, "tid": 2762,
    "ts": 1638252373308138, "dur": 6,
    "args": {
      "cbid": 165, "correlation": 2941,
      "external id": 347, "external ts": 1638252373306544
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373308427, "dur": 2,
    "args": {
      "cbid": 134, "correlation": 2947,
      "external id": 347, "external ts": 1638252373306544
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373308431, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 2950,
      "external id": 347, "external ts": 1638252373306544
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamWaitEvent", "pid": 2762, "tid": 2762,
    "ts": 1638252373308438, "dur": 1,
    "args": {
      "cbid": 147, "correlation": 2953,
      "external id": 347, "external ts": 1638252373306544
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2762, "tid": 2762,
    "ts": 1638252373308443, "dur": 1,
    "args": {
      "cbid": 136, "correlation": 2956,
      "external id": 347, "external ts": 1638252373306544
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373312124, "dur": 5,
    "args": {
      "cbid": 138, "correlation": 2961,
      "external id": 461, "external ts": 1638252373312121
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2762, "tid": 2762,
    "ts": 1638252373312130, "dur": 2,
    "args": {
      "cbid": 136, "correlation": 2962,
      "external id": 461, "external ts": 1638252373312121
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373312134, "dur": 1,
    "args": {
      "cbid": 138, "correlation": 2963,
      "external id": 461, "external ts": 1638252373312121
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2762, "tid": 2762,
    "ts": 1638252373312136, "dur": 1,
    "args": {
      "cbid": 136, "correlation": 2964,
      "external id": 461, "external ts": 1638252373312121
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoH (Device -> Pinned)", "pid": 0, "tid": 7,
    "ts": 1638252373312202, "dur": 2,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 2969, "external id": 462,
      "bytes": 24576, "memory bandwidth (GB/s)": 8.43956043956044
    }
  },
  {
    "ph": "f", "id": 2969, "pid": 0, "tid": 7, "ts": 1638252373312202,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373312185, "dur": 15,
    "args": {
      "cbid": 41, "correlation": 2969,
      "external id": 462, "external ts": 1638252373312176
    }
  },
  {
    "ph": "s", "id": 2969, "pid": 2762, "tid": 2762, "ts": 1638252373312185,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoH (Device -> Pinned)", "pid": 0, "tid": 7,
    "ts": 1638252373312363, "dur": 2,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 2975, "external id": 466,
      "bytes": 24576, "memory bandwidth (GB/s)": 8.43956043956044
    }
  },
  {
    "ph": "f", "id": 2975, "pid": 0, "tid": 7, "ts": 1638252373312363,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373312350, "dur": 10,
    "args": {
      "cbid": 41, "correlation": 2975,
      "external id": 466, "external ts": 1638252373312345
    }
  },
  {
    "ph": "s", "id": 2975, "pid": 2762, "tid": 2762, "ts": 1638252373312350,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::indexSelectLargeIndex<float, long, unsigned int, 2, 2, -2, true>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<long, unsigned int>, int, int, unsigned int, unsigned int, long)", "pid": 0, "tid": 7,
    "ts": 1638252373312715, "dur": 74,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2988, "external id": 470,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 8.0,
      "warps per SM": 32.0,
      "grid": [544, 1, 1],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2988, "pid": 0, "tid": 7, "ts": 1638252373312715,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373312692, "dur": 24,
    "args": {
      "cbid": 211, "correlation": 2988,
      "external id": 470, "external ts": 1638252373312572
    }
  },
  {
    "ph": "s", "id": 2988, "pid": 2762, "tid": 2762, "ts": 1638252373312692,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373312996, "dur": 73,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 2996, "external id": 478,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 2996, "pid": 0, "tid": 7, "ts": 1638252373312996,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373312979, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 2996,
      "external id": 478, "external ts": 1638252373312958
    }
  },
  {
    "ph": "s", "id": 2996, "pid": 2762, "tid": 2762, "ts": 1638252373312979,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 0, "tid": 7,
    "ts": 1638252373313312, "dur": 86,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3018, "external id": 480,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3018, "pid": 0, "tid": 7, "ts": 1638252373313312,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373313296, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3018,
      "external id": 480, "external ts": 1638252373313092
    }
  },
  {
    "ph": "s", "id": 3018, "pid": 2762, "tid": 2762, "ts": 1638252373313296,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373313648, "dur": 133,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3032, "external id": 486,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3032, "pid": 0, "tid": 7, "ts": 1638252373313648,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373313632, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3032,
      "external id": 486, "external ts": 1638252373313453
    }
  },
  {
    "ph": "s", "id": 3032, "pid": 2762, "tid": 2762, "ts": 1638252373313632,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373313784, "dur": 68,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3034, "external id": 486,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3034, "pid": 0, "tid": 7, "ts": 1638252373313784,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373313648, "dur": 10,
    "args": {
      "cbid": 211, "correlation": 3034,
      "external id": 486, "external ts": 1638252373313453
    }
  },
  {
    "ph": "s", "id": 3034, "pid": 2762, "tid": 2762, "ts": 1638252373313648,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373314154, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 3041,
      "external id": 498, "external ts": 1638252373314130
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373314159, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 3042,
      "external id": 498, "external ts": 1638252373314130
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638252373314179, "dur": 1,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 3043, "external id": 498,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.411764705882353
    }
  },
  {
    "ph": "f", "id": 3043, "pid": 0, "tid": 7, "ts": 1638252373314179,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373314165, "dur": 10,
    "args": {
      "cbid": 51, "correlation": 3043,
      "external id": 498, "external ts": 1638252373314130
    }
  },
  {
    "ph": "s", "id": 3043, "pid": 2762, "tid": 2762, "ts": 1638252373314165,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373314177, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 3044,
      "external id": 498, "external ts": 1638252373314130
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 0, "tid": 7,
    "ts": 1638252373314198, "dur": 1395,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3045, "external id": 498,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 3045, "pid": 0, "tid": 7, "ts": 1638252373314198,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373314184, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3045,
      "external id": 498, "external ts": 1638252373314130
    }
  },
  {
    "ph": "s", "id": 3045, "pid": 2762, "tid": 2762, "ts": 1638252373314184,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373314200, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3047,
      "external id": 498, "external ts": 1638252373314130
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373315596, "dur": 74,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3051, "external id": 501,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3051, "pid": 0, "tid": 7, "ts": 1638252373315596,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373314368, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3051,
      "external id": 501, "external ts": 1638252373314356
    }
  },
  {
    "ph": "s", "id": 3051, "pid": 2762, "tid": 2762, "ts": 1638252373314368,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373314913, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 3058,
      "external id": 511, "external ts": 1638252373314892
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373314917, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 3059,
      "external id": 511, "external ts": 1638252373314892
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638252373315672, "dur": 2,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 3060, "external id": 511,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.1255495847581827
    }
  },
  {
    "ph": "f", "id": 3060, "pid": 0, "tid": 7, "ts": 1638252373315672,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373314922, "dur": 9,
    "args": {
      "cbid": 51, "correlation": 3060,
      "external id": 511, "external ts": 1638252373314892
    }
  },
  {
    "ph": "s", "id": 3060, "pid": 2762, "tid": 2762, "ts": 1638252373314922,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373314932, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 3061,
      "external id": 511, "external ts": 1638252373314892
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 0, "tid": 7,
    "ts": 1638252373315676, "dur": 1386,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3062, "external id": 511,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 3062, "pid": 0, "tid": 7, "ts": 1638252373315676,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373314938, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 3062,
      "external id": 511, "external ts": 1638252373314892
    }
  },
  {
    "ph": "s", "id": 3062, "pid": 2762, "tid": 2762, "ts": 1638252373314938,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373314953, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3064,
      "external id": 511, "external ts": 1638252373314892
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373317065, "dur": 74,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3068, "external id": 514,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3068, "pid": 0, "tid": 7, "ts": 1638252373317065,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373315120, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 3068,
      "external id": 514, "external ts": 1638252373315109
    }
  },
  {
    "ph": "s", "id": 3068, "pid": 2762, "tid": 2762, "ts": 1638252373315120,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373315653, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 3075,
      "external id": 524, "external ts": 1638252373315633
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373315658, "dur": 2,
    "args": {
      "cbid": 138, "correlation": 3076,
      "external id": 524, "external ts": 1638252373315633
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638252373317143, "dur": 1,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 3077, "external id": 524,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.5319148936170213
    }
  },
  {
    "ph": "f", "id": 3077, "pid": 0, "tid": 7, "ts": 1638252373317143,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373315662, "dur": 9,
    "args": {
      "cbid": 51, "correlation": 3077,
      "external id": 524, "external ts": 1638252373315633
    }
  },
  {
    "ph": "s", "id": 3077, "pid": 2762, "tid": 2762, "ts": 1638252373315662,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373315672, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 3078,
      "external id": 524, "external ts": 1638252373315633
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 0, "tid": 7,
    "ts": 1638252373317146, "dur": 1384,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3079, "external id": 524,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 3079, "pid": 0, "tid": 7, "ts": 1638252373317146,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373315677, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 3079,
      "external id": 524, "external ts": 1638252373315633
    }
  },
  {
    "ph": "s", "id": 3079, "pid": 2762, "tid": 2762, "ts": 1638252373315677,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373315693, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3081,
      "external id": 524, "external ts": 1638252373315633
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373318533, "dur": 74,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3085, "external id": 527,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3085, "pid": 0, "tid": 7, "ts": 1638252373318533,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373315859, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3085,
      "external id": 527, "external ts": 1638252373315849
    }
  },
  {
    "ph": "s", "id": 3085, "pid": 2762, "tid": 2762, "ts": 1638252373315859,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373318609, "dur": 75,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3093, "external id": 540,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3093, "pid": 0, "tid": 7, "ts": 1638252373318609,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373316471, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 3093,
      "external id": 540, "external ts": 1638252373316461
    }
  },
  {
    "ph": "s", "id": 3093, "pid": 2762, "tid": 2762, "ts": 1638252373316471,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373318686, "dur": 71,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3102, "external id": 549,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3102, "pid": 0, "tid": 7, "ts": 1638252373318686,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373316903, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3102,
      "external id": 549, "external ts": 1638252373316895
    }
  },
  {
    "ph": "s", "id": 3102, "pid": 2762, "tid": 2762, "ts": 1638252373316903,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 0, "tid": 7,
    "ts": 1638252373318760, "dur": 282,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3112, "external id": 552,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3112, "pid": 0, "tid": 7, "ts": 1638252373318760,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373317115, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 3112,
      "external id": 552, "external ts": 1638252373317052
    }
  },
  {
    "ph": "s", "id": 3112, "pid": 2762, "tid": 2762, "ts": 1638252373317115,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 0, "tid": 7,
    "ts": 1638252373319045, "dur": 10,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3118, "external id": 556,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3118, "pid": 0, "tid": 7, "ts": 1638252373319045,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373317321, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 3118,
      "external id": 556, "external ts": 1638252373317302
    }
  },
  {
    "ph": "s", "id": 3118, "pid": 2762, "tid": 2762, "ts": 1638252373317321,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 0, "tid": 7,
    "ts": 1638252373319057, "dur": 1,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3126, "external id": 561,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.029411765,
      "grid": [1, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 3126, "pid": 0, "tid": 7, "ts": 1638252373319057,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373317633, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3126,
      "external id": 561, "external ts": 1638252373317591
    }
  },
  {
    "ph": "s", "id": 3126, "pid": 2762, "tid": 2762, "ts": 1638252373317633,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoD (Device -> Device)", "pid": 0, "tid": 7,
    "ts": 1638252373319061, "dur": 9,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 3133, "external id": 570,
      "bytes": 3538944, "memory bandwidth (GB/s)": 392.17021276595744
    }
  },
  {
    "ph": "f", "id": 3133, "pid": 0, "tid": 7, "ts": 1638252373319061,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373318060, "dur": 23,
    "args": {
      "cbid": 41, "correlation": 3133,
      "external id": 570, "external ts": 1638252373318054
    }
  },
  {
    "ph": "s", "id": 3133, "pid": 2762, "tid": 2762, "ts": 1638252373318060,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast>(int, at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373319072, "dur": 13,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3138, "external id": 571,
      "registers per thread": 24,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3138, "pid": 0, "tid": 7, "ts": 1638252373319072,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373318234, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3138,
      "external id": 571, "external ts": 1638252373318138
    }
  },
  {
    "ph": "s", "id": 3138, "pid": 2762, "tid": 2762, "ts": 1638252373318234,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 3, false>(float*, float const*, int, int, int)", "pid": 0, "tid": 7,
    "ts": 1638252373319087, "dur": 20,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3145, "external id": 575,
      "registers per thread": 19,
      "shared memory": 0,
      "blocks per SM": 67.76471,
      "warps per SM": 271.05884,
      "grid": [4608, 1, 1],
      "block": [8, 16, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3145, "pid": 0, "tid": 7, "ts": 1638252373319087,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373318378, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3145,
      "external id": 575, "external ts": 1638252373318361
    }
  },
  {
    "ph": "s", "id": 3145, "pid": 2762, "tid": 2762, "ts": 1638252373318378,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 0, "tid": 7,
    "ts": 1638252373319109, "dur": 13,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3167, "external id": 577,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3167, "pid": 0, "tid": 7, "ts": 1638252373319109,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373318763, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3167,
      "external id": 577, "external ts": 1638252373318521
    }
  },
  {
    "ph": "s", "id": 3167, "pid": 2762, "tid": 2762, "ts": 1638252373318763,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373319356, "dur": 75,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3175, "external id": 593,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3175, "pid": 0, "tid": 7, "ts": 1638252373319356,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373319341, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3175,
      "external id": 593, "external ts": 1638252373319331
    }
  },
  {
    "ph": "s", "id": 3175, "pid": 2762, "tid": 2762, "ts": 1638252373319341,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 0, "tid": 7,
    "ts": 1638252373319574, "dur": 272,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3185, "external id": 596,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3185, "pid": 0, "tid": 7, "ts": 1638252373319574,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373319560, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 3185,
      "external id": 596, "external ts": 1638252373319497
    }
  },
  {
    "ph": "s", "id": 3185, "pid": 2762, "tid": 2762, "ts": 1638252373319560,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373320024, "dur": 72,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3194, "external id": 606,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3194, "pid": 0, "tid": 7, "ts": 1638252373320024,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373320009, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3194,
      "external id": 606, "external ts": 1638252373320000
    }
  },
  {
    "ph": "s", "id": 3194, "pid": 2762, "tid": 2762, "ts": 1638252373320009,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373320459, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 3203,
      "external id": 614, "external ts": 1638252373320438
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373320464, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 3204,
      "external id": 614, "external ts": 1638252373320438
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638252373320485, "dur": 1,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 3205, "external id": 614,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.565217391304348
    }
  },
  {
    "ph": "f", "id": 3205, "pid": 0, "tid": 7, "ts": 1638252373320485,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373320470, "dur": 11,
    "args": {
      "cbid": 51, "correlation": 3205,
      "external id": 614, "external ts": 1638252373320438
    }
  },
  {
    "ph": "s", "id": 3205, "pid": 2762, "tid": 2762, "ts": 1638252373320470,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373320482, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 3206,
      "external id": 614, "external ts": 1638252373320438
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 0, "tid": 7,
    "ts": 1638252373320503, "dur": 1390,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3207, "external id": 614,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 3207, "pid": 0, "tid": 7, "ts": 1638252373320503,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373320489, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 3207,
      "external id": 614, "external ts": 1638252373320438
    }
  },
  {
    "ph": "s", "id": 3207, "pid": 2762, "tid": 2762, "ts": 1638252373320489,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373320504, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3209,
      "external id": 614, "external ts": 1638252373320438
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373321896, "dur": 74,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3213, "external id": 617,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3213, "pid": 0, "tid": 7, "ts": 1638252373321896,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373320683, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3213,
      "external id": 617, "external ts": 1638252373320671
    }
  },
  {
    "ph": "s", "id": 3213, "pid": 2762, "tid": 2762, "ts": 1638252373320683,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 0, "tid": 7,
    "ts": 1638252373321972, "dur": 88,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3235, "external id": 619,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3235, "pid": 0, "tid": 7, "ts": 1638252373321972,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373321045, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3235,
      "external id": 619, "external ts": 1638252373320810
    }
  },
  {
    "ph": "s", "id": 3235, "pid": 2762, "tid": 2762, "ts": 1638252373321045,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3> >(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>)", "pid": 0, "tid": 7,
    "ts": 1638252373322062, "dur": 104,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3241, "external id": 624,
      "registers per thread": 20,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3241, "pid": 0, "tid": 7, "ts": 1638252373322062,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373321169, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3241,
      "external id": 624, "external ts": 1638252373321152
    }
  },
  {
    "ph": "s", "id": 3241, "pid": 2762, "tid": 2762, "ts": 1638252373321169,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373322168, "dur": 124,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3255, "external id": 626,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3255, "pid": 0, "tid": 7, "ts": 1638252373322168,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373321583, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3255,
      "external id": 626, "external ts": 1638252373321308
    }
  },
  {
    "ph": "s", "id": 3255, "pid": 2762, "tid": 2762, "ts": 1638252373321583,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373322295, "dur": 67,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3257, "external id": 626,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3257, "pid": 0, "tid": 7, "ts": 1638252373322295,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373321600, "dur": 17,
    "args": {
      "cbid": 211, "correlation": 3257,
      "external id": 626, "external ts": 1638252373321308
    }
  },
  {
    "ph": "s", "id": 3257, "pid": 2762, "tid": 2762, "ts": 1638252373321600,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373322372, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 3264,
      "external id": 638, "external ts": 1638252373322351
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373322376, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 3265,
      "external id": 638, "external ts": 1638252373322351
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 0, "tid": 7,
    "ts": 1638252373322399, "dur": 5157,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3266, "external id": 638,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [48, 24, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 3266, "pid": 0, "tid": 7, "ts": 1638252373322399,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373322381, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 3266,
      "external id": 638, "external ts": 1638252373322351
    }
  },
  {
    "ph": "s", "id": 3266, "pid": 2762, "tid": 2762, "ts": 1638252373322381,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 2762, "tid": -1254713600,
    "ts": 1638252373322500, "dur": 7,
    "args": {
      "cbid": 151, "correlation": 3272,
      "external id": 0, "external ts": 1638252373407074
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 2762, "tid": -1254713600,
    "ts": 1638252373322549, "dur": 1,
    "args": {
      "cbid": 151, "correlation": 3278,
      "external id": 0, "external ts": 1638252373407074
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373327559, "dur": 280,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3283, "external id": 641,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3283, "pid": 0, "tid": 7, "ts": 1638252373327559,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373322617, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 3283,
      "external id": 641, "external ts": 1638252373322594
    }
  },
  {
    "ph": "s", "id": 3283, "pid": 2762, "tid": 2762, "ts": 1638252373322617,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2> >(int, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>)", "pid": 0, "tid": 7,
    "ts": 1638252373327842, "dur": 280,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3289, "external id": 642,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3289, "pid": 0, "tid": 7, "ts": 1638252373327842,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373322757, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3289,
      "external id": 642, "external ts": 1638252373322738
    }
  },
  {
    "ph": "s", "id": 3289, "pid": 2762, "tid": 2762, "ts": 1638252373322757,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373323147, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 3296,
      "external id": 649, "external ts": 1638252373323127
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373323151, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 3297,
      "external id": 649, "external ts": 1638252373323127
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638252373328126, "dur": 1,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 3298, "external id": 649,
      "bytes": 1152, "memory bandwidth (GB/s)": 0.9473684210526315
    }
  },
  {
    "ph": "f", "id": 3298, "pid": 0, "tid": 7, "ts": 1638252373328126,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373323157, "dur": 10,
    "args": {
      "cbid": 51, "correlation": 3298,
      "external id": 649, "external ts": 1638252373323127
    }
  },
  {
    "ph": "s", "id": 3298, "pid": 2762, "tid": 2762, "ts": 1638252373323157,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 0, "tid": 7,
    "ts": 1638252373328128, "dur": 5181,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3299, "external id": 649,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [12, 24, 4],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 3299, "pid": 0, "tid": 7, "ts": 1638252373328128,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373323169, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 3299,
      "external id": 649, "external ts": 1638252373323127
    }
  },
  {
    "ph": "s", "id": 3299, "pid": 2762, "tid": 2762, "ts": 1638252373323169,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373323185, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3301,
      "external id": 649, "external ts": 1638252373323127
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373333311, "dur": 73,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3305, "external id": 652,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3305, "pid": 0, "tid": 7, "ts": 1638252373333311,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373323352, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 3305,
      "external id": 652, "external ts": 1638252373323342
    }
  },
  {
    "ph": "s", "id": 3305, "pid": 2762, "tid": 2762, "ts": 1638252373323352,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 0, "tid": 7,
    "ts": 1638252373333387, "dur": 85,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3327, "external id": 654,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3327, "pid": 0, "tid": 7, "ts": 1638252373333387,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373323743, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3327,
      "external id": 654, "external ts": 1638252373323493
    }
  },
  {
    "ph": "s", "id": 3327, "pid": 2762, "tid": 2762, "ts": 1638252373323743,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373333475, "dur": 133,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3341, "external id": 660,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3341, "pid": 0, "tid": 7, "ts": 1638252373333475,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373324049, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3341,
      "external id": 660, "external ts": 1638252373323899
    }
  },
  {
    "ph": "s", "id": 3341, "pid": 2762, "tid": 2762, "ts": 1638252373324049,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373333611, "dur": 69,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3343, "external id": 660,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3343, "pid": 0, "tid": 7, "ts": 1638252373333611,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373324065, "dur": 10,
    "args": {
      "cbid": 211, "correlation": 3343,
      "external id": 660, "external ts": 1638252373323899
    }
  },
  {
    "ph": "s", "id": 3343, "pid": 2762, "tid": 2762, "ts": 1638252373324065,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373324479, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 3350,
      "external id": 672, "external ts": 1638252373324459
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_32x32_sliced1x4_tn", "pid": 0, "tid": 7,
    "ts": 1638252373333682, "dur": 79,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3351, "external id": 672,
      "registers per thread": 86,
      "shared memory": 32768,
      "blocks per SM": 1.4117647,
      "warps per SM": 5.647059,
      "grid": [1, 96, 1],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 18
    }
  },
  {
    "ph": "f", "id": 3351, "pid": 0, "tid": 7, "ts": 1638252373333682,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373324483, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 3351,
      "external id": 672, "external ts": 1638252373324459
    }
  },
  {
    "ph": "s", "id": 3351, "pid": 2762, "tid": 2762, "ts": 1638252373324483,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 4, true>(float*, float const*, int, int, int)", "pid": 0, "tid": 7,
    "ts": 1638252373333764, "dur": 2,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3358, "external id": 680,
      "registers per thread": 18,
      "shared memory": 0,
      "blocks per SM": 2.8235295,
      "warps per SM": 11.294118,
      "grid": [192, 1, 1],
      "block": [16, 8, 1],
      "est. achieved occupancy %": 35
    }
  },
  {
    "ph": "f", "id": 3358, "pid": 0, "tid": 7, "ts": 1638252373333764,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373324843, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 3358,
      "external id": 680, "external ts": 1638252373324827
    }
  },
  {
    "ph": "s", "id": 3358, "pid": 2762, "tid": 2762, "ts": 1638252373324843,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::nll_loss_forward_reduce_cuda_kernel_2d<float, float, long>(float*, float*, float*, long*, float*, bool, int, int, int, long)", "pid": 0, "tid": 7,
    "ts": 1638252373333768, "dur": 59,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3365, "external id": 683,
      "registers per thread": 38,
      "shared memory": 256,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.014705882,
      "grid": [1, 1, 1],
      "block": [32, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 3365, "pid": 0, "tid": 7, "ts": 1638252373333768,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373325059, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3365,
      "external id": 683, "external ts": 1638252373324968
    }
  },
  {
    "ph": "s", "id": 3365, "pid": 2762, "tid": 2762, "ts": 1638252373325059,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373325340, "dur": 2,
    "args": {
      "cbid": 134, "correlation": 3370,
      "external id": 347, "external ts": 1638252373306544
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373325344, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3371,
      "external id": 347, "external ts": 1638252373306544
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373325348, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 3373,
      "external id": 347, "external ts": 1638252373306544
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373325356, "dur": 1,
    "args": {
      "cbid": 134, "correlation": 3377,
      "external id": 347, "external ts": 1638252373306544
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373325358, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3378,
      "external id": 347, "external ts": 1638252373306544
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 2762, "tid": 2762,
    "ts": 1638252373325403, "dur": 8427,
    "args": {
      "cbid": 165, "correlation": 3382,
      "external id": 347, "external ts": 1638252373306544
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373334765, "dur": 5,
    "args": {
      "cbid": 138, "correlation": 3383,
      "external id": 690, "external ts": 1638252373334255
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2762, "tid": 2762,
    "ts": 1638252373334770, "dur": 2,
    "args": {
      "cbid": 136, "correlation": 3384,
      "external id": 690, "external ts": 1638252373334255
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373334774, "dur": 1,
    "args": {
      "cbid": 138, "correlation": 3385,
      "external id": 690, "external ts": 1638252373334255
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2762, "tid": 2762,
    "ts": 1638252373334775, "dur": 1,
    "args": {
      "cbid": 136, "correlation": 3386,
      "external id": 690, "external ts": 1638252373334255
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy HtoD (Pinned -> Device)", "pid": 0, "tid": 7,
    "ts": 1638252373334967, "dur": 2,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 3405, "external id": 700,
      "bytes": 24576, "memory bandwidth (GB/s)": 10.105263157894736
    }
  },
  {
    "ph": "f", "id": 3405, "pid": 0, "tid": 7, "ts": 1638252373334967,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373334943, "dur": 20,
    "args": {
      "cbid": 41, "correlation": 3405,
      "external id": 700, "external ts": 1638252373334934
    }
  },
  {
    "ph": "s", "id": 3405, "pid": 2762, "tid": 2762, "ts": 1638252373334943,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamSynchronize", "pid": 2762, "tid": 2762,
    "ts": 1638252373334965, "dur": 8,
    "args": {
      "cbid": 131, "correlation": 3406,
      "external id": 700, "external ts": 1638252373334934
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy HtoD (Pinned -> Device)", "pid": 0, "tid": 7,
    "ts": 1638252373335108, "dur": 2,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 3418, "external id": 704,
      "bytes": 24576, "memory bandwidth (GB/s)": 12.0
    }
  },
  {
    "ph": "f", "id": 3418, "pid": 0, "tid": 7, "ts": 1638252373335108,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373335088, "dur": 15,
    "args": {
      "cbid": 41, "correlation": 3418,
      "external id": 704, "external ts": 1638252373335083
    }
  },
  {
    "ph": "s", "id": 3418, "pid": 2762, "tid": 2762, "ts": 1638252373335088,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamSynchronize", "pid": 2762, "tid": 2762,
    "ts": 1638252373335105, "dur": 8,
    "args": {
      "cbid": 131, "correlation": 3419,
      "external id": 704, "external ts": 1638252373335083
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 2762, "tid": 2762,
    "ts": 1638252373335363, "dur": 5,
    "args": {
      "cbid": 165, "correlation": 3423,
      "external id": 690, "external ts": 1638252373334255
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373335649, "dur": 2,
    "args": {
      "cbid": 134, "correlation": 3429,
      "external id": 690, "external ts": 1638252373334255
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373335654, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3432,
      "external id": 690, "external ts": 1638252373334255
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamWaitEvent", "pid": 2762, "tid": 2762,
    "ts": 1638252373335660, "dur": 1,
    "args": {
      "cbid": 147, "correlation": 3435,
      "external id": 690, "external ts": 1638252373334255
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2762, "tid": 2762,
    "ts": 1638252373335666, "dur": 1,
    "args": {
      "cbid": 136, "correlation": 3438,
      "external id": 690, "external ts": 1638252373334255
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoH (Device -> Pinned)", "pid": 0, "tid": 7,
    "ts": 1638252373339268, "dur": 3,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 3447, "external id": 805,
      "bytes": 24576, "memory bandwidth (GB/s)": 8.08421052631579
    }
  },
  {
    "ph": "f", "id": 3447, "pid": 0, "tid": 7, "ts": 1638252373339268,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373339249, "dur": 17,
    "args": {
      "cbid": 41, "correlation": 3447,
      "external id": 805, "external ts": 1638252373339241
    }
  },
  {
    "ph": "s", "id": 3447, "pid": 2762, "tid": 2762, "ts": 1638252373339249,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoH (Device -> Pinned)", "pid": 0, "tid": 7,
    "ts": 1638252373339432, "dur": 2,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 3453, "external id": 809,
      "bytes": 24576, "memory bandwidth (GB/s)": 8.533333333333333
    }
  },
  {
    "ph": "f", "id": 3453, "pid": 0, "tid": 7, "ts": 1638252373339432,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373339419, "dur": 11,
    "args": {
      "cbid": 41, "correlation": 3453,
      "external id": 809, "external ts": 1638252373339413
    }
  },
  {
    "ph": "s", "id": 3453, "pid": 2762, "tid": 2762, "ts": 1638252373339419,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::indexSelectLargeIndex<float, long, unsigned int, 2, 2, -2, true>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<long, unsigned int>, int, int, unsigned int, unsigned int, long)", "pid": 0, "tid": 7,
    "ts": 1638252373340112, "dur": 74,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3466, "external id": 813,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 8.0,
      "warps per SM": 32.0,
      "grid": [544, 1, 1],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3466, "pid": 0, "tid": 7, "ts": 1638252373340112,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373340086, "dur": 25,
    "args": {
      "cbid": 211, "correlation": 3466,
      "external id": 813, "external ts": 1638252373339974
    }
  },
  {
    "ph": "s", "id": 3466, "pid": 2762, "tid": 2762, "ts": 1638252373340086,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373340399, "dur": 73,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3474, "external id": 821,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3474, "pid": 0, "tid": 7, "ts": 1638252373340399,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373340380, "dur": 17,
    "args": {
      "cbid": 211, "correlation": 3474,
      "external id": 821, "external ts": 1638252373340356
    }
  },
  {
    "ph": "s", "id": 3474, "pid": 2762, "tid": 2762, "ts": 1638252373340380,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 0, "tid": 7,
    "ts": 1638252373340709, "dur": 87,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3496, "external id": 823,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3496, "pid": 0, "tid": 7, "ts": 1638252373340709,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373340693, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3496,
      "external id": 823, "external ts": 1638252373340494
    }
  },
  {
    "ph": "s", "id": 3496, "pid": 2762, "tid": 2762, "ts": 1638252373340693,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373341022, "dur": 134,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3510, "external id": 829,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3510, "pid": 0, "tid": 7, "ts": 1638252373341022,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373341007, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3510,
      "external id": 829, "external ts": 1638252373340844
    }
  },
  {
    "ph": "s", "id": 3510, "pid": 2762, "tid": 2762, "ts": 1638252373341007,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373341159, "dur": 67,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3512, "external id": 829,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3512, "pid": 0, "tid": 7, "ts": 1638252373341159,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373341023, "dur": 10,
    "args": {
      "cbid": 211, "correlation": 3512,
      "external id": 829, "external ts": 1638252373340844
    }
  },
  {
    "ph": "s", "id": 3512, "pid": 2762, "tid": 2762, "ts": 1638252373341023,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373341508, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 3519,
      "external id": 841, "external ts": 1638252373341486
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373341513, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 3520,
      "external id": 841, "external ts": 1638252373341486
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638252373341532, "dur": 2,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 3521, "external id": 841,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.125
    }
  },
  {
    "ph": "f", "id": 3521, "pid": 0, "tid": 7, "ts": 1638252373341532,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373341519, "dur": 10,
    "args": {
      "cbid": 51, "correlation": 3521,
      "external id": 841, "external ts": 1638252373341486
    }
  },
  {
    "ph": "s", "id": 3521, "pid": 2762, "tid": 2762, "ts": 1638252373341519,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373341530, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 3522,
      "external id": 841, "external ts": 1638252373341486
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 0, "tid": 7,
    "ts": 1638252373341552, "dur": 1393,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3523, "external id": 841,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 3523, "pid": 0, "tid": 7, "ts": 1638252373341552,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373341537, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3523,
      "external id": 841, "external ts": 1638252373341486
    }
  },
  {
    "ph": "s", "id": 3523, "pid": 2762, "tid": 2762, "ts": 1638252373341537,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373341553, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3525,
      "external id": 841, "external ts": 1638252373341486
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373342947, "dur": 74,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3529, "external id": 844,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3529, "pid": 0, "tid": 7, "ts": 1638252373342947,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373341729, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3529,
      "external id": 844, "external ts": 1638252373341716
    }
  },
  {
    "ph": "s", "id": 3529, "pid": 2762, "tid": 2762, "ts": 1638252373341729,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373342244, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 3536,
      "external id": 854, "external ts": 1638252373342223
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373342248, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 3537,
      "external id": 854, "external ts": 1638252373342223
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638252373343024, "dur": 0,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 3538, "external id": 854,
      "bytes": 2304, "memory bandwidth (GB/s)": 2.3225806451612905
    }
  },
  {
    "ph": "f", "id": 3538, "pid": 0, "tid": 7, "ts": 1638252373343024,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373342252, "dur": 9,
    "args": {
      "cbid": 51, "correlation": 3538,
      "external id": 854, "external ts": 1638252373342223
    }
  },
  {
    "ph": "s", "id": 3538, "pid": 2762, "tid": 2762, "ts": 1638252373342252,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373342262, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 3539,
      "external id": 854, "external ts": 1638252373342223
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 0, "tid": 7,
    "ts": 1638252373343027, "dur": 1380,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3540, "external id": 854,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 3540, "pid": 0, "tid": 7, "ts": 1638252373343027,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373342268, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3540,
      "external id": 854, "external ts": 1638252373342223
    }
  },
  {
    "ph": "s", "id": 3540, "pid": 2762, "tid": 2762, "ts": 1638252373342268,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373342284, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3542,
      "external id": 854, "external ts": 1638252373342223
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373344409, "dur": 75,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3546, "external id": 857,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3546, "pid": 0, "tid": 7, "ts": 1638252373344409,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373342444, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 3546,
      "external id": 857, "external ts": 1638252373342434
    }
  },
  {
    "ph": "s", "id": 3546, "pid": 2762, "tid": 2762, "ts": 1638252373342444,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373342966, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 3553,
      "external id": 867, "external ts": 1638252373342944
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373342970, "dur": 2,
    "args": {
      "cbid": 138, "correlation": 3554,
      "external id": 867, "external ts": 1638252373342944
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638252373344487, "dur": 1,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 3555, "external id": 867,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.565217391304348
    }
  },
  {
    "ph": "f", "id": 3555, "pid": 0, "tid": 7, "ts": 1638252373344487,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373342974, "dur": 9,
    "args": {
      "cbid": 51, "correlation": 3555,
      "external id": 867, "external ts": 1638252373342944
    }
  },
  {
    "ph": "s", "id": 3555, "pid": 2762, "tid": 2762, "ts": 1638252373342974,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373342985, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 3556,
      "external id": 867, "external ts": 1638252373342944
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 0, "tid": 7,
    "ts": 1638252373344491, "dur": 1383,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3557, "external id": 867,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 3557, "pid": 0, "tid": 7, "ts": 1638252373344491,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373342990, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 3557,
      "external id": 867, "external ts": 1638252373342944
    }
  },
  {
    "ph": "s", "id": 3557, "pid": 2762, "tid": 2762, "ts": 1638252373342990,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373343006, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3559,
      "external id": 867, "external ts": 1638252373342944
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373345876, "dur": 75,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3563, "external id": 870,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3563, "pid": 0, "tid": 7, "ts": 1638252373345876,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373343169, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 3563,
      "external id": 870, "external ts": 1638252373343160
    }
  },
  {
    "ph": "s", "id": 3563, "pid": 2762, "tid": 2762, "ts": 1638252373343169,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373345952, "dur": 75,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3571, "external id": 883,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3571, "pid": 0, "tid": 7, "ts": 1638252373345952,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373343792, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 3571,
      "external id": 883, "external ts": 1638252373343782
    }
  },
  {
    "ph": "s", "id": 3571, "pid": 2762, "tid": 2762, "ts": 1638252373343792,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373346029, "dur": 71,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3580, "external id": 892,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3580, "pid": 0, "tid": 7, "ts": 1638252373346029,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373344219, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 3580,
      "external id": 892, "external ts": 1638252373344211
    }
  },
  {
    "ph": "s", "id": 3580, "pid": 2762, "tid": 2762, "ts": 1638252373344219,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 0, "tid": 7,
    "ts": 1638252373346103, "dur": 282,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3590, "external id": 895,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3590, "pid": 0, "tid": 7, "ts": 1638252373346103,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373344429, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 3590,
      "external id": 895, "external ts": 1638252373344366
    }
  },
  {
    "ph": "s", "id": 3590, "pid": 2762, "tid": 2762, "ts": 1638252373344429,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 0, "tid": 7,
    "ts": 1638252373346388, "dur": 10,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3596, "external id": 899,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3596, "pid": 0, "tid": 7, "ts": 1638252373346388,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373344636, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 3596,
      "external id": 899, "external ts": 1638252373344616
    }
  },
  {
    "ph": "s", "id": 3596, "pid": 2762, "tid": 2762, "ts": 1638252373344636,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 0, "tid": 7,
    "ts": 1638252373346400, "dur": 1,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3604, "external id": 904,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.029411765,
      "grid": [1, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 3604, "pid": 0, "tid": 7, "ts": 1638252373346400,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373344941, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3604,
      "external id": 904, "external ts": 1638252373344909
    }
  },
  {
    "ph": "s", "id": 3604, "pid": 2762, "tid": 2762, "ts": 1638252373344941,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoD (Device -> Device)", "pid": 0, "tid": 7,
    "ts": 1638252373346404, "dur": 9,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 3611, "external id": 913,
      "bytes": 3538944, "memory bandwidth (GB/s)": 366.19867549668874
    }
  },
  {
    "ph": "f", "id": 3611, "pid": 0, "tid": 7, "ts": 1638252373346404,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373345365, "dur": 23,
    "args": {
      "cbid": 41, "correlation": 3611,
      "external id": 913, "external ts": 1638252373345360
    }
  },
  {
    "ph": "s", "id": 3611, "pid": 2762, "tid": 2762, "ts": 1638252373345365,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast>(int, at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373346416, "dur": 12,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3616, "external id": 914,
      "registers per thread": 24,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3616, "pid": 0, "tid": 7, "ts": 1638252373346416,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373345536, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3616,
      "external id": 914, "external ts": 1638252373345438
    }
  },
  {
    "ph": "s", "id": 3616, "pid": 2762, "tid": 2762, "ts": 1638252373345536,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 3, false>(float*, float const*, int, int, int)", "pid": 0, "tid": 7,
    "ts": 1638252373346432, "dur": 20,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3623, "external id": 918,
      "registers per thread": 19,
      "shared memory": 0,
      "blocks per SM": 67.76471,
      "warps per SM": 271.05884,
      "grid": [4608, 1, 1],
      "block": [8, 16, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3623, "pid": 0, "tid": 7, "ts": 1638252373346432,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373345692, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 3623,
      "external id": 918, "external ts": 1638252373345677
    }
  },
  {
    "ph": "s", "id": 3623, "pid": 2762, "tid": 2762, "ts": 1638252373345692,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 0, "tid": 7,
    "ts": 1638252373346454, "dur": 13,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3645, "external id": 920,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3645, "pid": 0, "tid": 7, "ts": 1638252373346454,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373346066, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3645,
      "external id": 920, "external ts": 1638252373345835
    }
  },
  {
    "ph": "s", "id": 3645, "pid": 2762, "tid": 2762, "ts": 1638252373346066,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373346666, "dur": 74,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3653, "external id": 936,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3653, "pid": 0, "tid": 7, "ts": 1638252373346666,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373346650, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3653,
      "external id": 936, "external ts": 1638252373346640
    }
  },
  {
    "ph": "s", "id": 3653, "pid": 2762, "tid": 2762, "ts": 1638252373346650,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 0, "tid": 7,
    "ts": 1638252373346881, "dur": 272,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3663, "external id": 939,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3663, "pid": 0, "tid": 7, "ts": 1638252373346881,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373346868, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 3663,
      "external id": 939, "external ts": 1638252373346804
    }
  },
  {
    "ph": "s", "id": 3663, "pid": 2762, "tid": 2762, "ts": 1638252373346868,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373347319, "dur": 72,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3672, "external id": 949,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3672, "pid": 0, "tid": 7, "ts": 1638252373347319,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373347304, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3672,
      "external id": 949, "external ts": 1638252373347296
    }
  },
  {
    "ph": "s", "id": 3672, "pid": 2762, "tid": 2762, "ts": 1638252373347304,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373347762, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 3681,
      "external id": 957, "external ts": 1638252373347740
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373347766, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 3682,
      "external id": 957, "external ts": 1638252373347740
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638252373347787, "dur": 1,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 3683, "external id": 957,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.3584905660377358
    }
  },
  {
    "ph": "f", "id": 3683, "pid": 0, "tid": 7, "ts": 1638252373347787,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373347773, "dur": 10,
    "args": {
      "cbid": 51, "correlation": 3683,
      "external id": 957, "external ts": 1638252373347740
    }
  },
  {
    "ph": "s", "id": 3683, "pid": 2762, "tid": 2762, "ts": 1638252373347773,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373347784, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 3684,
      "external id": 957, "external ts": 1638252373347740
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 0, "tid": 7,
    "ts": 1638252373347805, "dur": 1390,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3685, "external id": 957,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 3685, "pid": 0, "tid": 7, "ts": 1638252373347805,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373347790, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3685,
      "external id": 957, "external ts": 1638252373347740
    }
  },
  {
    "ph": "s", "id": 3685, "pid": 2762, "tid": 2762, "ts": 1638252373347790,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373347807, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3687,
      "external id": 957, "external ts": 1638252373347740
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373349199, "dur": 74,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3691, "external id": 960,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3691, "pid": 0, "tid": 7, "ts": 1638252373349199,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373347975, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3691,
      "external id": 960, "external ts": 1638252373347963
    }
  },
  {
    "ph": "s", "id": 3691, "pid": 2762, "tid": 2762, "ts": 1638252373347975,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 0, "tid": 7,
    "ts": 1638252373349276, "dur": 86,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3713, "external id": 962,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3713, "pid": 0, "tid": 7, "ts": 1638252373349276,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373348338, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3713,
      "external id": 962, "external ts": 1638252373348107
    }
  },
  {
    "ph": "s", "id": 3713, "pid": 2762, "tid": 2762, "ts": 1638252373348338,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3> >(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>)", "pid": 0, "tid": 7,
    "ts": 1638252373349364, "dur": 104,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3719, "external id": 967,
      "registers per thread": 20,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3719, "pid": 0, "tid": 7, "ts": 1638252373349364,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373348462, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3719,
      "external id": 967, "external ts": 1638252373348446
    }
  },
  {
    "ph": "s", "id": 3719, "pid": 2762, "tid": 2762, "ts": 1638252373348462,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373349470, "dur": 124,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3733, "external id": 969,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3733, "pid": 0, "tid": 7, "ts": 1638252373349470,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373348778, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3733,
      "external id": 969, "external ts": 1638252373348595
    }
  },
  {
    "ph": "s", "id": 3733, "pid": 2762, "tid": 2762, "ts": 1638252373348778,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373349597, "dur": 68,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3735, "external id": 969,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3735, "pid": 0, "tid": 7, "ts": 1638252373349597,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373348794, "dur": 9,
    "args": {
      "cbid": 211, "correlation": 3735,
      "external id": 969, "external ts": 1638252373348595
    }
  },
  {
    "ph": "s", "id": 3735, "pid": 2762, "tid": 2762, "ts": 1638252373348794,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373349494, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 3742,
      "external id": 981, "external ts": 1638252373349472
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373349498, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 3743,
      "external id": 981, "external ts": 1638252373349472
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 0, "tid": 7,
    "ts": 1638252373349668, "dur": 5145,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3744, "external id": 981,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [48, 24, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 3744, "pid": 0, "tid": 7, "ts": 1638252373349668,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373349503, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 3744,
      "external id": 981, "external ts": 1638252373349472
    }
  },
  {
    "ph": "s", "id": 3744, "pid": 2762, "tid": 2762, "ts": 1638252373349503,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373354816, "dur": 282,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3749, "external id": 984,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3749, "pid": 0, "tid": 7, "ts": 1638252373354816,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373349785, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3749,
      "external id": 984, "external ts": 1638252373349773
    }
  },
  {
    "ph": "s", "id": 3749, "pid": 2762, "tid": 2762, "ts": 1638252373349785,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2> >(int, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>)", "pid": 0, "tid": 7,
    "ts": 1638252373355100, "dur": 280,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3755, "external id": 985,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3755, "pid": 0, "tid": 7, "ts": 1638252373355100,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373349896, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3755,
      "external id": 985, "external ts": 1638252373349876
    }
  },
  {
    "ph": "s", "id": 3755, "pid": 2762, "tid": 2762, "ts": 1638252373349896,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 2762, "tid": -1254713600,
    "ts": 1638252373349940, "dur": 5,
    "args": {
      "cbid": 151, "correlation": 3761,
      "external id": 0, "external ts": 1638252373407074
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 2762, "tid": -1254713600,
    "ts": 1638252373349982, "dur": 1,
    "args": {
      "cbid": 151, "correlation": 3767,
      "external id": 0, "external ts": 1638252373407074
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373350404, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 3774,
      "external id": 992, "external ts": 1638252373350381
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373350409, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 3775,
      "external id": 992, "external ts": 1638252373350381
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638252373355383, "dur": 2,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 3776, "external id": 992,
      "bytes": 1152, "memory bandwidth (GB/s)": 0.5625
    }
  },
  {
    "ph": "f", "id": 3776, "pid": 0, "tid": 7, "ts": 1638252373355383,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373350415, "dur": 11,
    "args": {
      "cbid": 51, "correlation": 3776,
      "external id": 992, "external ts": 1638252373350381
    }
  },
  {
    "ph": "s", "id": 3776, "pid": 2762, "tid": 2762, "ts": 1638252373350415,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 0, "tid": 7,
    "ts": 1638252373355387, "dur": 5170,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3777, "external id": 992,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [12, 24, 4],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 3777, "pid": 0, "tid": 7, "ts": 1638252373355387,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373350428, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3777,
      "external id": 992, "external ts": 1638252373350381
    }
  },
  {
    "ph": "s", "id": 3777, "pid": 2762, "tid": 2762, "ts": 1638252373350428,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373350444, "dur": 2,
    "args": {
      "cbid": 135, "correlation": 3779,
      "external id": 992, "external ts": 1638252373350381
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373360559, "dur": 74,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3783, "external id": 995,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3783, "pid": 0, "tid": 7, "ts": 1638252373360559,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373350621, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 3783,
      "external id": 995, "external ts": 1638252373350610
    }
  },
  {
    "ph": "s", "id": 3783, "pid": 2762, "tid": 2762, "ts": 1638252373350621,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 0, "tid": 7,
    "ts": 1638252373360635, "dur": 88,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3805, "external id": 997,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3805, "pid": 0, "tid": 7, "ts": 1638252373360635,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373351001, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3805,
      "external id": 997, "external ts": 1638252373350767
    }
  },
  {
    "ph": "s", "id": 3805, "pid": 2762, "tid": 2762, "ts": 1638252373351001,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373360726, "dur": 133,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3819, "external id": 1003,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3819, "pid": 0, "tid": 7, "ts": 1638252373360726,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373351314, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3819,
      "external id": 1003, "external ts": 1638252373351151
    }
  },
  {
    "ph": "s", "id": 3819, "pid": 2762, "tid": 2762, "ts": 1638252373351314,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373360861, "dur": 67,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3821, "external id": 1003,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3821, "pid": 0, "tid": 7, "ts": 1638252373360861,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373351329, "dur": 9,
    "args": {
      "cbid": 211, "correlation": 3821,
      "external id": 1003, "external ts": 1638252373351151
    }
  },
  {
    "ph": "s", "id": 3821, "pid": 2762, "tid": 2762, "ts": 1638252373351329,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373351753, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 3828,
      "external id": 1015, "external ts": 1638252373351732
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_32x32_sliced1x4_tn", "pid": 0, "tid": 7,
    "ts": 1638252373360931, "dur": 78,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3829, "external id": 1015,
      "registers per thread": 86,
      "shared memory": 32768,
      "blocks per SM": 1.4117647,
      "warps per SM": 5.647059,
      "grid": [1, 96, 1],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 18
    }
  },
  {
    "ph": "f", "id": 3829, "pid": 0, "tid": 7, "ts": 1638252373360931,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373351757, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 3829,
      "external id": 1015, "external ts": 1638252373351732
    }
  },
  {
    "ph": "s", "id": 3829, "pid": 2762, "tid": 2762, "ts": 1638252373351757,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 4, true>(float*, float const*, int, int, int)", "pid": 0, "tid": 7,
    "ts": 1638252373361012, "dur": 2,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3836, "external id": 1023,
      "registers per thread": 18,
      "shared memory": 0,
      "blocks per SM": 2.8235295,
      "warps per SM": 11.294118,
      "grid": [192, 1, 1],
      "block": [16, 8, 1],
      "est. achieved occupancy %": 35
    }
  },
  {
    "ph": "f", "id": 3836, "pid": 0, "tid": 7, "ts": 1638252373361012,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373352106, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3836,
      "external id": 1023, "external ts": 1638252373352091
    }
  },
  {
    "ph": "s", "id": 3836, "pid": 2762, "tid": 2762, "ts": 1638252373352106,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::nll_loss_forward_reduce_cuda_kernel_2d<float, float, long>(float*, float*, float*, long*, float*, bool, int, int, int, long)", "pid": 0, "tid": 7,
    "ts": 1638252373361017, "dur": 59,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3843, "external id": 1026,
      "registers per thread": 38,
      "shared memory": 256,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.014705882,
      "grid": [1, 1, 1],
      "block": [32, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 3843, "pid": 0, "tid": 7, "ts": 1638252373361017,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373352319, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3843,
      "external id": 1026, "external ts": 1638252373352229
    }
  },
  {
    "ph": "s", "id": 3843, "pid": 2762, "tid": 2762, "ts": 1638252373352319,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373352612, "dur": 2,
    "args": {
      "cbid": 134, "correlation": 3848,
      "external id": 690, "external ts": 1638252373334255
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373352615, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3849,
      "external id": 690, "external ts": 1638252373334255
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373352620, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 3851,
      "external id": 690, "external ts": 1638252373334255
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373352627, "dur": 0,
    "args": {
      "cbid": 134, "correlation": 3855,
      "external id": 690, "external ts": 1638252373334255
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373352629, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3856,
      "external id": 690, "external ts": 1638252373334255
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 2762, "tid": 2762,
    "ts": 1638252373352676, "dur": 8403,
    "args": {
      "cbid": 165, "correlation": 3860,
      "external id": 690, "external ts": 1638252373334255
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy HtoD (Pinned -> Device)", "pid": 0, "tid": 7,
    "ts": 1638252373362215, "dur": 2,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 3871, "external id": 1043,
      "bytes": 24576, "memory bandwidth (GB/s)": 12.0
    }
  },
  {
    "ph": "f", "id": 3871, "pid": 0, "tid": 7, "ts": 1638252373362215,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373362190, "dur": 21,
    "args": {
      "cbid": 41, "correlation": 3871,
      "external id": 1043, "external ts": 1638252373362181
    }
  },
  {
    "ph": "s", "id": 3871, "pid": 2762, "tid": 2762, "ts": 1638252373362190,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamSynchronize", "pid": 2762, "tid": 2762,
    "ts": 1638252373362212, "dur": 8,
    "args": {
      "cbid": 131, "correlation": 3872,
      "external id": 1043, "external ts": 1638252373362181
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy HtoD (Pinned -> Device)", "pid": 0, "tid": 7,
    "ts": 1638252373362354, "dur": 2,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 3884, "external id": 1047,
      "bytes": 24576, "memory bandwidth (GB/s)": 10.816901408450704
    }
  },
  {
    "ph": "f", "id": 3884, "pid": 0, "tid": 7, "ts": 1638252373362354,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373362334, "dur": 16,
    "args": {
      "cbid": 41, "correlation": 3884,
      "external id": 1047, "external ts": 1638252373362328
    }
  },
  {
    "ph": "s", "id": 3884, "pid": 2762, "tid": 2762, "ts": 1638252373362334,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamSynchronize", "pid": 2762, "tid": 2762,
    "ts": 1638252373362350, "dur": 8,
    "args": {
      "cbid": 131, "correlation": 3885,
      "external id": 1047, "external ts": 1638252373362328
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 2762, "tid": 2762,
    "ts": 1638252373362620, "dur": 5,
    "args": {
      "cbid": 165, "correlation": 3889,
      "external id": 1033, "external ts": 1638252373361509
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373362901, "dur": 2,
    "args": {
      "cbid": 134, "correlation": 3895,
      "external id": 1033, "external ts": 1638252373361509
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373362906, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3898,
      "external id": 1033, "external ts": 1638252373361509
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamWaitEvent", "pid": 2762, "tid": 2762,
    "ts": 1638252373362913, "dur": 1,
    "args": {
      "cbid": 147, "correlation": 3901,
      "external id": 1033, "external ts": 1638252373361509
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2762, "tid": 2762,
    "ts": 1638252373362918, "dur": 1,
    "args": {
      "cbid": 136, "correlation": 3904,
      "external id": 1033, "external ts": 1638252373361509
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373366449, "dur": 5,
    "args": {
      "cbid": 138, "correlation": 3909,
      "external id": 1147, "external ts": 1638252373366446
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2762, "tid": 2762,
    "ts": 1638252373366455, "dur": 2,
    "args": {
      "cbid": 136, "correlation": 3910,
      "external id": 1147, "external ts": 1638252373366446
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373366459, "dur": 1,
    "args": {
      "cbid": 138, "correlation": 3911,
      "external id": 1147, "external ts": 1638252373366446
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2762, "tid": 2762,
    "ts": 1638252373366460, "dur": 1,
    "args": {
      "cbid": 136, "correlation": 3912,
      "external id": 1147, "external ts": 1638252373366446
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoH (Device -> Pinned)", "pid": 0, "tid": 7,
    "ts": 1638252373366527, "dur": 2,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 3917, "external id": 1148,
      "bytes": 24576, "memory bandwidth (GB/s)": 8.533333333333333
    }
  },
  {
    "ph": "f", "id": 3917, "pid": 0, "tid": 7, "ts": 1638252373366527,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373366510, "dur": 15,
    "args": {
      "cbid": 41, "correlation": 3917,
      "external id": 1148, "external ts": 1638252373366501
    }
  },
  {
    "ph": "s", "id": 3917, "pid": 2762, "tid": 2762, "ts": 1638252373366510,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoH (Device -> Pinned)", "pid": 0, "tid": 7,
    "ts": 1638252373366700, "dur": 2,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 3923, "external id": 1152,
      "bytes": 24576, "memory bandwidth (GB/s)": 8.43956043956044
    }
  },
  {
    "ph": "f", "id": 3923, "pid": 0, "tid": 7, "ts": 1638252373366700,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373366687, "dur": 11,
    "args": {
      "cbid": 41, "correlation": 3923,
      "external id": 1152, "external ts": 1638252373366681
    }
  },
  {
    "ph": "s", "id": 3923, "pid": 2762, "tid": 2762, "ts": 1638252373366687,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::indexSelectLargeIndex<float, long, unsigned int, 2, 2, -2, true>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<long, unsigned int>, int, int, unsigned int, unsigned int, long)", "pid": 0, "tid": 7,
    "ts": 1638252373367042, "dur": 75,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3936, "external id": 1156,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 8.0,
      "warps per SM": 32.0,
      "grid": [544, 1, 1],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3936, "pid": 0, "tid": 7, "ts": 1638252373367042,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373367019, "dur": 22,
    "args": {
      "cbid": 211, "correlation": 3936,
      "external id": 1156, "external ts": 1638252373366909
    }
  },
  {
    "ph": "s", "id": 3936, "pid": 2762, "tid": 2762, "ts": 1638252373367019,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373367320, "dur": 73,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3944, "external id": 1164,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3944, "pid": 0, "tid": 7, "ts": 1638252373367320,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373367303, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 3944,
      "external id": 1164, "external ts": 1638252373367281
    }
  },
  {
    "ph": "s", "id": 3944, "pid": 2762, "tid": 2762, "ts": 1638252373367303,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 0, "tid": 7,
    "ts": 1638252373367636, "dur": 88,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3966, "external id": 1166,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3966, "pid": 0, "tid": 7, "ts": 1638252373367636,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373367620, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3966,
      "external id": 1166, "external ts": 1638252373367417
    }
  },
  {
    "ph": "s", "id": 3966, "pid": 2762, "tid": 2762, "ts": 1638252373367620,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373367968, "dur": 134,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3980, "external id": 1172,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3980, "pid": 0, "tid": 7, "ts": 1638252373367968,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373367952, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 3980,
      "external id": 1172, "external ts": 1638252373367772
    }
  },
  {
    "ph": "s", "id": 3980, "pid": 2762, "tid": 2762, "ts": 1638252373367952,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373368104, "dur": 68,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3982, "external id": 1172,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3982, "pid": 0, "tid": 7, "ts": 1638252373368104,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373367968, "dur": 10,
    "args": {
      "cbid": 211, "correlation": 3982,
      "external id": 1172, "external ts": 1638252373367772
    }
  },
  {
    "ph": "s", "id": 3982, "pid": 2762, "tid": 2762, "ts": 1638252373367968,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373368476, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 3989,
      "external id": 1184, "external ts": 1638252373368447
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373368481, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 3990,
      "external id": 1184, "external ts": 1638252373368447
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638252373368500, "dur": 2,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 3991, "external id": 1184,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.125
    }
  },
  {
    "ph": "f", "id": 3991, "pid": 0, "tid": 7, "ts": 1638252373368500,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373368487, "dur": 10,
    "args": {
      "cbid": 51, "correlation": 3991,
      "external id": 1184, "external ts": 1638252373368447
    }
  },
  {
    "ph": "s", "id": 3991, "pid": 2762, "tid": 2762, "ts": 1638252373368487,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373368498, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 3992,
      "external id": 1184, "external ts": 1638252373368447
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 0, "tid": 7,
    "ts": 1638252373368520, "dur": 1391,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3993, "external id": 1184,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 3993, "pid": 0, "tid": 7, "ts": 1638252373368520,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373368505, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3993,
      "external id": 1184, "external ts": 1638252373368447
    }
  },
  {
    "ph": "s", "id": 3993, "pid": 2762, "tid": 2762, "ts": 1638252373368505,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373368521, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 3995,
      "external id": 1184, "external ts": 1638252373368447
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373369912, "dur": 74,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3999, "external id": 1187,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3999, "pid": 0, "tid": 7, "ts": 1638252373369912,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373368701, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 3999,
      "external id": 1187, "external ts": 1638252373368688
    }
  },
  {
    "ph": "s", "id": 3999, "pid": 2762, "tid": 2762, "ts": 1638252373368701,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373369231, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4006,
      "external id": 1197, "external ts": 1638252373369210
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373369235, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 4007,
      "external id": 1197, "external ts": 1638252373369210
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638252373369990, "dur": 0,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 4008, "external id": 1197,
      "bytes": 2304, "memory bandwidth (GB/s)": 2.88
    }
  },
  {
    "ph": "f", "id": 4008, "pid": 0, "tid": 7, "ts": 1638252373369990,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373369240, "dur": 9,
    "args": {
      "cbid": 51, "correlation": 4008,
      "external id": 1197, "external ts": 1638252373369210
    }
  },
  {
    "ph": "s", "id": 4008, "pid": 2762, "tid": 2762, "ts": 1638252373369240,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373369250, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4009,
      "external id": 1197, "external ts": 1638252373369210
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 0, "tid": 7,
    "ts": 1638252373369993, "dur": 1384,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4010, "external id": 1197,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4010, "pid": 0, "tid": 7, "ts": 1638252373369993,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373369256, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4010,
      "external id": 1197, "external ts": 1638252373369210
    }
  },
  {
    "ph": "s", "id": 4010, "pid": 2762, "tid": 2762, "ts": 1638252373369256,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373369271, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4012,
      "external id": 1197, "external ts": 1638252373369210
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373371379, "dur": 75,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4016, "external id": 1200,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4016, "pid": 0, "tid": 7, "ts": 1638252373371379,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373369439, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4016,
      "external id": 1200, "external ts": 1638252373369429
    }
  },
  {
    "ph": "s", "id": 4016, "pid": 2762, "tid": 2762, "ts": 1638252373369439,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373369968, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4023,
      "external id": 1210, "external ts": 1638252373369948
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373369972, "dur": 2,
    "args": {
      "cbid": 138, "correlation": 4024,
      "external id": 1210, "external ts": 1638252373369948
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638252373371457, "dur": 1,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 4025, "external id": 1210,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.5319148936170213
    }
  },
  {
    "ph": "f", "id": 4025, "pid": 0, "tid": 7, "ts": 1638252373371457,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373369976, "dur": 9,
    "args": {
      "cbid": 51, "correlation": 4025,
      "external id": 1210, "external ts": 1638252373369948
    }
  },
  {
    "ph": "s", "id": 4025, "pid": 2762, "tid": 2762, "ts": 1638252373369976,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373369986, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4026,
      "external id": 1210, "external ts": 1638252373369948
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 0, "tid": 7,
    "ts": 1638252373371461, "dur": 1381,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4027, "external id": 1210,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4027, "pid": 0, "tid": 7, "ts": 1638252373371461,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373369992, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4027,
      "external id": 1210, "external ts": 1638252373369948
    }
  },
  {
    "ph": "s", "id": 4027, "pid": 2762, "tid": 2762, "ts": 1638252373369992,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373370007, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4029,
      "external id": 1210, "external ts": 1638252373369948
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373372845, "dur": 74,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4033, "external id": 1213,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4033, "pid": 0, "tid": 7, "ts": 1638252373372845,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373370171, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4033,
      "external id": 1213, "external ts": 1638252373370161
    }
  },
  {
    "ph": "s", "id": 4033, "pid": 2762, "tid": 2762, "ts": 1638252373370171,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373372922, "dur": 75,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4041, "external id": 1226,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4041, "pid": 0, "tid": 7, "ts": 1638252373372922,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373370796, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4041,
      "external id": 1226, "external ts": 1638252373370786
    }
  },
  {
    "ph": "s", "id": 4041, "pid": 2762, "tid": 2762, "ts": 1638252373370796,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373372999, "dur": 71,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4050, "external id": 1235,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4050, "pid": 0, "tid": 7, "ts": 1638252373372999,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373371559, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4050,
      "external id": 1235, "external ts": 1638252373371551
    }
  },
  {
    "ph": "s", "id": 4050, "pid": 2762, "tid": 2762, "ts": 1638252373371559,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 2762, "tid": -1254713600,
    "ts": 1638252373371767, "dur": 5,
    "args": {
      "cbid": 151, "correlation": 4057,
      "external id": 0, "external ts": 1638252373407074
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 2762, "tid": -1254713600,
    "ts": 1638252373371804, "dur": 1,
    "args": {
      "cbid": 151, "correlation": 4064,
      "external id": 0, "external ts": 1638252373407074
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 0, "tid": 7,
    "ts": 1638252373373073, "dur": 282,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4072, "external id": 1238,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4072, "pid": 0, "tid": 7, "ts": 1638252373373073,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373371880, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4072,
      "external id": 1238, "external ts": 1638252373371798
    }
  },
  {
    "ph": "s", "id": 4072, "pid": 2762, "tid": 2762, "ts": 1638252373371880,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 0, "tid": 7,
    "ts": 1638252373373358, "dur": 9,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4078, "external id": 1242,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4078, "pid": 0, "tid": 7, "ts": 1638252373373358,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373372090, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4078,
      "external id": 1242, "external ts": 1638252373372071
    }
  },
  {
    "ph": "s", "id": 4078, "pid": 2762, "tid": 2762, "ts": 1638252373372090,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 0, "tid": 7,
    "ts": 1638252373373370, "dur": 1,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4086, "external id": 1247,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.029411765,
      "grid": [1, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 4086, "pid": 0, "tid": 7, "ts": 1638252373373370,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373372405, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4086,
      "external id": 1247, "external ts": 1638252373372375
    }
  },
  {
    "ph": "s", "id": 4086, "pid": 2762, "tid": 2762, "ts": 1638252373372405,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoD (Device -> Device)", "pid": 0, "tid": 7,
    "ts": 1638252373373374, "dur": 9,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 4093, "external id": 1256,
      "bytes": 3538944, "memory bandwidth (GB/s)": 354.46153846153845
    }
  },
  {
    "ph": "f", "id": 4093, "pid": 0, "tid": 7, "ts": 1638252373373374,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373372843, "dur": 23,
    "args": {
      "cbid": 41, "correlation": 4093,
      "external id": 1256, "external ts": 1638252373372837
    }
  },
  {
    "ph": "s", "id": 4093, "pid": 2762, "tid": 2762, "ts": 1638252373372843,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast>(int, at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373373386, "dur": 13,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4098, "external id": 1257,
      "registers per thread": 24,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4098, "pid": 0, "tid": 7, "ts": 1638252373373386,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373373014, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4098,
      "external id": 1257, "external ts": 1638252373372918
    }
  },
  {
    "ph": "s", "id": 4098, "pid": 2762, "tid": 2762, "ts": 1638252373373014,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 3, false>(float*, float const*, int, int, int)", "pid": 0, "tid": 7,
    "ts": 1638252373373402, "dur": 20,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4105, "external id": 1261,
      "registers per thread": 19,
      "shared memory": 0,
      "blocks per SM": 67.76471,
      "warps per SM": 271.05884,
      "grid": [4608, 1, 1],
      "block": [8, 16, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4105, "pid": 0, "tid": 7, "ts": 1638252373373402,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373373155, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4105,
      "external id": 1261, "external ts": 1638252373373139
    }
  },
  {
    "ph": "s", "id": 4105, "pid": 2762, "tid": 2762, "ts": 1638252373373155,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 0, "tid": 7,
    "ts": 1638252373373550, "dur": 13,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4127, "external id": 1263,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4127, "pid": 0, "tid": 7, "ts": 1638252373373550,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373373535, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4127,
      "external id": 1263, "external ts": 1638252373373303
    }
  },
  {
    "ph": "s", "id": 4127, "pid": 2762, "tid": 2762, "ts": 1638252373373535,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373374132, "dur": 75,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4135, "external id": 1279,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4135, "pid": 0, "tid": 7, "ts": 1638252373374132,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373374117, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4135,
      "external id": 1279, "external ts": 1638252373374107
    }
  },
  {
    "ph": "s", "id": 4135, "pid": 2762, "tid": 2762, "ts": 1638252373374117,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 0, "tid": 7,
    "ts": 1638252373374351, "dur": 272,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4145, "external id": 1282,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4145, "pid": 0, "tid": 7, "ts": 1638252373374351,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373374338, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4145,
      "external id": 1282, "external ts": 1638252373374274
    }
  },
  {
    "ph": "s", "id": 4145, "pid": 2762, "tid": 2762, "ts": 1638252373374338,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373374795, "dur": 72,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4154, "external id": 1292,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4154, "pid": 0, "tid": 7, "ts": 1638252373374795,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373374779, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4154,
      "external id": 1292, "external ts": 1638252373374771
    }
  },
  {
    "ph": "s", "id": 4154, "pid": 2762, "tid": 2762, "ts": 1638252373374779,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373375231, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4163,
      "external id": 1300, "external ts": 1638252373375207
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373375236, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 4164,
      "external id": 1300, "external ts": 1638252373375207
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638252373375256, "dur": 1,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 4165, "external id": 1300,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.8461538461538463
    }
  },
  {
    "ph": "f", "id": 4165, "pid": 0, "tid": 7, "ts": 1638252373375256,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373375242, "dur": 10,
    "args": {
      "cbid": 51, "correlation": 4165,
      "external id": 1300, "external ts": 1638252373375207
    }
  },
  {
    "ph": "s", "id": 4165, "pid": 2762, "tid": 2762, "ts": 1638252373375242,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373375253, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4166,
      "external id": 1300, "external ts": 1638252373375207
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 0, "tid": 7,
    "ts": 1638252373375275, "dur": 1388,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4167, "external id": 1300,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4167, "pid": 0, "tid": 7, "ts": 1638252373375275,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373375260, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4167,
      "external id": 1300, "external ts": 1638252373375207
    }
  },
  {
    "ph": "s", "id": 4167, "pid": 2762, "tid": 2762, "ts": 1638252373375260,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373375276, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4169,
      "external id": 1300, "external ts": 1638252373375207
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373376665, "dur": 74,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4173, "external id": 1303,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4173, "pid": 0, "tid": 7, "ts": 1638252373376665,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373375445, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4173,
      "external id": 1303, "external ts": 1638252373375434
    }
  },
  {
    "ph": "s", "id": 4173, "pid": 2762, "tid": 2762, "ts": 1638252373375445,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 0, "tid": 7,
    "ts": 1638252373376741, "dur": 86,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4195, "external id": 1305,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4195, "pid": 0, "tid": 7, "ts": 1638252373376741,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373375824, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4195,
      "external id": 1305, "external ts": 1638252373375578
    }
  },
  {
    "ph": "s", "id": 4195, "pid": 2762, "tid": 2762, "ts": 1638252373375824,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3> >(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>)", "pid": 0, "tid": 7,
    "ts": 1638252373376829, "dur": 104,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4201, "external id": 1310,
      "registers per thread": 20,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4201, "pid": 0, "tid": 7, "ts": 1638252373376829,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373375950, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4201,
      "external id": 1310, "external ts": 1638252373375933
    }
  },
  {
    "ph": "s", "id": 4201, "pid": 2762, "tid": 2762, "ts": 1638252373375950,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373376936, "dur": 124,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4215, "external id": 1312,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4215, "pid": 0, "tid": 7, "ts": 1638252373376936,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373376258, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4215,
      "external id": 1312, "external ts": 1638252373376083
    }
  },
  {
    "ph": "s", "id": 4215, "pid": 2762, "tid": 2762, "ts": 1638252373376258,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373377064, "dur": 68,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4217, "external id": 1312,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4217, "pid": 0, "tid": 7, "ts": 1638252373377064,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373376273, "dur": 10,
    "args": {
      "cbid": 211, "correlation": 4217,
      "external id": 1312, "external ts": 1638252373376083
    }
  },
  {
    "ph": "s", "id": 4217, "pid": 2762, "tid": 2762, "ts": 1638252373376273,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373376779, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4224,
      "external id": 1324, "external ts": 1638252373376759
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373376783, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4225,
      "external id": 1324, "external ts": 1638252373376759
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 0, "tid": 7,
    "ts": 1638252373377135, "dur": 5153,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4226, "external id": 1324,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [48, 24, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4226, "pid": 0, "tid": 7, "ts": 1638252373377135,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373376789, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4226,
      "external id": 1324, "external ts": 1638252373376759
    }
  },
  {
    "ph": "s", "id": 4226, "pid": 2762, "tid": 2762, "ts": 1638252373376789,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373382291, "dur": 281,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4231, "external id": 1327,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4231, "pid": 0, "tid": 7, "ts": 1638252373382291,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373376971, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4231,
      "external id": 1327, "external ts": 1638252373376960
    }
  },
  {
    "ph": "s", "id": 4231, "pid": 2762, "tid": 2762, "ts": 1638252373376971,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2> >(int, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>)", "pid": 0, "tid": 7,
    "ts": 1638252373382576, "dur": 280,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4237, "external id": 1328,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4237, "pid": 0, "tid": 7, "ts": 1638252373382576,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373377064, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4237,
      "external id": 1328, "external ts": 1638252373377048
    }
  },
  {
    "ph": "s", "id": 4237, "pid": 2762, "tid": 2762, "ts": 1638252373377064,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373377453, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4244,
      "external id": 1335, "external ts": 1638252373377434
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373377457, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 4245,
      "external id": 1335, "external ts": 1638252373377434
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638252373382858, "dur": 1,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 4246, "external id": 1335,
      "bytes": 1152, "memory bandwidth (GB/s)": 0.9
    }
  },
  {
    "ph": "f", "id": 4246, "pid": 0, "tid": 7, "ts": 1638252373382858,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373377463, "dur": 10,
    "args": {
      "cbid": 51, "correlation": 4246,
      "external id": 1335, "external ts": 1638252373377434
    }
  },
  {
    "ph": "s", "id": 4246, "pid": 2762, "tid": 2762, "ts": 1638252373377463,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 0, "tid": 7,
    "ts": 1638252373382861, "dur": 5185,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4247, "external id": 1335,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [12, 24, 4],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4247, "pid": 0, "tid": 7, "ts": 1638252373382861,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373377474, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4247,
      "external id": 1335, "external ts": 1638252373377434
    }
  },
  {
    "ph": "s", "id": 4247, "pid": 2762, "tid": 2762, "ts": 1638252373377474,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373377489, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4249,
      "external id": 1335, "external ts": 1638252373377434
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373388050, "dur": 74,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4253, "external id": 1338,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4253, "pid": 0, "tid": 7, "ts": 1638252373388050,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373377665, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4253,
      "external id": 1338, "external ts": 1638252373377655
    }
  },
  {
    "ph": "s", "id": 4253, "pid": 2762, "tid": 2762, "ts": 1638252373377665,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 0, "tid": 7,
    "ts": 1638252373388126, "dur": 85,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4275, "external id": 1340,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4275, "pid": 0, "tid": 7, "ts": 1638252373388126,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373378033, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4275,
      "external id": 1340, "external ts": 1638252373377801
    }
  },
  {
    "ph": "s", "id": 4275, "pid": 2762, "tid": 2762, "ts": 1638252373378033,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373388214, "dur": 132,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4289, "external id": 1346,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4289, "pid": 0, "tid": 7, "ts": 1638252373388214,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373378337, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4289,
      "external id": 1346, "external ts": 1638252373378183
    }
  },
  {
    "ph": "s", "id": 4289, "pid": 2762, "tid": 2762, "ts": 1638252373378337,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373388348, "dur": 68,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4291, "external id": 1346,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4291, "pid": 0, "tid": 7, "ts": 1638252373388348,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373378353, "dur": 9,
    "args": {
      "cbid": 211, "correlation": 4291,
      "external id": 1346, "external ts": 1638252373378183
    }
  },
  {
    "ph": "s", "id": 4291, "pid": 2762, "tid": 2762, "ts": 1638252373378353,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373378777, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4298,
      "external id": 1358, "external ts": 1638252373378756
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_32x32_sliced1x4_tn", "pid": 0, "tid": 7,
    "ts": 1638252373388418, "dur": 79,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4299, "external id": 1358,
      "registers per thread": 86,
      "shared memory": 32768,
      "blocks per SM": 1.4117647,
      "warps per SM": 5.647059,
      "grid": [1, 96, 1],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 18
    }
  },
  {
    "ph": "f", "id": 4299, "pid": 0, "tid": 7, "ts": 1638252373388418,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373378781, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4299,
      "external id": 1358, "external ts": 1638252373378756
    }
  },
  {
    "ph": "s", "id": 4299, "pid": 2762, "tid": 2762, "ts": 1638252373378781,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 4, true>(float*, float const*, int, int, int)", "pid": 0, "tid": 7,
    "ts": 1638252373388500, "dur": 2,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4306, "external id": 1366,
      "registers per thread": 18,
      "shared memory": 0,
      "blocks per SM": 2.8235295,
      "warps per SM": 11.294118,
      "grid": [192, 1, 1],
      "block": [16, 8, 1],
      "est. achieved occupancy %": 35
    }
  },
  {
    "ph": "f", "id": 4306, "pid": 0, "tid": 7, "ts": 1638252373388500,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373379131, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4306,
      "external id": 1366, "external ts": 1638252373379116
    }
  },
  {
    "ph": "s", "id": 4306, "pid": 2762, "tid": 2762, "ts": 1638252373379131,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::nll_loss_forward_reduce_cuda_kernel_2d<float, float, long>(float*, float*, float*, long*, float*, bool, int, int, int, long)", "pid": 0, "tid": 7,
    "ts": 1638252373388505, "dur": 58,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4313, "external id": 1369,
      "registers per thread": 38,
      "shared memory": 256,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.014705882,
      "grid": [1, 1, 1],
      "block": [32, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 4313, "pid": 0, "tid": 7, "ts": 1638252373388505,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373379348, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4313,
      "external id": 1369, "external ts": 1638252373379259
    }
  },
  {
    "ph": "s", "id": 4313, "pid": 2762, "tid": 2762, "ts": 1638252373379348,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373379633, "dur": 2,
    "args": {
      "cbid": 134, "correlation": 4318,
      "external id": 1033, "external ts": 1638252373361509
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373379637, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4319,
      "external id": 1033, "external ts": 1638252373361509
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373379642, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 4321,
      "external id": 1033, "external ts": 1638252373361509
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373379649, "dur": 1,
    "args": {
      "cbid": 134, "correlation": 4325,
      "external id": 1033, "external ts": 1638252373361509
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373379650, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4326,
      "external id": 1033, "external ts": 1638252373361509
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 2762, "tid": 2762,
    "ts": 1638252373379696, "dur": 8870,
    "args": {
      "cbid": 165, "correlation": 4330,
      "external id": 1033, "external ts": 1638252373361509
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373389249, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 4331,
      "external id": 1376, "external ts": 1638252373388997
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2762, "tid": 2762,
    "ts": 1638252373389254, "dur": 2,
    "args": {
      "cbid": 136, "correlation": 4332,
      "external id": 1376, "external ts": 1638252373388997
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373389258, "dur": 1,
    "args": {
      "cbid": 138, "correlation": 4333,
      "external id": 1376, "external ts": 1638252373388997
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2762, "tid": 2762,
    "ts": 1638252373389260, "dur": 1,
    "args": {
      "cbid": 136, "correlation": 4334,
      "external id": 1376, "external ts": 1638252373388997
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy HtoD (Pinned -> Device)", "pid": 0, "tid": 7,
    "ts": 1638252373389434, "dur": 2,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 4353, "external id": 1386,
      "bytes": 24576, "memory bandwidth (GB/s)": 10.378378378378379
    }
  },
  {
    "ph": "f", "id": 4353, "pid": 0, "tid": 7, "ts": 1638252373389434,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373389410, "dur": 20,
    "args": {
      "cbid": 41, "correlation": 4353,
      "external id": 1386, "external ts": 1638252373389401
    }
  },
  {
    "ph": "s", "id": 4353, "pid": 2762, "tid": 2762, "ts": 1638252373389410,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamSynchronize", "pid": 2762, "tid": 2762,
    "ts": 1638252373389431, "dur": 8,
    "args": {
      "cbid": 131, "correlation": 4354,
      "external id": 1386, "external ts": 1638252373389401
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy HtoD (Pinned -> Device)", "pid": 0, "tid": 7,
    "ts": 1638252373389572, "dur": 3,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 4366, "external id": 1390,
      "bytes": 24576, "memory bandwidth (GB/s)": 7.757575757575758
    }
  },
  {
    "ph": "f", "id": 4366, "pid": 0, "tid": 7, "ts": 1638252373389572,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373389551, "dur": 17,
    "args": {
      "cbid": 41, "correlation": 4366,
      "external id": 1390, "external ts": 1638252373389546
    }
  },
  {
    "ph": "s", "id": 4366, "pid": 2762, "tid": 2762, "ts": 1638252373389551,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamSynchronize", "pid": 2762, "tid": 2762,
    "ts": 1638252373389569, "dur": 8,
    "args": {
      "cbid": 131, "correlation": 4367,
      "external id": 1390, "external ts": 1638252373389546
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 2762, "tid": 2762,
    "ts": 1638252373389841, "dur": 5,
    "args": {
      "cbid": 165, "correlation": 4371,
      "external id": 1376, "external ts": 1638252373388997
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373390121, "dur": 2,
    "args": {
      "cbid": 134, "correlation": 4377,
      "external id": 1376, "external ts": 1638252373388997
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373390126, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4380,
      "external id": 1376, "external ts": 1638252373388997
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamWaitEvent", "pid": 2762, "tid": 2762,
    "ts": 1638252373390133, "dur": 1,
    "args": {
      "cbid": 147, "correlation": 4383,
      "external id": 1376, "external ts": 1638252373388997
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 2762, "tid": 2762,
    "ts": 1638252373390138, "dur": 1,
    "args": {
      "cbid": 136, "correlation": 4386,
      "external id": 1376, "external ts": 1638252373388997
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoH (Device -> Pinned)", "pid": 0, "tid": 7,
    "ts": 1638252373393751, "dur": 2,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 4395, "external id": 1491,
      "bytes": 24576, "memory bandwidth (GB/s)": 8.533333333333333
    }
  },
  {
    "ph": "f", "id": 4395, "pid": 0, "tid": 7, "ts": 1638252373393751,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373393732, "dur": 16,
    "args": {
      "cbid": 41, "correlation": 4395,
      "external id": 1491, "external ts": 1638252373393724
    }
  },
  {
    "ph": "s", "id": 4395, "pid": 2762, "tid": 2762, "ts": 1638252373393732,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoH (Device -> Pinned)", "pid": 0, "tid": 7,
    "ts": 1638252373393919, "dur": 2,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 4401, "external id": 1495,
      "bytes": 24576, "memory bandwidth (GB/s)": 8.347826086956522
    }
  },
  {
    "ph": "f", "id": 4401, "pid": 0, "tid": 7, "ts": 1638252373393919,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373393906, "dur": 11,
    "args": {
      "cbid": 41, "correlation": 4401,
      "external id": 1495, "external ts": 1638252373393901
    }
  },
  {
    "ph": "s", "id": 4401, "pid": 2762, "tid": 2762, "ts": 1638252373393906,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::indexSelectLargeIndex<float, long, unsigned int, 2, 2, -2, true>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<long, unsigned int>, int, int, unsigned int, unsigned int, long)", "pid": 0, "tid": 7,
    "ts": 1638252373394253, "dur": 75,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4414, "external id": 1499,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 8.0,
      "warps per SM": 32.0,
      "grid": [544, 1, 1],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4414, "pid": 0, "tid": 7, "ts": 1638252373394253,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373394231, "dur": 22,
    "args": {
      "cbid": 211, "correlation": 4414,
      "external id": 1499, "external ts": 1638252373394125
    }
  },
  {
    "ph": "s", "id": 4414, "pid": 2762, "tid": 2762, "ts": 1638252373394231,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373394540, "dur": 73,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4422, "external id": 1507,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4422, "pid": 0, "tid": 7, "ts": 1638252373394540,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373394522, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 4422,
      "external id": 1507, "external ts": 1638252373394499
    }
  },
  {
    "ph": "s", "id": 4422, "pid": 2762, "tid": 2762, "ts": 1638252373394522,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 0, "tid": 7,
    "ts": 1638252373394855, "dur": 86,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4444, "external id": 1509,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4444, "pid": 0, "tid": 7, "ts": 1638252373394855,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373394839, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4444,
      "external id": 1509, "external ts": 1638252373394643
    }
  },
  {
    "ph": "s", "id": 4444, "pid": 2762, "tid": 2762, "ts": 1638252373394839,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373395178, "dur": 133,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4458, "external id": 1515,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4458, "pid": 0, "tid": 7, "ts": 1638252373395178,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373395163, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4458,
      "external id": 1515, "external ts": 1638252373394991
    }
  },
  {
    "ph": "s", "id": 4458, "pid": 2762, "tid": 2762, "ts": 1638252373395163,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373395314, "dur": 68,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4460, "external id": 1515,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4460, "pid": 0, "tid": 7, "ts": 1638252373395314,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373395179, "dur": 10,
    "args": {
      "cbid": 211, "correlation": 4460,
      "external id": 1515, "external ts": 1638252373394991
    }
  },
  {
    "ph": "s", "id": 4460, "pid": 2762, "tid": 2762, "ts": 1638252373395179,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373395687, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4467,
      "external id": 1527, "external ts": 1638252373395661
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373395693, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 4468,
      "external id": 1527, "external ts": 1638252373395661
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638252373395712, "dur": 2,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 4469, "external id": 1527,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.125
    }
  },
  {
    "ph": "f", "id": 4469, "pid": 0, "tid": 7, "ts": 1638252373395712,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373395699, "dur": 10,
    "args": {
      "cbid": 51, "correlation": 4469,
      "external id": 1527, "external ts": 1638252373395661
    }
  },
  {
    "ph": "s", "id": 4469, "pid": 2762, "tid": 2762, "ts": 1638252373395699,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373395710, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4470,
      "external id": 1527, "external ts": 1638252373395661
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 0, "tid": 7,
    "ts": 1638252373395732, "dur": 1390,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4471, "external id": 1527,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4471, "pid": 0, "tid": 7, "ts": 1638252373395732,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373395717, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4471,
      "external id": 1527, "external ts": 1638252373395661
    }
  },
  {
    "ph": "s", "id": 4471, "pid": 2762, "tid": 2762, "ts": 1638252373395717,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373395733, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4473,
      "external id": 1527, "external ts": 1638252373395661
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373397124, "dur": 74,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4477, "external id": 1530,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4477, "pid": 0, "tid": 7, "ts": 1638252373397124,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373395902, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4477,
      "external id": 1530, "external ts": 1638252373395890
    }
  },
  {
    "ph": "s", "id": 4477, "pid": 2762, "tid": 2762, "ts": 1638252373395902,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373396449, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4484,
      "external id": 1540, "external ts": 1638252373396426
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373396454, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 4485,
      "external id": 1540, "external ts": 1638252373396426
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638252373397201, "dur": 1,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 4486, "external id": 1540,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.2413793103448276
    }
  },
  {
    "ph": "f", "id": 4486, "pid": 0, "tid": 7, "ts": 1638252373397201,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373396458, "dur": 9,
    "args": {
      "cbid": 51, "correlation": 4486,
      "external id": 1540, "external ts": 1638252373396426
    }
  },
  {
    "ph": "s", "id": 4486, "pid": 2762, "tid": 2762, "ts": 1638252373396458,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373396468, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4487,
      "external id": 1540, "external ts": 1638252373396426
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 0, "tid": 7,
    "ts": 1638252373397204, "dur": 1403,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4488, "external id": 1540,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4488, "pid": 0, "tid": 7, "ts": 1638252373397204,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373396474, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4488,
      "external id": 1540, "external ts": 1638252373396426
    }
  },
  {
    "ph": "s", "id": 4488, "pid": 2762, "tid": 2762, "ts": 1638252373396474,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373396489, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4490,
      "external id": 1540, "external ts": 1638252373396426
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373398610, "dur": 73,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4494, "external id": 1543,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4494, "pid": 0, "tid": 7, "ts": 1638252373398610,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373396662, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4494,
      "external id": 1543, "external ts": 1638252373396652
    }
  },
  {
    "ph": "s", "id": 4494, "pid": 2762, "tid": 2762, "ts": 1638252373396662,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373397187, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4501,
      "external id": 1553, "external ts": 1638252373397164
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373397190, "dur": 2,
    "args": {
      "cbid": 138, "correlation": 4502,
      "external id": 1553, "external ts": 1638252373397164
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638252373398685, "dur": 2,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 4503, "external id": 1553,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.125
    }
  },
  {
    "ph": "f", "id": 4503, "pid": 0, "tid": 7, "ts": 1638252373398685,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373397194, "dur": 8,
    "args": {
      "cbid": 51, "correlation": 4503,
      "external id": 1553, "external ts": 1638252373397164
    }
  },
  {
    "ph": "s", "id": 4503, "pid": 2762, "tid": 2762, "ts": 1638252373397194,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373397204, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4504,
      "external id": 1553, "external ts": 1638252373397164
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 0, "tid": 7,
    "ts": 1638252373398689, "dur": 1433,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4505, "external id": 1553,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4505, "pid": 0, "tid": 7, "ts": 1638252373398689,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373397209, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4505,
      "external id": 1553, "external ts": 1638252373397164
    }
  },
  {
    "ph": "s", "id": 4505, "pid": 2762, "tid": 2762, "ts": 1638252373397209,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373397224, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4507,
      "external id": 1553, "external ts": 1638252373397164
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373400126, "dur": 74,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4511, "external id": 1556,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4511, "pid": 0, "tid": 7, "ts": 1638252373400126,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373397386, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4511,
      "external id": 1556, "external ts": 1638252373397377
    }
  },
  {
    "ph": "s", "id": 4511, "pid": 2762, "tid": 2762, "ts": 1638252373397386,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373400203, "dur": 75,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4519, "external id": 1569,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4519, "pid": 0, "tid": 7, "ts": 1638252373400203,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373398014, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4519,
      "external id": 1569, "external ts": 1638252373398004
    }
  },
  {
    "ph": "s", "id": 4519, "pid": 2762, "tid": 2762, "ts": 1638252373398014,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373400280, "dur": 71,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4528, "external id": 1578,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4528, "pid": 0, "tid": 7, "ts": 1638252373400280,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373398440, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4528,
      "external id": 1578, "external ts": 1638252373398433
    }
  },
  {
    "ph": "s", "id": 4528, "pid": 2762, "tid": 2762, "ts": 1638252373398440,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 0, "tid": 7,
    "ts": 1638252373400354, "dur": 285,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4538, "external id": 1581,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4538, "pid": 0, "tid": 7, "ts": 1638252373400354,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373398661, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4538,
      "external id": 1581, "external ts": 1638252373398590
    }
  },
  {
    "ph": "s", "id": 4538, "pid": 2762, "tid": 2762, "ts": 1638252373398661,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 0, "tid": 7,
    "ts": 1638252373400642, "dur": 9,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4544, "external id": 1585,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4544, "pid": 0, "tid": 7, "ts": 1638252373400642,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373398862, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4544,
      "external id": 1585, "external ts": 1638252373398843
    }
  },
  {
    "ph": "s", "id": 4544, "pid": 2762, "tid": 2762, "ts": 1638252373398862,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 0, "tid": 7,
    "ts": 1638252373400654, "dur": 1,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4552, "external id": 1590,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.029411765,
      "grid": [1, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 4552, "pid": 0, "tid": 7, "ts": 1638252373400654,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373399164, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4552,
      "external id": 1590, "external ts": 1638252373399132
    }
  },
  {
    "ph": "s", "id": 4552, "pid": 2762, "tid": 2762, "ts": 1638252373399164,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoD (Device -> Device)", "pid": 0, "tid": 7,
    "ts": 1638252373400658, "dur": 9,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 4559, "external id": 1599,
      "bytes": 3538944, "memory bandwidth (GB/s)": 359.06493506493507
    }
  },
  {
    "ph": "f", "id": 4559, "pid": 0, "tid": 7, "ts": 1638252373400658,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373399590, "dur": 32,
    "args": {
      "cbid": 41, "correlation": 4559,
      "external id": 1599, "external ts": 1638252373399585
    }
  },
  {
    "ph": "s", "id": 4559, "pid": 2762, "tid": 2762, "ts": 1638252373399590,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast>(int, at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373400670, "dur": 13,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4564, "external id": 1600,
      "registers per thread": 24,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4564, "pid": 0, "tid": 7, "ts": 1638252373400670,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373399769, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4564,
      "external id": 1600, "external ts": 1638252373399673
    }
  },
  {
    "ph": "s", "id": 4564, "pid": 2762, "tid": 2762, "ts": 1638252373399769,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 3, false>(float*, float const*, int, int, int)", "pid": 0, "tid": 7,
    "ts": 1638252373400795, "dur": 22,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4571, "external id": 1604,
      "registers per thread": 19,
      "shared memory": 0,
      "blocks per SM": 67.76471,
      "warps per SM": 271.05884,
      "grid": [4608, 1, 1],
      "block": [8, 16, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4571, "pid": 0, "tid": 7, "ts": 1638252373400795,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373400772, "dur": 21,
    "args": {
      "cbid": 211, "correlation": 4571,
      "external id": 1604, "external ts": 1638252373400750
    }
  },
  {
    "ph": "s", "id": 4571, "pid": 2762, "tid": 2762, "ts": 1638252373400772,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 0, "tid": 7,
    "ts": 1638252373401173, "dur": 12,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4593, "external id": 1606,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4593, "pid": 0, "tid": 7, "ts": 1638252373401173,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373401156, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 4593,
      "external id": 1606, "external ts": 1638252373400924
    }
  },
  {
    "ph": "s", "id": 4593, "pid": 2762, "tid": 2762, "ts": 1638252373401156,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373401745, "dur": 73,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4601, "external id": 1622,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4601, "pid": 0, "tid": 7, "ts": 1638252373401745,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373401729, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4601,
      "external id": 1622, "external ts": 1638252373401717
    }
  },
  {
    "ph": "s", "id": 4601, "pid": 2762, "tid": 2762, "ts": 1638252373401729,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 0, "tid": 7,
    "ts": 1638252373401953, "dur": 273,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4611, "external id": 1625,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4611, "pid": 0, "tid": 7, "ts": 1638252373401953,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373401939, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4611,
      "external id": 1625, "external ts": 1638252373401877
    }
  },
  {
    "ph": "s", "id": 4611, "pid": 2762, "tid": 2762, "ts": 1638252373401939,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373402377, "dur": 71,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4620, "external id": 1635,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4620, "pid": 0, "tid": 7, "ts": 1638252373402377,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373402363, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4620,
      "external id": 1635, "external ts": 1638252373402355
    }
  },
  {
    "ph": "s", "id": 4620, "pid": 2762, "tid": 2762, "ts": 1638252373402363,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373402812, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4629,
      "external id": 1643, "external ts": 1638252373402790
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373402817, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 4630,
      "external id": 1643, "external ts": 1638252373402790
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638252373402837, "dur": 2,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 4631, "external id": 1643,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.125
    }
  },
  {
    "ph": "f", "id": 4631, "pid": 0, "tid": 7, "ts": 1638252373402837,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373402824, "dur": 10,
    "args": {
      "cbid": 51, "correlation": 4631,
      "external id": 1643, "external ts": 1638252373402790
    }
  },
  {
    "ph": "s", "id": 4631, "pid": 2762, "tid": 2762, "ts": 1638252373402824,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373402835, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4632,
      "external id": 1643, "external ts": 1638252373402790
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 0, "tid": 7,
    "ts": 1638252373402856, "dur": 1444,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4633, "external id": 1643,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4633, "pid": 0, "tid": 7, "ts": 1638252373402856,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373402842, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4633,
      "external id": 1643, "external ts": 1638252373402790
    }
  },
  {
    "ph": "s", "id": 4633, "pid": 2762, "tid": 2762, "ts": 1638252373402842,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373402858, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4635,
      "external id": 1643, "external ts": 1638252373402790
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373404303, "dur": 75,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4639, "external id": 1646,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4639, "pid": 0, "tid": 7, "ts": 1638252373404303,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373403019, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4639,
      "external id": 1646, "external ts": 1638252373403008
    }
  },
  {
    "ph": "s", "id": 4639, "pid": 2762, "tid": 2762, "ts": 1638252373403019,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 0, "tid": 7,
    "ts": 1638252373404380, "dur": 86,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4661, "external id": 1648,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4661, "pid": 0, "tid": 7, "ts": 1638252373404380,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373403369, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4661,
      "external id": 1648, "external ts": 1638252373403146
    }
  },
  {
    "ph": "s", "id": 4661, "pid": 2762, "tid": 2762, "ts": 1638252373403369,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3> >(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>)", "pid": 0, "tid": 7,
    "ts": 1638252373404469, "dur": 104,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4667, "external id": 1653,
      "registers per thread": 20,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4667, "pid": 0, "tid": 7, "ts": 1638252373404469,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373403492, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4667,
      "external id": 1653, "external ts": 1638252373403476
    }
  },
  {
    "ph": "s", "id": 4667, "pid": 2762, "tid": 2762, "ts": 1638252373403492,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373404575, "dur": 124,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4681, "external id": 1655,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4681, "pid": 0, "tid": 7, "ts": 1638252373404575,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373403806, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4681,
      "external id": 1655, "external ts": 1638252373403631
    }
  },
  {
    "ph": "s", "id": 4681, "pid": 2762, "tid": 2762, "ts": 1638252373403806,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373404704, "dur": 68,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4683, "external id": 1655,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4683, "pid": 0, "tid": 7, "ts": 1638252373404704,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373403821, "dur": 9,
    "args": {
      "cbid": 211, "correlation": 4683,
      "external id": 1655, "external ts": 1638252373403631
    }
  },
  {
    "ph": "s", "id": 4683, "pid": 2762, "tid": 2762, "ts": 1638252373403821,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373404295, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4690,
      "external id": 1667, "external ts": 1638252373404275
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373404299, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4691,
      "external id": 1667, "external ts": 1638252373404275
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 0, "tid": 7,
    "ts": 1638252373404774, "dur": 5344,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4692, "external id": 1667,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [48, 24, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4692, "pid": 0, "tid": 7, "ts": 1638252373404774,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373404304, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4692,
      "external id": 1667, "external ts": 1638252373404275
    }
  },
  {
    "ph": "s", "id": 4692, "pid": 2762, "tid": 2762, "ts": 1638252373404304,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373410121, "dur": 280,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4697, "external id": 1670,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4697, "pid": 0, "tid": 7, "ts": 1638252373410121,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373404480, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4697,
      "external id": 1670, "external ts": 1638252373404469
    }
  },
  {
    "ph": "s", "id": 4697, "pid": 2762, "tid": 2762, "ts": 1638252373404480,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2> >(int, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>)", "pid": 0, "tid": 7,
    "ts": 1638252373410404, "dur": 280,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4703, "external id": 1671,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4703, "pid": 0, "tid": 7, "ts": 1638252373410404,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373404571, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4703,
      "external id": 1671, "external ts": 1638252373404555
    }
  },
  {
    "ph": "s", "id": 4703, "pid": 2762, "tid": 2762, "ts": 1638252373404571,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373404948, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4710,
      "external id": 1678, "external ts": 1638252373404930
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373404953, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 4711,
      "external id": 1678, "external ts": 1638252373404930
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638252373410688, "dur": 0,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 4712, "external id": 1678,
      "bytes": 1152, "memory bandwidth (GB/s)": 1.3846153846153846
    }
  },
  {
    "ph": "f", "id": 4712, "pid": 0, "tid": 7, "ts": 1638252373410688,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 2762, "tid": 2762,
    "ts": 1638252373404958, "dur": 10,
    "args": {
      "cbid": 51, "correlation": 4712,
      "external id": 1678, "external ts": 1638252373404930
    }
  },
  {
    "ph": "s", "id": 4712, "pid": 2762, "tid": 2762, "ts": 1638252373404958,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 0, "tid": 7,
    "ts": 1638252373410691, "dur": 4326,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4713, "external id": 1678,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [12, 24, 4],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4713, "pid": 0, "tid": 7, "ts": 1638252373410691,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373404970, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4713,
      "external id": 1678, "external ts": 1638252373404930
    }
  },
  {
    "ph": "s", "id": 4713, "pid": 2762, "tid": 2762, "ts": 1638252373404970,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373404985, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4715,
      "external id": 1678, "external ts": 1638252373404930
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638252373415019, "dur": 74,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4719, "external id": 1681,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4719, "pid": 0, "tid": 7, "ts": 1638252373415019,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373405147, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4719,
      "external id": 1681, "external ts": 1638252373405137
    }
  },
  {
    "ph": "s", "id": 4719, "pid": 2762, "tid": 2762, "ts": 1638252373405147,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 0, "tid": 7,
    "ts": 1638252373415095, "dur": 84,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4741, "external id": 1683,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4741, "pid": 0, "tid": 7, "ts": 1638252373415095,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373405499, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4741,
      "external id": 1683, "external ts": 1638252373405278
    }
  },
  {
    "ph": "s", "id": 4741, "pid": 2762, "tid": 2762, "ts": 1638252373405499,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373415182, "dur": 103,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4755, "external id": 1689,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4755, "pid": 0, "tid": 7, "ts": 1638252373415182,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373405802, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4755,
      "external id": 1689, "external ts": 1638252373405658
    }
  },
  {
    "ph": "s", "id": 4755, "pid": 2762, "tid": 2762, "ts": 1638252373405802,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 0, "tid": 7,
    "ts": 1638252373415288, "dur": 67,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4757, "external id": 1689,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4757, "pid": 0, "tid": 7, "ts": 1638252373415288,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373405818, "dur": 10,
    "args": {
      "cbid": 211, "correlation": 4757,
      "external id": 1689, "external ts": 1638252373405658
    }
  },
  {
    "ph": "s", "id": 4757, "pid": 2762, "tid": 2762, "ts": 1638252373405818,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373406214, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4764,
      "external id": 1701, "external ts": 1638252373406195
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_32x32_sliced1x4_tn", "pid": 0, "tid": 7,
    "ts": 1638252373415357, "dur": 72,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4765, "external id": 1701,
      "registers per thread": 86,
      "shared memory": 32768,
      "blocks per SM": 1.4117647,
      "warps per SM": 5.647059,
      "grid": [1, 96, 1],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 18
    }
  },
  {
    "ph": "f", "id": 4765, "pid": 0, "tid": 7, "ts": 1638252373415357,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373406219, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4765,
      "external id": 1701, "external ts": 1638252373406195
    }
  },
  {
    "ph": "s", "id": 4765, "pid": 2762, "tid": 2762, "ts": 1638252373406219,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 4, true>(float*, float const*, int, int, int)", "pid": 0, "tid": 7,
    "ts": 1638252373415432, "dur": 2,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4772, "external id": 1709,
      "registers per thread": 18,
      "shared memory": 0,
      "blocks per SM": 2.8235295,
      "warps per SM": 11.294118,
      "grid": [192, 1, 1],
      "block": [16, 8, 1],
      "est. achieved occupancy %": 35
    }
  },
  {
    "ph": "f", "id": 4772, "pid": 0, "tid": 7, "ts": 1638252373415432,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373406558, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4772,
      "external id": 1709, "external ts": 1638252373406543
    }
  },
  {
    "ph": "s", "id": 4772, "pid": 2762, "tid": 2762, "ts": 1638252373406558,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::nll_loss_forward_reduce_cuda_kernel_2d<float, float, long>(float*, float*, float*, long*, float*, bool, int, int, int, long)", "pid": 0, "tid": 7,
    "ts": 1638252373415436, "dur": 46,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4779, "external id": 1712,
      "registers per thread": 38,
      "shared memory": 256,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.014705882,
      "grid": [1, 1, 1],
      "block": [32, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 4779, "pid": 0, "tid": 7, "ts": 1638252373415436,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 2762, "tid": 2762,
    "ts": 1638252373406770, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4779,
      "external id": 1712, "external ts": 1638252373406684
    }
  },
  {
    "ph": "s", "id": 4779, "pid": 2762, "tid": 2762, "ts": 1638252373406770,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373407037, "dur": 2,
    "args": {
      "cbid": 134, "correlation": 4784,
      "external id": 1376, "external ts": 1638252373388997
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373407040, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4785,
      "external id": 1376, "external ts": 1638252373388997
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 2762, "tid": 2762,
    "ts": 1638252373407045, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 4787,
      "external id": 1376, "external ts": 1638252373388997
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 2762, "tid": 2762,
    "ts": 1638252373407053, "dur": 1,
    "args": {
      "cbid": 134, "correlation": 4791,
      "external id": 1376, "external ts": 1638252373388997
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 2762, "tid": 2762,
    "ts": 1638252373407054, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4792,
      "external id": 1376, "external ts": 1638252373388997
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 2762, "tid": 2762,
    "ts": 1638252373407100, "dur": 8385,
    "args": {
      "cbid": 165, "correlation": 4796,
      "external id": 1376, "external ts": 1638252373388997
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 2762, "tid": 2762,
    "ts": 1638252373415815, "dur": 5,
    "args": {
      "cbid": 165, "correlation": 4799,
      "external id": 0, "external ts": 1638252373407074
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638252373278273, "pid": 2762, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638252373278273, "pid": 2762, "tid": 0,
    "args": {
      "labels": "CPU"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638252373278273, "pid": 2762, "tid": 0,
    "args": {
      "sort_index": 2762
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638252373278273, "pid": 0, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638252373278273, "pid": 0, "tid": 0,
    "args": {
      "labels": "GPU 0"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638252373278273, "pid": 0, "tid": 0,
    "args": {
      "sort_index": 16777216
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638252373278273, "pid": 1, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638252373278273, "pid": 1, "tid": 0,
    "args": {
      "labels": "GPU 1"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638252373278273, "pid": 1, "tid": 0,
    "args": {
      "sort_index": 16777217
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638252373278273, "pid": 2, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638252373278273, "pid": 2, "tid": 0,
    "args": {
      "labels": "GPU 2"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638252373278273, "pid": 2, "tid": 0,
    "args": {
      "sort_index": 16777218
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638252373278273, "pid": 3, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638252373278273, "pid": 3, "tid": 0,
    "args": {
      "labels": "GPU 3"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638252373278273, "pid": 3, "tid": 0,
    "args": {
      "sort_index": 16777219
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638252373278273, "pid": 4, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638252373278273, "pid": 4, "tid": 0,
    "args": {
      "labels": "GPU 4"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638252373278273, "pid": 4, "tid": 0,
    "args": {
      "sort_index": 16777220
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638252373278273, "pid": 5, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638252373278273, "pid": 5, "tid": 0,
    "args": {
      "labels": "GPU 5"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638252373278273, "pid": 5, "tid": 0,
    "args": {
      "sort_index": 16777221
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638252373278273, "pid": 6, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638252373278273, "pid": 6, "tid": 0,
    "args": {
      "labels": "GPU 6"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638252373278273, "pid": 6, "tid": 0,
    "args": {
      "sort_index": 16777222
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638252373278273, "pid": 7, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638252373278273, "pid": 7, "tid": 0,
    "args": {
      "labels": "GPU 7"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638252373278273, "pid": 7, "tid": 0,
    "args": {
      "sort_index": 16777223
    }
  },
  {
    "name": "thread_name", "ph": "M", "ts": 1638252373278273, "pid": 0, "tid": 7,
    "args": {
      "name": "stream 7"
    }
  },
  {
    "name": "thread_sort_index", "ph": "M", "ts": 1638252373278273, "pid": 0, "tid": 7,
    "args": {
      "sort_index": 7
    }
  },
  {
    "name": "thread_name", "ph": "M", "ts": 1638252373278273, "pid": 2762, "tid": 2762,
    "args": {
      "name": "thread 2762 (python)"
    }
  },
  {
    "name": "thread_sort_index", "ph": "M", "ts": 1638252373278273, "pid": 2762, "tid": 2762,
    "args": {
      "sort_index": 2762
    }
  },
  {
    "ph": "X", "cat": "Trace", "ts": 1638252373278273, "dur": 137557,
    "pid": "Spans", "tid": "PyTorch Profiler",
    "name": "PyTorch Profiler (0)",
    "args": {
      "Op count": 0
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638252373278273,
    "pid": "Spans", "tid": 0,
    "args": {
      "sort_index": 536870912
    }
  },
  {
    "name": "Iteration Start: PyTorch Profiler", "ph": "i", "s": "g",
    "pid": "Traces", "tid": "Trace PyTorch Profiler", "ts": 1638252373278273
  },
  {
    "name": "Record Window End", "ph": "i", "s": "g",
    "pid": "", "tid": "", "ts": 1638252373430982
  }
]}